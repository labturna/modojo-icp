{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { $, addDisposableListener, append, getWindow, scheduleAtNextAnimationFrame } from '../../dom.js';\nimport { DomEmitter } from '../../event.js';\nimport { Sash } from '../sash/sash.js';\nimport { SmoothScrollableElement } from '../scrollbar/scrollableElement.js';\nimport { pushToEnd, pushToStart, range } from '../../../common/arrays.js';\nimport { Color } from '../../../common/color.js';\nimport { Emitter, Event } from '../../../common/event.js';\nimport { combinedDisposable, Disposable, dispose, toDisposable } from '../../../common/lifecycle.js';\nimport { clamp } from '../../../common/numbers.js';\nimport { Scrollable } from '../../../common/scrollable.js';\nimport * as types from '../../../common/types.js';\nimport './splitview.css';\nconst defaultStyles = {\n  separatorBorder: Color.transparent\n};\nclass ViewItem {\n  set size(size) {\n    this._size = size;\n  }\n  get size() {\n    return this._size;\n  }\n  get visible() {\n    return typeof this._cachedVisibleSize === 'undefined';\n  }\n  setVisible(visible, size) {\n    var _a, _b;\n    if (visible === this.visible) {\n      return;\n    }\n    if (visible) {\n      this.size = clamp(this._cachedVisibleSize, this.viewMinimumSize, this.viewMaximumSize);\n      this._cachedVisibleSize = undefined;\n    } else {\n      this._cachedVisibleSize = typeof size === 'number' ? size : this.size;\n      this.size = 0;\n    }\n    this.container.classList.toggle('visible', visible);\n    try {\n      (_b = (_a = this.view).setVisible) === null || _b === void 0 ? void 0 : _b.call(_a, visible);\n    } catch (e) {\n      console.error('Splitview: Failed to set visible view');\n      console.error(e);\n    }\n  }\n  get minimumSize() {\n    return this.visible ? this.view.minimumSize : 0;\n  }\n  get viewMinimumSize() {\n    return this.view.minimumSize;\n  }\n  get maximumSize() {\n    return this.visible ? this.view.maximumSize : 0;\n  }\n  get viewMaximumSize() {\n    return this.view.maximumSize;\n  }\n  get priority() {\n    return this.view.priority;\n  }\n  get proportionalLayout() {\n    var _a;\n    return (_a = this.view.proportionalLayout) !== null && _a !== void 0 ? _a : true;\n  }\n  get snap() {\n    return !!this.view.snap;\n  }\n  set enabled(enabled) {\n    this.container.style.pointerEvents = enabled ? '' : 'none';\n  }\n  constructor(container, view, size, disposable) {\n    this.container = container;\n    this.view = view;\n    this.disposable = disposable;\n    this._cachedVisibleSize = undefined;\n    if (typeof size === 'number') {\n      this._size = size;\n      this._cachedVisibleSize = undefined;\n      container.classList.add('visible');\n    } else {\n      this._size = 0;\n      this._cachedVisibleSize = size.cachedVisibleSize;\n    }\n  }\n  layout(offset, layoutContext) {\n    this.layoutContainer(offset);\n    try {\n      this.view.layout(this.size, offset, layoutContext);\n    } catch (e) {\n      console.error('Splitview: Failed to layout view');\n      console.error(e);\n    }\n  }\n  dispose() {\n    this.disposable.dispose();\n  }\n}\nclass VerticalViewItem extends ViewItem {\n  layoutContainer(offset) {\n    this.container.style.top = `${offset}px`;\n    this.container.style.height = `${this.size}px`;\n  }\n}\nclass HorizontalViewItem extends ViewItem {\n  layoutContainer(offset) {\n    this.container.style.left = `${offset}px`;\n    this.container.style.width = `${this.size}px`;\n  }\n}\nvar State;\n(function (State) {\n  State[State[\"Idle\"] = 0] = \"Idle\";\n  State[State[\"Busy\"] = 1] = \"Busy\";\n})(State || (State = {}));\nexport var Sizing;\n(function (Sizing) {\n  /**\n   * When adding or removing views, distribute the delta space among\n   * all other views.\n   */\n  Sizing.Distribute = {\n    type: 'distribute'\n  };\n  /**\n   * When adding or removing views, split the delta space with another\n   * specific view, indexed by the provided `index`.\n   */\n  function Split(index) {\n    return {\n      type: 'split',\n      index\n    };\n  }\n  Sizing.Split = Split;\n  /**\n   * When adding a view, use DistributeSizing when all pre-existing views are\n   * distributed evenly, otherwise use SplitSizing.\n   */\n  function Auto(index) {\n    return {\n      type: 'auto',\n      index\n    };\n  }\n  Sizing.Auto = Auto;\n  /**\n   * When adding or removing views, assume the view is invisible.\n   */\n  function Invisible(cachedVisibleSize) {\n    return {\n      type: 'invisible',\n      cachedVisibleSize\n    };\n  }\n  Sizing.Invisible = Invisible;\n})(Sizing || (Sizing = {}));\n/**\n * The {@link SplitView} is the UI component which implements a one dimensional\n * flex-like layout algorithm for a collection of {@link IView} instances, which\n * are essentially HTMLElement instances with the following size constraints:\n *\n * - {@link IView.minimumSize}\n * - {@link IView.maximumSize}\n * - {@link IView.priority}\n * - {@link IView.snap}\n *\n * In case the SplitView doesn't have enough size to fit all views, it will overflow\n * its content with a scrollbar.\n *\n * In between each pair of views there will be a {@link Sash} allowing the user\n * to resize the views, making sure the constraints are respected.\n *\n * An optional {@link TLayoutContext layout context type} may be used in order to\n * pass along layout contextual data from the {@link SplitView.layout} method down\n * to each view's {@link IView.layout} calls.\n *\n * Features:\n * - Flex-like layout algorithm\n * - Snap support\n * - Orthogonal sash support, for corner sashes\n * - View hide/show support\n * - View swap/move support\n * - Alt key modifier behavior, macOS style\n */\nexport class SplitView extends Disposable {\n  get orthogonalStartSash() {\n    return this._orthogonalStartSash;\n  }\n  get orthogonalEndSash() {\n    return this._orthogonalEndSash;\n  }\n  get startSnappingEnabled() {\n    return this._startSnappingEnabled;\n  }\n  get endSnappingEnabled() {\n    return this._endSnappingEnabled;\n  }\n  /**\n   * A reference to a sash, perpendicular to all sashes in this {@link SplitView},\n   * located at the left- or top-most side of the SplitView.\n   * Corner sashes will be created automatically at the intersections.\n   */\n  set orthogonalStartSash(sash) {\n    for (const sashItem of this.sashItems) {\n      sashItem.sash.orthogonalStartSash = sash;\n    }\n    this._orthogonalStartSash = sash;\n  }\n  /**\n   * A reference to a sash, perpendicular to all sashes in this {@link SplitView},\n   * located at the right- or bottom-most side of the SplitView.\n   * Corner sashes will be created automatically at the intersections.\n   */\n  set orthogonalEndSash(sash) {\n    for (const sashItem of this.sashItems) {\n      sashItem.sash.orthogonalEndSash = sash;\n    }\n    this._orthogonalEndSash = sash;\n  }\n  /**\n   * Enable/disable snapping at the beginning of this {@link SplitView}.\n   */\n  set startSnappingEnabled(startSnappingEnabled) {\n    if (this._startSnappingEnabled === startSnappingEnabled) {\n      return;\n    }\n    this._startSnappingEnabled = startSnappingEnabled;\n    this.updateSashEnablement();\n  }\n  /**\n   * Enable/disable snapping at the end of this {@link SplitView}.\n   */\n  set endSnappingEnabled(endSnappingEnabled) {\n    if (this._endSnappingEnabled === endSnappingEnabled) {\n      return;\n    }\n    this._endSnappingEnabled = endSnappingEnabled;\n    this.updateSashEnablement();\n  }\n  /**\n   * Create a new {@link SplitView} instance.\n   */\n  constructor(container) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var _a, _b, _c, _d, _e;\n    super();\n    this.size = 0;\n    this._contentSize = 0;\n    this.proportions = undefined;\n    this.viewItems = [];\n    this.sashItems = []; // used in tests\n    this.state = State.Idle;\n    this._onDidSashChange = this._register(new Emitter());\n    this._onDidSashReset = this._register(new Emitter());\n    this._startSnappingEnabled = true;\n    this._endSnappingEnabled = true;\n    /**\n     * Fires whenever the user resizes a {@link Sash sash}.\n     */\n    this.onDidSashChange = this._onDidSashChange.event;\n    /**\n     * Fires whenever the user double clicks a {@link Sash sash}.\n     */\n    this.onDidSashReset = this._onDidSashReset.event;\n    this.orientation = (_a = options.orientation) !== null && _a !== void 0 ? _a : 0 /* Orientation.VERTICAL */;\n    this.inverseAltBehavior = (_b = options.inverseAltBehavior) !== null && _b !== void 0 ? _b : false;\n    this.proportionalLayout = (_c = options.proportionalLayout) !== null && _c !== void 0 ? _c : true;\n    this.getSashOrthogonalSize = options.getSashOrthogonalSize;\n    this.el = document.createElement('div');\n    this.el.classList.add('monaco-split-view2');\n    this.el.classList.add(this.orientation === 0 /* Orientation.VERTICAL */ ? 'vertical' : 'horizontal');\n    container.appendChild(this.el);\n    this.sashContainer = append(this.el, $('.sash-container'));\n    this.viewContainer = $('.split-view-container');\n    this.scrollable = this._register(new Scrollable({\n      forceIntegerValues: true,\n      smoothScrollDuration: 125,\n      scheduleAtNextAnimationFrame: callback => scheduleAtNextAnimationFrame(getWindow(this.el), callback)\n    }));\n    this.scrollableElement = this._register(new SmoothScrollableElement(this.viewContainer, {\n      vertical: this.orientation === 0 /* Orientation.VERTICAL */ ? (_d = options.scrollbarVisibility) !== null && _d !== void 0 ? _d : 1 /* ScrollbarVisibility.Auto */ : 2 /* ScrollbarVisibility.Hidden */,\n      horizontal: this.orientation === 1 /* Orientation.HORIZONTAL */ ? (_e = options.scrollbarVisibility) !== null && _e !== void 0 ? _e : 1 /* ScrollbarVisibility.Auto */ : 2 /* ScrollbarVisibility.Hidden */\n    }, this.scrollable));\n    // https://github.com/microsoft/vscode/issues/157737\n    const onDidScrollViewContainer = this._register(new DomEmitter(this.viewContainer, 'scroll')).event;\n    this._register(onDidScrollViewContainer(_ => {\n      const position = this.scrollableElement.getScrollPosition();\n      const scrollLeft = Math.abs(this.viewContainer.scrollLeft - position.scrollLeft) <= 1 ? undefined : this.viewContainer.scrollLeft;\n      const scrollTop = Math.abs(this.viewContainer.scrollTop - position.scrollTop) <= 1 ? undefined : this.viewContainer.scrollTop;\n      if (scrollLeft !== undefined || scrollTop !== undefined) {\n        this.scrollableElement.setScrollPosition({\n          scrollLeft,\n          scrollTop\n        });\n      }\n    }));\n    this.onDidScroll = this.scrollableElement.onScroll;\n    this._register(this.onDidScroll(e => {\n      if (e.scrollTopChanged) {\n        this.viewContainer.scrollTop = e.scrollTop;\n      }\n      if (e.scrollLeftChanged) {\n        this.viewContainer.scrollLeft = e.scrollLeft;\n      }\n    }));\n    append(this.el, this.scrollableElement.getDomNode());\n    this.style(options.styles || defaultStyles);\n    // We have an existing set of view, add them now\n    if (options.descriptor) {\n      this.size = options.descriptor.size;\n      options.descriptor.views.forEach((viewDescriptor, index) => {\n        const sizing = types.isUndefined(viewDescriptor.visible) || viewDescriptor.visible ? viewDescriptor.size : {\n          type: 'invisible',\n          cachedVisibleSize: viewDescriptor.size\n        };\n        const view = viewDescriptor.view;\n        this.doAddView(view, sizing, index, true);\n      });\n      // Initialize content size and proportions for first layout\n      this._contentSize = this.viewItems.reduce((r, i) => r + i.size, 0);\n      this.saveProportions();\n    }\n  }\n  style(styles) {\n    if (styles.separatorBorder.isTransparent()) {\n      this.el.classList.remove('separator-border');\n      this.el.style.removeProperty('--separator-border');\n    } else {\n      this.el.classList.add('separator-border');\n      this.el.style.setProperty('--separator-border', styles.separatorBorder.toString());\n    }\n  }\n  /**\n   * Add a {@link IView view} to this {@link SplitView}.\n   *\n   * @param view The view to add.\n   * @param size Either a fixed size, or a dynamic {@link Sizing} strategy.\n   * @param index The index to insert the view on.\n   * @param skipLayout Whether layout should be skipped.\n   */\n  addView(view, size) {\n    let index = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.viewItems.length;\n    let skipLayout = arguments.length > 3 ? arguments[3] : undefined;\n    this.doAddView(view, size, index, skipLayout);\n  }\n  /**\n   * Layout the {@link SplitView}.\n   *\n   * @param size The entire size of the {@link SplitView}.\n   * @param layoutContext An optional layout context to pass along to {@link IView views}.\n   */\n  layout(size, layoutContext) {\n    const previousSize = Math.max(this.size, this._contentSize);\n    this.size = size;\n    this.layoutContext = layoutContext;\n    if (!this.proportions) {\n      const indexes = range(this.viewItems.length);\n      const lowPriorityIndexes = indexes.filter(i => this.viewItems[i].priority === 1 /* LayoutPriority.Low */);\n      const highPriorityIndexes = indexes.filter(i => this.viewItems[i].priority === 2 /* LayoutPriority.High */);\n      this.resize(this.viewItems.length - 1, size - previousSize, undefined, lowPriorityIndexes, highPriorityIndexes);\n    } else {\n      let total = 0;\n      for (let i = 0; i < this.viewItems.length; i++) {\n        const item = this.viewItems[i];\n        const proportion = this.proportions[i];\n        if (typeof proportion === 'number') {\n          total += proportion;\n        } else {\n          size -= item.size;\n        }\n      }\n      for (let i = 0; i < this.viewItems.length; i++) {\n        const item = this.viewItems[i];\n        const proportion = this.proportions[i];\n        if (typeof proportion === 'number' && total > 0) {\n          item.size = clamp(Math.round(proportion * size / total), item.minimumSize, item.maximumSize);\n        }\n      }\n    }\n    this.distributeEmptySpace();\n    this.layoutViews();\n  }\n  saveProportions() {\n    if (this.proportionalLayout && this._contentSize > 0) {\n      this.proportions = this.viewItems.map(v => v.proportionalLayout && v.visible ? v.size / this._contentSize : undefined);\n    }\n  }\n  onSashStart(_ref) {\n    let {\n      sash,\n      start,\n      alt\n    } = _ref;\n    for (const item of this.viewItems) {\n      item.enabled = false;\n    }\n    const index = this.sashItems.findIndex(item => item.sash === sash);\n    // This way, we can press Alt while we resize a sash, macOS style!\n    const disposable = combinedDisposable(addDisposableListener(this.el.ownerDocument.body, 'keydown', e => resetSashDragState(this.sashDragState.current, e.altKey)), addDisposableListener(this.el.ownerDocument.body, 'keyup', () => resetSashDragState(this.sashDragState.current, false)));\n    const resetSashDragState = (start, alt) => {\n      const sizes = this.viewItems.map(i => i.size);\n      let minDelta = Number.NEGATIVE_INFINITY;\n      let maxDelta = Number.POSITIVE_INFINITY;\n      if (this.inverseAltBehavior) {\n        alt = !alt;\n      }\n      if (alt) {\n        // When we're using the last sash with Alt, we're resizing\n        // the view to the left/up, instead of right/down as usual\n        // Thus, we must do the inverse of the usual\n        const isLastSash = index === this.sashItems.length - 1;\n        if (isLastSash) {\n          const viewItem = this.viewItems[index];\n          minDelta = (viewItem.minimumSize - viewItem.size) / 2;\n          maxDelta = (viewItem.maximumSize - viewItem.size) / 2;\n        } else {\n          const viewItem = this.viewItems[index + 1];\n          minDelta = (viewItem.size - viewItem.maximumSize) / 2;\n          maxDelta = (viewItem.size - viewItem.minimumSize) / 2;\n        }\n      }\n      let snapBefore;\n      let snapAfter;\n      if (!alt) {\n        const upIndexes = range(index, -1);\n        const downIndexes = range(index + 1, this.viewItems.length);\n        const minDeltaUp = upIndexes.reduce((r, i) => r + (this.viewItems[i].minimumSize - sizes[i]), 0);\n        const maxDeltaUp = upIndexes.reduce((r, i) => r + (this.viewItems[i].viewMaximumSize - sizes[i]), 0);\n        const maxDeltaDown = downIndexes.length === 0 ? Number.POSITIVE_INFINITY : downIndexes.reduce((r, i) => r + (sizes[i] - this.viewItems[i].minimumSize), 0);\n        const minDeltaDown = downIndexes.length === 0 ? Number.NEGATIVE_INFINITY : downIndexes.reduce((r, i) => r + (sizes[i] - this.viewItems[i].viewMaximumSize), 0);\n        const minDelta = Math.max(minDeltaUp, minDeltaDown);\n        const maxDelta = Math.min(maxDeltaDown, maxDeltaUp);\n        const snapBeforeIndex = this.findFirstSnapIndex(upIndexes);\n        const snapAfterIndex = this.findFirstSnapIndex(downIndexes);\n        if (typeof snapBeforeIndex === 'number') {\n          const viewItem = this.viewItems[snapBeforeIndex];\n          const halfSize = Math.floor(viewItem.viewMinimumSize / 2);\n          snapBefore = {\n            index: snapBeforeIndex,\n            limitDelta: viewItem.visible ? minDelta - halfSize : minDelta + halfSize,\n            size: viewItem.size\n          };\n        }\n        if (typeof snapAfterIndex === 'number') {\n          const viewItem = this.viewItems[snapAfterIndex];\n          const halfSize = Math.floor(viewItem.viewMinimumSize / 2);\n          snapAfter = {\n            index: snapAfterIndex,\n            limitDelta: viewItem.visible ? maxDelta + halfSize : maxDelta - halfSize,\n            size: viewItem.size\n          };\n        }\n      }\n      this.sashDragState = {\n        start,\n        current: start,\n        index,\n        sizes,\n        minDelta,\n        maxDelta,\n        alt,\n        snapBefore,\n        snapAfter,\n        disposable\n      };\n    };\n    resetSashDragState(start, alt);\n  }\n  onSashChange(_ref2) {\n    let {\n      current\n    } = _ref2;\n    const {\n      index,\n      start,\n      sizes,\n      alt,\n      minDelta,\n      maxDelta,\n      snapBefore,\n      snapAfter\n    } = this.sashDragState;\n    this.sashDragState.current = current;\n    const delta = current - start;\n    const newDelta = this.resize(index, delta, sizes, undefined, undefined, minDelta, maxDelta, snapBefore, snapAfter);\n    if (alt) {\n      const isLastSash = index === this.sashItems.length - 1;\n      const newSizes = this.viewItems.map(i => i.size);\n      const viewItemIndex = isLastSash ? index : index + 1;\n      const viewItem = this.viewItems[viewItemIndex];\n      const newMinDelta = viewItem.size - viewItem.maximumSize;\n      const newMaxDelta = viewItem.size - viewItem.minimumSize;\n      const resizeIndex = isLastSash ? index - 1 : index + 1;\n      this.resize(resizeIndex, -newDelta, newSizes, undefined, undefined, newMinDelta, newMaxDelta);\n    }\n    this.distributeEmptySpace();\n    this.layoutViews();\n  }\n  onSashEnd(index) {\n    this._onDidSashChange.fire(index);\n    this.sashDragState.disposable.dispose();\n    this.saveProportions();\n    for (const item of this.viewItems) {\n      item.enabled = true;\n    }\n  }\n  onViewChange(item, size) {\n    const index = this.viewItems.indexOf(item);\n    if (index < 0 || index >= this.viewItems.length) {\n      return;\n    }\n    size = typeof size === 'number' ? size : item.size;\n    size = clamp(size, item.minimumSize, item.maximumSize);\n    if (this.inverseAltBehavior && index > 0) {\n      // In this case, we want the view to grow or shrink both sides equally\n      // so we just resize the \"left\" side by half and let `resize` do the clamping magic\n      this.resize(index - 1, Math.floor((item.size - size) / 2));\n      this.distributeEmptySpace();\n      this.layoutViews();\n    } else {\n      item.size = size;\n      this.relayout([index], undefined);\n    }\n  }\n  /**\n   * Resize a {@link IView view} within the {@link SplitView}.\n   *\n   * @param index The {@link IView view} index.\n   * @param size The {@link IView view} size.\n   */\n  resizeView(index, size) {\n    if (index < 0 || index >= this.viewItems.length) {\n      return;\n    }\n    if (this.state !== State.Idle) {\n      throw new Error('Cant modify splitview');\n    }\n    this.state = State.Busy;\n    try {\n      const indexes = range(this.viewItems.length).filter(i => i !== index);\n      const lowPriorityIndexes = [...indexes.filter(i => this.viewItems[i].priority === 1 /* LayoutPriority.Low */), index];\n      const highPriorityIndexes = indexes.filter(i => this.viewItems[i].priority === 2 /* LayoutPriority.High */);\n      const item = this.viewItems[index];\n      size = Math.round(size);\n      size = clamp(size, item.minimumSize, Math.min(item.maximumSize, this.size));\n      item.size = size;\n      this.relayout(lowPriorityIndexes, highPriorityIndexes);\n    } finally {\n      this.state = State.Idle;\n    }\n  }\n  /**\n   * Distribute the entire {@link SplitView} size among all {@link IView views}.\n   */\n  distributeViewSizes() {\n    const flexibleViewItems = [];\n    let flexibleSize = 0;\n    for (const item of this.viewItems) {\n      if (item.maximumSize - item.minimumSize > 0) {\n        flexibleViewItems.push(item);\n        flexibleSize += item.size;\n      }\n    }\n    const size = Math.floor(flexibleSize / flexibleViewItems.length);\n    for (const item of flexibleViewItems) {\n      item.size = clamp(size, item.minimumSize, item.maximumSize);\n    }\n    const indexes = range(this.viewItems.length);\n    const lowPriorityIndexes = indexes.filter(i => this.viewItems[i].priority === 1 /* LayoutPriority.Low */);\n    const highPriorityIndexes = indexes.filter(i => this.viewItems[i].priority === 2 /* LayoutPriority.High */);\n    this.relayout(lowPriorityIndexes, highPriorityIndexes);\n  }\n  /**\n   * Returns the size of a {@link IView view}.\n   */\n  getViewSize(index) {\n    if (index < 0 || index >= this.viewItems.length) {\n      return -1;\n    }\n    return this.viewItems[index].size;\n  }\n  doAddView(view, size) {\n    let index = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.viewItems.length;\n    let skipLayout = arguments.length > 3 ? arguments[3] : undefined;\n    if (this.state !== State.Idle) {\n      throw new Error('Cant modify splitview');\n    }\n    this.state = State.Busy;\n    try {\n      // Add view\n      const container = $('.split-view-view');\n      if (index === this.viewItems.length) {\n        this.viewContainer.appendChild(container);\n      } else {\n        this.viewContainer.insertBefore(container, this.viewContainer.children.item(index));\n      }\n      const onChangeDisposable = view.onDidChange(size => this.onViewChange(item, size));\n      const containerDisposable = toDisposable(() => this.viewContainer.removeChild(container));\n      const disposable = combinedDisposable(onChangeDisposable, containerDisposable);\n      let viewSize;\n      if (typeof size === 'number') {\n        viewSize = size;\n      } else {\n        if (size.type === 'auto') {\n          if (this.areViewsDistributed()) {\n            size = {\n              type: 'distribute'\n            };\n          } else {\n            size = {\n              type: 'split',\n              index: size.index\n            };\n          }\n        }\n        if (size.type === 'split') {\n          viewSize = this.getViewSize(size.index) / 2;\n        } else if (size.type === 'invisible') {\n          viewSize = {\n            cachedVisibleSize: size.cachedVisibleSize\n          };\n        } else {\n          viewSize = view.minimumSize;\n        }\n      }\n      const item = this.orientation === 0 /* Orientation.VERTICAL */ ? new VerticalViewItem(container, view, viewSize, disposable) : new HorizontalViewItem(container, view, viewSize, disposable);\n      this.viewItems.splice(index, 0, item);\n      // Add sash\n      if (this.viewItems.length > 1) {\n        const opts = {\n          orthogonalStartSash: this.orthogonalStartSash,\n          orthogonalEndSash: this.orthogonalEndSash\n        };\n        const sash = this.orientation === 0 /* Orientation.VERTICAL */ ? new Sash(this.sashContainer, {\n          getHorizontalSashTop: s => this.getSashPosition(s),\n          getHorizontalSashWidth: this.getSashOrthogonalSize\n        }, {\n          ...opts,\n          orientation: 1 /* Orientation.HORIZONTAL */\n        }) : new Sash(this.sashContainer, {\n          getVerticalSashLeft: s => this.getSashPosition(s),\n          getVerticalSashHeight: this.getSashOrthogonalSize\n        }, {\n          ...opts,\n          orientation: 0 /* Orientation.VERTICAL */\n        });\n        const sashEventMapper = this.orientation === 0 /* Orientation.VERTICAL */ ? e => ({\n          sash,\n          start: e.startY,\n          current: e.currentY,\n          alt: e.altKey\n        }) : e => ({\n          sash,\n          start: e.startX,\n          current: e.currentX,\n          alt: e.altKey\n        });\n        const onStart = Event.map(sash.onDidStart, sashEventMapper);\n        const onStartDisposable = onStart(this.onSashStart, this);\n        const onChange = Event.map(sash.onDidChange, sashEventMapper);\n        const onChangeDisposable = onChange(this.onSashChange, this);\n        const onEnd = Event.map(sash.onDidEnd, () => this.sashItems.findIndex(item => item.sash === sash));\n        const onEndDisposable = onEnd(this.onSashEnd, this);\n        const onDidResetDisposable = sash.onDidReset(() => {\n          const index = this.sashItems.findIndex(item => item.sash === sash);\n          const upIndexes = range(index, -1);\n          const downIndexes = range(index + 1, this.viewItems.length);\n          const snapBeforeIndex = this.findFirstSnapIndex(upIndexes);\n          const snapAfterIndex = this.findFirstSnapIndex(downIndexes);\n          if (typeof snapBeforeIndex === 'number' && !this.viewItems[snapBeforeIndex].visible) {\n            return;\n          }\n          if (typeof snapAfterIndex === 'number' && !this.viewItems[snapAfterIndex].visible) {\n            return;\n          }\n          this._onDidSashReset.fire(index);\n        });\n        const disposable = combinedDisposable(onStartDisposable, onChangeDisposable, onEndDisposable, onDidResetDisposable, sash);\n        const sashItem = {\n          sash,\n          disposable\n        };\n        this.sashItems.splice(index - 1, 0, sashItem);\n      }\n      container.appendChild(view.element);\n      let highPriorityIndexes;\n      if (typeof size !== 'number' && size.type === 'split') {\n        highPriorityIndexes = [size.index];\n      }\n      if (!skipLayout) {\n        this.relayout([index], highPriorityIndexes);\n      }\n      if (!skipLayout && typeof size !== 'number' && size.type === 'distribute') {\n        this.distributeViewSizes();\n      }\n    } finally {\n      this.state = State.Idle;\n    }\n  }\n  relayout(lowPriorityIndexes, highPriorityIndexes) {\n    const contentSize = this.viewItems.reduce((r, i) => r + i.size, 0);\n    this.resize(this.viewItems.length - 1, this.size - contentSize, undefined, lowPriorityIndexes, highPriorityIndexes);\n    this.distributeEmptySpace();\n    this.layoutViews();\n    this.saveProportions();\n  }\n  resize(index, delta) {\n    let sizes = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : this.viewItems.map(i => i.size);\n    let lowPriorityIndexes = arguments.length > 3 ? arguments[3] : undefined;\n    let highPriorityIndexes = arguments.length > 4 ? arguments[4] : undefined;\n    let overloadMinDelta = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : Number.NEGATIVE_INFINITY;\n    let overloadMaxDelta = arguments.length > 6 && arguments[6] !== undefined ? arguments[6] : Number.POSITIVE_INFINITY;\n    let snapBefore = arguments.length > 7 ? arguments[7] : undefined;\n    let snapAfter = arguments.length > 8 ? arguments[8] : undefined;\n    if (index < 0 || index >= this.viewItems.length) {\n      return 0;\n    }\n    const upIndexes = range(index, -1);\n    const downIndexes = range(index + 1, this.viewItems.length);\n    if (highPriorityIndexes) {\n      for (const index of highPriorityIndexes) {\n        pushToStart(upIndexes, index);\n        pushToStart(downIndexes, index);\n      }\n    }\n    if (lowPriorityIndexes) {\n      for (const index of lowPriorityIndexes) {\n        pushToEnd(upIndexes, index);\n        pushToEnd(downIndexes, index);\n      }\n    }\n    const upItems = upIndexes.map(i => this.viewItems[i]);\n    const upSizes = upIndexes.map(i => sizes[i]);\n    const downItems = downIndexes.map(i => this.viewItems[i]);\n    const downSizes = downIndexes.map(i => sizes[i]);\n    const minDeltaUp = upIndexes.reduce((r, i) => r + (this.viewItems[i].minimumSize - sizes[i]), 0);\n    const maxDeltaUp = upIndexes.reduce((r, i) => r + (this.viewItems[i].maximumSize - sizes[i]), 0);\n    const maxDeltaDown = downIndexes.length === 0 ? Number.POSITIVE_INFINITY : downIndexes.reduce((r, i) => r + (sizes[i] - this.viewItems[i].minimumSize), 0);\n    const minDeltaDown = downIndexes.length === 0 ? Number.NEGATIVE_INFINITY : downIndexes.reduce((r, i) => r + (sizes[i] - this.viewItems[i].maximumSize), 0);\n    const minDelta = Math.max(minDeltaUp, minDeltaDown, overloadMinDelta);\n    const maxDelta = Math.min(maxDeltaDown, maxDeltaUp, overloadMaxDelta);\n    let snapped = false;\n    if (snapBefore) {\n      const snapView = this.viewItems[snapBefore.index];\n      const visible = delta >= snapBefore.limitDelta;\n      snapped = visible !== snapView.visible;\n      snapView.setVisible(visible, snapBefore.size);\n    }\n    if (!snapped && snapAfter) {\n      const snapView = this.viewItems[snapAfter.index];\n      const visible = delta < snapAfter.limitDelta;\n      snapped = visible !== snapView.visible;\n      snapView.setVisible(visible, snapAfter.size);\n    }\n    if (snapped) {\n      return this.resize(index, delta, sizes, lowPriorityIndexes, highPriorityIndexes, overloadMinDelta, overloadMaxDelta);\n    }\n    delta = clamp(delta, minDelta, maxDelta);\n    for (let i = 0, deltaUp = delta; i < upItems.length; i++) {\n      const item = upItems[i];\n      const size = clamp(upSizes[i] + deltaUp, item.minimumSize, item.maximumSize);\n      const viewDelta = size - upSizes[i];\n      deltaUp -= viewDelta;\n      item.size = size;\n    }\n    for (let i = 0, deltaDown = delta; i < downItems.length; i++) {\n      const item = downItems[i];\n      const size = clamp(downSizes[i] - deltaDown, item.minimumSize, item.maximumSize);\n      const viewDelta = size - downSizes[i];\n      deltaDown += viewDelta;\n      item.size = size;\n    }\n    return delta;\n  }\n  distributeEmptySpace(lowPriorityIndex) {\n    const contentSize = this.viewItems.reduce((r, i) => r + i.size, 0);\n    let emptyDelta = this.size - contentSize;\n    const indexes = range(this.viewItems.length - 1, -1);\n    const lowPriorityIndexes = indexes.filter(i => this.viewItems[i].priority === 1 /* LayoutPriority.Low */);\n    const highPriorityIndexes = indexes.filter(i => this.viewItems[i].priority === 2 /* LayoutPriority.High */);\n    for (const index of highPriorityIndexes) {\n      pushToStart(indexes, index);\n    }\n    for (const index of lowPriorityIndexes) {\n      pushToEnd(indexes, index);\n    }\n    if (typeof lowPriorityIndex === 'number') {\n      pushToEnd(indexes, lowPriorityIndex);\n    }\n    for (let i = 0; emptyDelta !== 0 && i < indexes.length; i++) {\n      const item = this.viewItems[indexes[i]];\n      const size = clamp(item.size + emptyDelta, item.minimumSize, item.maximumSize);\n      const viewDelta = size - item.size;\n      emptyDelta -= viewDelta;\n      item.size = size;\n    }\n  }\n  layoutViews() {\n    // Save new content size\n    this._contentSize = this.viewItems.reduce((r, i) => r + i.size, 0);\n    // Layout views\n    let offset = 0;\n    for (const viewItem of this.viewItems) {\n      viewItem.layout(offset, this.layoutContext);\n      offset += viewItem.size;\n    }\n    // Layout sashes\n    this.sashItems.forEach(item => item.sash.layout());\n    this.updateSashEnablement();\n    this.updateScrollableElement();\n  }\n  updateScrollableElement() {\n    if (this.orientation === 0 /* Orientation.VERTICAL */) {\n      this.scrollableElement.setScrollDimensions({\n        height: this.size,\n        scrollHeight: this._contentSize\n      });\n    } else {\n      this.scrollableElement.setScrollDimensions({\n        width: this.size,\n        scrollWidth: this._contentSize\n      });\n    }\n  }\n  updateSashEnablement() {\n    let previous = false;\n    const collapsesDown = this.viewItems.map(i => previous = i.size - i.minimumSize > 0 || previous);\n    previous = false;\n    const expandsDown = this.viewItems.map(i => previous = i.maximumSize - i.size > 0 || previous);\n    const reverseViews = [...this.viewItems].reverse();\n    previous = false;\n    const collapsesUp = reverseViews.map(i => previous = i.size - i.minimumSize > 0 || previous).reverse();\n    previous = false;\n    const expandsUp = reverseViews.map(i => previous = i.maximumSize - i.size > 0 || previous).reverse();\n    let position = 0;\n    for (let index = 0; index < this.sashItems.length; index++) {\n      const {\n        sash\n      } = this.sashItems[index];\n      const viewItem = this.viewItems[index];\n      position += viewItem.size;\n      const min = !(collapsesDown[index] && expandsUp[index + 1]);\n      const max = !(expandsDown[index] && collapsesUp[index + 1]);\n      if (min && max) {\n        const upIndexes = range(index, -1);\n        const downIndexes = range(index + 1, this.viewItems.length);\n        const snapBeforeIndex = this.findFirstSnapIndex(upIndexes);\n        const snapAfterIndex = this.findFirstSnapIndex(downIndexes);\n        const snappedBefore = typeof snapBeforeIndex === 'number' && !this.viewItems[snapBeforeIndex].visible;\n        const snappedAfter = typeof snapAfterIndex === 'number' && !this.viewItems[snapAfterIndex].visible;\n        if (snappedBefore && collapsesUp[index] && (position > 0 || this.startSnappingEnabled)) {\n          sash.state = 1 /* SashState.AtMinimum */;\n        } else if (snappedAfter && collapsesDown[index] && (position < this._contentSize || this.endSnappingEnabled)) {\n          sash.state = 2 /* SashState.AtMaximum */;\n        } else {\n          sash.state = 0 /* SashState.Disabled */;\n        }\n      } else if (min && !max) {\n        sash.state = 1 /* SashState.AtMinimum */;\n      } else if (!min && max) {\n        sash.state = 2 /* SashState.AtMaximum */;\n      } else {\n        sash.state = 3 /* SashState.Enabled */;\n      }\n    }\n  }\n  getSashPosition(sash) {\n    let position = 0;\n    for (let i = 0; i < this.sashItems.length; i++) {\n      position += this.viewItems[i].size;\n      if (this.sashItems[i].sash === sash) {\n        return position;\n      }\n    }\n    return 0;\n  }\n  findFirstSnapIndex(indexes) {\n    // visible views first\n    for (const index of indexes) {\n      const viewItem = this.viewItems[index];\n      if (!viewItem.visible) {\n        continue;\n      }\n      if (viewItem.snap) {\n        return index;\n      }\n    }\n    // then, hidden views\n    for (const index of indexes) {\n      const viewItem = this.viewItems[index];\n      if (viewItem.visible && viewItem.maximumSize - viewItem.minimumSize > 0) {\n        return undefined;\n      }\n      if (!viewItem.visible && viewItem.snap) {\n        return index;\n      }\n    }\n    return undefined;\n  }\n  areViewsDistributed() {\n    let min = undefined,\n      max = undefined;\n    for (const view of this.viewItems) {\n      min = min === undefined ? view.size : Math.min(min, view.size);\n      max = max === undefined ? view.size : Math.max(max, view.size);\n      if (max - min > 2) {\n        return false;\n      }\n    }\n    return true;\n  }\n  dispose() {\n    var _a;\n    (_a = this.sashDragState) === null || _a === void 0 ? void 0 : _a.disposable.dispose();\n    dispose(this.viewItems);\n    this.viewItems = [];\n    this.sashItems.forEach(i => i.disposable.dispose());\n    this.sashItems = [];\n    super.dispose();\n  }\n}","map":{"version":3,"names":["$","addDisposableListener","append","getWindow","scheduleAtNextAnimationFrame","DomEmitter","Sash","SmoothScrollableElement","pushToEnd","pushToStart","range","Color","Emitter","Event","combinedDisposable","Disposable","dispose","toDisposable","clamp","Scrollable","types","defaultStyles","separatorBorder","transparent","ViewItem","size","_size","visible","_cachedVisibleSize","setVisible","_a","_b","viewMinimumSize","viewMaximumSize","undefined","container","classList","toggle","view","call","e","console","error","minimumSize","maximumSize","priority","proportionalLayout","snap","enabled","style","pointerEvents","constructor","disposable","add","cachedVisibleSize","layout","offset","layoutContext","layoutContainer","VerticalViewItem","top","height","HorizontalViewItem","left","width","State","Sizing","Distribute","type","Split","index","Auto","Invisible","SplitView","orthogonalStartSash","_orthogonalStartSash","orthogonalEndSash","_orthogonalEndSash","startSnappingEnabled","_startSnappingEnabled","endSnappingEnabled","_endSnappingEnabled","sash","sashItem","sashItems","updateSashEnablement","options","arguments","length","_c","_d","_e","_contentSize","proportions","viewItems","state","Idle","_onDidSashChange","_register","_onDidSashReset","onDidSashChange","event","onDidSashReset","orientation","inverseAltBehavior","getSashOrthogonalSize","el","document","createElement","appendChild","sashContainer","viewContainer","scrollable","forceIntegerValues","smoothScrollDuration","callback","scrollableElement","vertical","scrollbarVisibility","horizontal","onDidScrollViewContainer","_","position","getScrollPosition","scrollLeft","Math","abs","scrollTop","setScrollPosition","onDidScroll","onScroll","scrollTopChanged","scrollLeftChanged","getDomNode","styles","descriptor","views","forEach","viewDescriptor","sizing","isUndefined","doAddView","reduce","r","i","saveProportions","isTransparent","remove","removeProperty","setProperty","toString","addView","skipLayout","previousSize","max","indexes","lowPriorityIndexes","filter","highPriorityIndexes","resize","total","item","proportion","round","distributeEmptySpace","layoutViews","map","v","onSashStart","_ref","start","alt","findIndex","ownerDocument","body","resetSashDragState","sashDragState","current","altKey","sizes","minDelta","Number","NEGATIVE_INFINITY","maxDelta","POSITIVE_INFINITY","isLastSash","viewItem","snapBefore","snapAfter","upIndexes","downIndexes","minDeltaUp","maxDeltaUp","maxDeltaDown","minDeltaDown","min","snapBeforeIndex","findFirstSnapIndex","snapAfterIndex","halfSize","floor","limitDelta","onSashChange","_ref2","delta","newDelta","newSizes","viewItemIndex","newMinDelta","newMaxDelta","resizeIndex","onSashEnd","fire","onViewChange","indexOf","relayout","resizeView","Error","Busy","distributeViewSizes","flexibleViewItems","flexibleSize","push","getViewSize","insertBefore","children","onChangeDisposable","onDidChange","containerDisposable","removeChild","viewSize","areViewsDistributed","splice","opts","getHorizontalSashTop","s","getSashPosition","getHorizontalSashWidth","getVerticalSashLeft","getVerticalSashHeight","sashEventMapper","startY","currentY","startX","currentX","onStart","onDidStart","onStartDisposable","onChange","onEnd","onDidEnd","onEndDisposable","onDidResetDisposable","onDidReset","element","contentSize","overloadMinDelta","overloadMaxDelta","upItems","upSizes","downItems","downSizes","snapped","snapView","deltaUp","viewDelta","deltaDown","lowPriorityIndex","emptyDelta","updateScrollableElement","setScrollDimensions","scrollHeight","scrollWidth","previous","collapsesDown","expandsDown","reverseViews","reverse","collapsesUp","expandsUp","snappedBefore","snappedAfter"],"sources":["/home/arslan/modojo/node_modules/monaco-editor/esm/vs/base/browser/ui/splitview/splitview.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { $, addDisposableListener, append, getWindow, scheduleAtNextAnimationFrame } from '../../dom.js';\nimport { DomEmitter } from '../../event.js';\nimport { Sash } from '../sash/sash.js';\nimport { SmoothScrollableElement } from '../scrollbar/scrollableElement.js';\nimport { pushToEnd, pushToStart, range } from '../../../common/arrays.js';\nimport { Color } from '../../../common/color.js';\nimport { Emitter, Event } from '../../../common/event.js';\nimport { combinedDisposable, Disposable, dispose, toDisposable } from '../../../common/lifecycle.js';\nimport { clamp } from '../../../common/numbers.js';\nimport { Scrollable } from '../../../common/scrollable.js';\nimport * as types from '../../../common/types.js';\nimport './splitview.css';\nconst defaultStyles = {\n    separatorBorder: Color.transparent\n};\nclass ViewItem {\n    set size(size) {\n        this._size = size;\n    }\n    get size() {\n        return this._size;\n    }\n    get visible() {\n        return typeof this._cachedVisibleSize === 'undefined';\n    }\n    setVisible(visible, size) {\n        var _a, _b;\n        if (visible === this.visible) {\n            return;\n        }\n        if (visible) {\n            this.size = clamp(this._cachedVisibleSize, this.viewMinimumSize, this.viewMaximumSize);\n            this._cachedVisibleSize = undefined;\n        }\n        else {\n            this._cachedVisibleSize = typeof size === 'number' ? size : this.size;\n            this.size = 0;\n        }\n        this.container.classList.toggle('visible', visible);\n        try {\n            (_b = (_a = this.view).setVisible) === null || _b === void 0 ? void 0 : _b.call(_a, visible);\n        }\n        catch (e) {\n            console.error('Splitview: Failed to set visible view');\n            console.error(e);\n        }\n    }\n    get minimumSize() { return this.visible ? this.view.minimumSize : 0; }\n    get viewMinimumSize() { return this.view.minimumSize; }\n    get maximumSize() { return this.visible ? this.view.maximumSize : 0; }\n    get viewMaximumSize() { return this.view.maximumSize; }\n    get priority() { return this.view.priority; }\n    get proportionalLayout() { var _a; return (_a = this.view.proportionalLayout) !== null && _a !== void 0 ? _a : true; }\n    get snap() { return !!this.view.snap; }\n    set enabled(enabled) {\n        this.container.style.pointerEvents = enabled ? '' : 'none';\n    }\n    constructor(container, view, size, disposable) {\n        this.container = container;\n        this.view = view;\n        this.disposable = disposable;\n        this._cachedVisibleSize = undefined;\n        if (typeof size === 'number') {\n            this._size = size;\n            this._cachedVisibleSize = undefined;\n            container.classList.add('visible');\n        }\n        else {\n            this._size = 0;\n            this._cachedVisibleSize = size.cachedVisibleSize;\n        }\n    }\n    layout(offset, layoutContext) {\n        this.layoutContainer(offset);\n        try {\n            this.view.layout(this.size, offset, layoutContext);\n        }\n        catch (e) {\n            console.error('Splitview: Failed to layout view');\n            console.error(e);\n        }\n    }\n    dispose() {\n        this.disposable.dispose();\n    }\n}\nclass VerticalViewItem extends ViewItem {\n    layoutContainer(offset) {\n        this.container.style.top = `${offset}px`;\n        this.container.style.height = `${this.size}px`;\n    }\n}\nclass HorizontalViewItem extends ViewItem {\n    layoutContainer(offset) {\n        this.container.style.left = `${offset}px`;\n        this.container.style.width = `${this.size}px`;\n    }\n}\nvar State;\n(function (State) {\n    State[State[\"Idle\"] = 0] = \"Idle\";\n    State[State[\"Busy\"] = 1] = \"Busy\";\n})(State || (State = {}));\nexport var Sizing;\n(function (Sizing) {\n    /**\n     * When adding or removing views, distribute the delta space among\n     * all other views.\n     */\n    Sizing.Distribute = { type: 'distribute' };\n    /**\n     * When adding or removing views, split the delta space with another\n     * specific view, indexed by the provided `index`.\n     */\n    function Split(index) { return { type: 'split', index }; }\n    Sizing.Split = Split;\n    /**\n     * When adding a view, use DistributeSizing when all pre-existing views are\n     * distributed evenly, otherwise use SplitSizing.\n     */\n    function Auto(index) { return { type: 'auto', index }; }\n    Sizing.Auto = Auto;\n    /**\n     * When adding or removing views, assume the view is invisible.\n     */\n    function Invisible(cachedVisibleSize) { return { type: 'invisible', cachedVisibleSize }; }\n    Sizing.Invisible = Invisible;\n})(Sizing || (Sizing = {}));\n/**\n * The {@link SplitView} is the UI component which implements a one dimensional\n * flex-like layout algorithm for a collection of {@link IView} instances, which\n * are essentially HTMLElement instances with the following size constraints:\n *\n * - {@link IView.minimumSize}\n * - {@link IView.maximumSize}\n * - {@link IView.priority}\n * - {@link IView.snap}\n *\n * In case the SplitView doesn't have enough size to fit all views, it will overflow\n * its content with a scrollbar.\n *\n * In between each pair of views there will be a {@link Sash} allowing the user\n * to resize the views, making sure the constraints are respected.\n *\n * An optional {@link TLayoutContext layout context type} may be used in order to\n * pass along layout contextual data from the {@link SplitView.layout} method down\n * to each view's {@link IView.layout} calls.\n *\n * Features:\n * - Flex-like layout algorithm\n * - Snap support\n * - Orthogonal sash support, for corner sashes\n * - View hide/show support\n * - View swap/move support\n * - Alt key modifier behavior, macOS style\n */\nexport class SplitView extends Disposable {\n    get orthogonalStartSash() { return this._orthogonalStartSash; }\n    get orthogonalEndSash() { return this._orthogonalEndSash; }\n    get startSnappingEnabled() { return this._startSnappingEnabled; }\n    get endSnappingEnabled() { return this._endSnappingEnabled; }\n    /**\n     * A reference to a sash, perpendicular to all sashes in this {@link SplitView},\n     * located at the left- or top-most side of the SplitView.\n     * Corner sashes will be created automatically at the intersections.\n     */\n    set orthogonalStartSash(sash) {\n        for (const sashItem of this.sashItems) {\n            sashItem.sash.orthogonalStartSash = sash;\n        }\n        this._orthogonalStartSash = sash;\n    }\n    /**\n     * A reference to a sash, perpendicular to all sashes in this {@link SplitView},\n     * located at the right- or bottom-most side of the SplitView.\n     * Corner sashes will be created automatically at the intersections.\n     */\n    set orthogonalEndSash(sash) {\n        for (const sashItem of this.sashItems) {\n            sashItem.sash.orthogonalEndSash = sash;\n        }\n        this._orthogonalEndSash = sash;\n    }\n    /**\n     * Enable/disable snapping at the beginning of this {@link SplitView}.\n     */\n    set startSnappingEnabled(startSnappingEnabled) {\n        if (this._startSnappingEnabled === startSnappingEnabled) {\n            return;\n        }\n        this._startSnappingEnabled = startSnappingEnabled;\n        this.updateSashEnablement();\n    }\n    /**\n     * Enable/disable snapping at the end of this {@link SplitView}.\n     */\n    set endSnappingEnabled(endSnappingEnabled) {\n        if (this._endSnappingEnabled === endSnappingEnabled) {\n            return;\n        }\n        this._endSnappingEnabled = endSnappingEnabled;\n        this.updateSashEnablement();\n    }\n    /**\n     * Create a new {@link SplitView} instance.\n     */\n    constructor(container, options = {}) {\n        var _a, _b, _c, _d, _e;\n        super();\n        this.size = 0;\n        this._contentSize = 0;\n        this.proportions = undefined;\n        this.viewItems = [];\n        this.sashItems = []; // used in tests\n        this.state = State.Idle;\n        this._onDidSashChange = this._register(new Emitter());\n        this._onDidSashReset = this._register(new Emitter());\n        this._startSnappingEnabled = true;\n        this._endSnappingEnabled = true;\n        /**\n         * Fires whenever the user resizes a {@link Sash sash}.\n         */\n        this.onDidSashChange = this._onDidSashChange.event;\n        /**\n         * Fires whenever the user double clicks a {@link Sash sash}.\n         */\n        this.onDidSashReset = this._onDidSashReset.event;\n        this.orientation = (_a = options.orientation) !== null && _a !== void 0 ? _a : 0 /* Orientation.VERTICAL */;\n        this.inverseAltBehavior = (_b = options.inverseAltBehavior) !== null && _b !== void 0 ? _b : false;\n        this.proportionalLayout = (_c = options.proportionalLayout) !== null && _c !== void 0 ? _c : true;\n        this.getSashOrthogonalSize = options.getSashOrthogonalSize;\n        this.el = document.createElement('div');\n        this.el.classList.add('monaco-split-view2');\n        this.el.classList.add(this.orientation === 0 /* Orientation.VERTICAL */ ? 'vertical' : 'horizontal');\n        container.appendChild(this.el);\n        this.sashContainer = append(this.el, $('.sash-container'));\n        this.viewContainer = $('.split-view-container');\n        this.scrollable = this._register(new Scrollable({\n            forceIntegerValues: true,\n            smoothScrollDuration: 125,\n            scheduleAtNextAnimationFrame: callback => scheduleAtNextAnimationFrame(getWindow(this.el), callback),\n        }));\n        this.scrollableElement = this._register(new SmoothScrollableElement(this.viewContainer, {\n            vertical: this.orientation === 0 /* Orientation.VERTICAL */ ? ((_d = options.scrollbarVisibility) !== null && _d !== void 0 ? _d : 1 /* ScrollbarVisibility.Auto */) : 2 /* ScrollbarVisibility.Hidden */,\n            horizontal: this.orientation === 1 /* Orientation.HORIZONTAL */ ? ((_e = options.scrollbarVisibility) !== null && _e !== void 0 ? _e : 1 /* ScrollbarVisibility.Auto */) : 2 /* ScrollbarVisibility.Hidden */\n        }, this.scrollable));\n        // https://github.com/microsoft/vscode/issues/157737\n        const onDidScrollViewContainer = this._register(new DomEmitter(this.viewContainer, 'scroll')).event;\n        this._register(onDidScrollViewContainer(_ => {\n            const position = this.scrollableElement.getScrollPosition();\n            const scrollLeft = Math.abs(this.viewContainer.scrollLeft - position.scrollLeft) <= 1 ? undefined : this.viewContainer.scrollLeft;\n            const scrollTop = Math.abs(this.viewContainer.scrollTop - position.scrollTop) <= 1 ? undefined : this.viewContainer.scrollTop;\n            if (scrollLeft !== undefined || scrollTop !== undefined) {\n                this.scrollableElement.setScrollPosition({ scrollLeft, scrollTop });\n            }\n        }));\n        this.onDidScroll = this.scrollableElement.onScroll;\n        this._register(this.onDidScroll(e => {\n            if (e.scrollTopChanged) {\n                this.viewContainer.scrollTop = e.scrollTop;\n            }\n            if (e.scrollLeftChanged) {\n                this.viewContainer.scrollLeft = e.scrollLeft;\n            }\n        }));\n        append(this.el, this.scrollableElement.getDomNode());\n        this.style(options.styles || defaultStyles);\n        // We have an existing set of view, add them now\n        if (options.descriptor) {\n            this.size = options.descriptor.size;\n            options.descriptor.views.forEach((viewDescriptor, index) => {\n                const sizing = types.isUndefined(viewDescriptor.visible) || viewDescriptor.visible ? viewDescriptor.size : { type: 'invisible', cachedVisibleSize: viewDescriptor.size };\n                const view = viewDescriptor.view;\n                this.doAddView(view, sizing, index, true);\n            });\n            // Initialize content size and proportions for first layout\n            this._contentSize = this.viewItems.reduce((r, i) => r + i.size, 0);\n            this.saveProportions();\n        }\n    }\n    style(styles) {\n        if (styles.separatorBorder.isTransparent()) {\n            this.el.classList.remove('separator-border');\n            this.el.style.removeProperty('--separator-border');\n        }\n        else {\n            this.el.classList.add('separator-border');\n            this.el.style.setProperty('--separator-border', styles.separatorBorder.toString());\n        }\n    }\n    /**\n     * Add a {@link IView view} to this {@link SplitView}.\n     *\n     * @param view The view to add.\n     * @param size Either a fixed size, or a dynamic {@link Sizing} strategy.\n     * @param index The index to insert the view on.\n     * @param skipLayout Whether layout should be skipped.\n     */\n    addView(view, size, index = this.viewItems.length, skipLayout) {\n        this.doAddView(view, size, index, skipLayout);\n    }\n    /**\n     * Layout the {@link SplitView}.\n     *\n     * @param size The entire size of the {@link SplitView}.\n     * @param layoutContext An optional layout context to pass along to {@link IView views}.\n     */\n    layout(size, layoutContext) {\n        const previousSize = Math.max(this.size, this._contentSize);\n        this.size = size;\n        this.layoutContext = layoutContext;\n        if (!this.proportions) {\n            const indexes = range(this.viewItems.length);\n            const lowPriorityIndexes = indexes.filter(i => this.viewItems[i].priority === 1 /* LayoutPriority.Low */);\n            const highPriorityIndexes = indexes.filter(i => this.viewItems[i].priority === 2 /* LayoutPriority.High */);\n            this.resize(this.viewItems.length - 1, size - previousSize, undefined, lowPriorityIndexes, highPriorityIndexes);\n        }\n        else {\n            let total = 0;\n            for (let i = 0; i < this.viewItems.length; i++) {\n                const item = this.viewItems[i];\n                const proportion = this.proportions[i];\n                if (typeof proportion === 'number') {\n                    total += proportion;\n                }\n                else {\n                    size -= item.size;\n                }\n            }\n            for (let i = 0; i < this.viewItems.length; i++) {\n                const item = this.viewItems[i];\n                const proportion = this.proportions[i];\n                if (typeof proportion === 'number' && total > 0) {\n                    item.size = clamp(Math.round(proportion * size / total), item.minimumSize, item.maximumSize);\n                }\n            }\n        }\n        this.distributeEmptySpace();\n        this.layoutViews();\n    }\n    saveProportions() {\n        if (this.proportionalLayout && this._contentSize > 0) {\n            this.proportions = this.viewItems.map(v => v.proportionalLayout && v.visible ? v.size / this._contentSize : undefined);\n        }\n    }\n    onSashStart({ sash, start, alt }) {\n        for (const item of this.viewItems) {\n            item.enabled = false;\n        }\n        const index = this.sashItems.findIndex(item => item.sash === sash);\n        // This way, we can press Alt while we resize a sash, macOS style!\n        const disposable = combinedDisposable(addDisposableListener(this.el.ownerDocument.body, 'keydown', e => resetSashDragState(this.sashDragState.current, e.altKey)), addDisposableListener(this.el.ownerDocument.body, 'keyup', () => resetSashDragState(this.sashDragState.current, false)));\n        const resetSashDragState = (start, alt) => {\n            const sizes = this.viewItems.map(i => i.size);\n            let minDelta = Number.NEGATIVE_INFINITY;\n            let maxDelta = Number.POSITIVE_INFINITY;\n            if (this.inverseAltBehavior) {\n                alt = !alt;\n            }\n            if (alt) {\n                // When we're using the last sash with Alt, we're resizing\n                // the view to the left/up, instead of right/down as usual\n                // Thus, we must do the inverse of the usual\n                const isLastSash = index === this.sashItems.length - 1;\n                if (isLastSash) {\n                    const viewItem = this.viewItems[index];\n                    minDelta = (viewItem.minimumSize - viewItem.size) / 2;\n                    maxDelta = (viewItem.maximumSize - viewItem.size) / 2;\n                }\n                else {\n                    const viewItem = this.viewItems[index + 1];\n                    minDelta = (viewItem.size - viewItem.maximumSize) / 2;\n                    maxDelta = (viewItem.size - viewItem.minimumSize) / 2;\n                }\n            }\n            let snapBefore;\n            let snapAfter;\n            if (!alt) {\n                const upIndexes = range(index, -1);\n                const downIndexes = range(index + 1, this.viewItems.length);\n                const minDeltaUp = upIndexes.reduce((r, i) => r + (this.viewItems[i].minimumSize - sizes[i]), 0);\n                const maxDeltaUp = upIndexes.reduce((r, i) => r + (this.viewItems[i].viewMaximumSize - sizes[i]), 0);\n                const maxDeltaDown = downIndexes.length === 0 ? Number.POSITIVE_INFINITY : downIndexes.reduce((r, i) => r + (sizes[i] - this.viewItems[i].minimumSize), 0);\n                const minDeltaDown = downIndexes.length === 0 ? Number.NEGATIVE_INFINITY : downIndexes.reduce((r, i) => r + (sizes[i] - this.viewItems[i].viewMaximumSize), 0);\n                const minDelta = Math.max(minDeltaUp, minDeltaDown);\n                const maxDelta = Math.min(maxDeltaDown, maxDeltaUp);\n                const snapBeforeIndex = this.findFirstSnapIndex(upIndexes);\n                const snapAfterIndex = this.findFirstSnapIndex(downIndexes);\n                if (typeof snapBeforeIndex === 'number') {\n                    const viewItem = this.viewItems[snapBeforeIndex];\n                    const halfSize = Math.floor(viewItem.viewMinimumSize / 2);\n                    snapBefore = {\n                        index: snapBeforeIndex,\n                        limitDelta: viewItem.visible ? minDelta - halfSize : minDelta + halfSize,\n                        size: viewItem.size\n                    };\n                }\n                if (typeof snapAfterIndex === 'number') {\n                    const viewItem = this.viewItems[snapAfterIndex];\n                    const halfSize = Math.floor(viewItem.viewMinimumSize / 2);\n                    snapAfter = {\n                        index: snapAfterIndex,\n                        limitDelta: viewItem.visible ? maxDelta + halfSize : maxDelta - halfSize,\n                        size: viewItem.size\n                    };\n                }\n            }\n            this.sashDragState = { start, current: start, index, sizes, minDelta, maxDelta, alt, snapBefore, snapAfter, disposable };\n        };\n        resetSashDragState(start, alt);\n    }\n    onSashChange({ current }) {\n        const { index, start, sizes, alt, minDelta, maxDelta, snapBefore, snapAfter } = this.sashDragState;\n        this.sashDragState.current = current;\n        const delta = current - start;\n        const newDelta = this.resize(index, delta, sizes, undefined, undefined, minDelta, maxDelta, snapBefore, snapAfter);\n        if (alt) {\n            const isLastSash = index === this.sashItems.length - 1;\n            const newSizes = this.viewItems.map(i => i.size);\n            const viewItemIndex = isLastSash ? index : index + 1;\n            const viewItem = this.viewItems[viewItemIndex];\n            const newMinDelta = viewItem.size - viewItem.maximumSize;\n            const newMaxDelta = viewItem.size - viewItem.minimumSize;\n            const resizeIndex = isLastSash ? index - 1 : index + 1;\n            this.resize(resizeIndex, -newDelta, newSizes, undefined, undefined, newMinDelta, newMaxDelta);\n        }\n        this.distributeEmptySpace();\n        this.layoutViews();\n    }\n    onSashEnd(index) {\n        this._onDidSashChange.fire(index);\n        this.sashDragState.disposable.dispose();\n        this.saveProportions();\n        for (const item of this.viewItems) {\n            item.enabled = true;\n        }\n    }\n    onViewChange(item, size) {\n        const index = this.viewItems.indexOf(item);\n        if (index < 0 || index >= this.viewItems.length) {\n            return;\n        }\n        size = typeof size === 'number' ? size : item.size;\n        size = clamp(size, item.minimumSize, item.maximumSize);\n        if (this.inverseAltBehavior && index > 0) {\n            // In this case, we want the view to grow or shrink both sides equally\n            // so we just resize the \"left\" side by half and let `resize` do the clamping magic\n            this.resize(index - 1, Math.floor((item.size - size) / 2));\n            this.distributeEmptySpace();\n            this.layoutViews();\n        }\n        else {\n            item.size = size;\n            this.relayout([index], undefined);\n        }\n    }\n    /**\n     * Resize a {@link IView view} within the {@link SplitView}.\n     *\n     * @param index The {@link IView view} index.\n     * @param size The {@link IView view} size.\n     */\n    resizeView(index, size) {\n        if (index < 0 || index >= this.viewItems.length) {\n            return;\n        }\n        if (this.state !== State.Idle) {\n            throw new Error('Cant modify splitview');\n        }\n        this.state = State.Busy;\n        try {\n            const indexes = range(this.viewItems.length).filter(i => i !== index);\n            const lowPriorityIndexes = [...indexes.filter(i => this.viewItems[i].priority === 1 /* LayoutPriority.Low */), index];\n            const highPriorityIndexes = indexes.filter(i => this.viewItems[i].priority === 2 /* LayoutPriority.High */);\n            const item = this.viewItems[index];\n            size = Math.round(size);\n            size = clamp(size, item.minimumSize, Math.min(item.maximumSize, this.size));\n            item.size = size;\n            this.relayout(lowPriorityIndexes, highPriorityIndexes);\n        }\n        finally {\n            this.state = State.Idle;\n        }\n    }\n    /**\n     * Distribute the entire {@link SplitView} size among all {@link IView views}.\n     */\n    distributeViewSizes() {\n        const flexibleViewItems = [];\n        let flexibleSize = 0;\n        for (const item of this.viewItems) {\n            if (item.maximumSize - item.minimumSize > 0) {\n                flexibleViewItems.push(item);\n                flexibleSize += item.size;\n            }\n        }\n        const size = Math.floor(flexibleSize / flexibleViewItems.length);\n        for (const item of flexibleViewItems) {\n            item.size = clamp(size, item.minimumSize, item.maximumSize);\n        }\n        const indexes = range(this.viewItems.length);\n        const lowPriorityIndexes = indexes.filter(i => this.viewItems[i].priority === 1 /* LayoutPriority.Low */);\n        const highPriorityIndexes = indexes.filter(i => this.viewItems[i].priority === 2 /* LayoutPriority.High */);\n        this.relayout(lowPriorityIndexes, highPriorityIndexes);\n    }\n    /**\n     * Returns the size of a {@link IView view}.\n     */\n    getViewSize(index) {\n        if (index < 0 || index >= this.viewItems.length) {\n            return -1;\n        }\n        return this.viewItems[index].size;\n    }\n    doAddView(view, size, index = this.viewItems.length, skipLayout) {\n        if (this.state !== State.Idle) {\n            throw new Error('Cant modify splitview');\n        }\n        this.state = State.Busy;\n        try {\n            // Add view\n            const container = $('.split-view-view');\n            if (index === this.viewItems.length) {\n                this.viewContainer.appendChild(container);\n            }\n            else {\n                this.viewContainer.insertBefore(container, this.viewContainer.children.item(index));\n            }\n            const onChangeDisposable = view.onDidChange(size => this.onViewChange(item, size));\n            const containerDisposable = toDisposable(() => this.viewContainer.removeChild(container));\n            const disposable = combinedDisposable(onChangeDisposable, containerDisposable);\n            let viewSize;\n            if (typeof size === 'number') {\n                viewSize = size;\n            }\n            else {\n                if (size.type === 'auto') {\n                    if (this.areViewsDistributed()) {\n                        size = { type: 'distribute' };\n                    }\n                    else {\n                        size = { type: 'split', index: size.index };\n                    }\n                }\n                if (size.type === 'split') {\n                    viewSize = this.getViewSize(size.index) / 2;\n                }\n                else if (size.type === 'invisible') {\n                    viewSize = { cachedVisibleSize: size.cachedVisibleSize };\n                }\n                else {\n                    viewSize = view.minimumSize;\n                }\n            }\n            const item = this.orientation === 0 /* Orientation.VERTICAL */\n                ? new VerticalViewItem(container, view, viewSize, disposable)\n                : new HorizontalViewItem(container, view, viewSize, disposable);\n            this.viewItems.splice(index, 0, item);\n            // Add sash\n            if (this.viewItems.length > 1) {\n                const opts = { orthogonalStartSash: this.orthogonalStartSash, orthogonalEndSash: this.orthogonalEndSash };\n                const sash = this.orientation === 0 /* Orientation.VERTICAL */\n                    ? new Sash(this.sashContainer, { getHorizontalSashTop: s => this.getSashPosition(s), getHorizontalSashWidth: this.getSashOrthogonalSize }, { ...opts, orientation: 1 /* Orientation.HORIZONTAL */ })\n                    : new Sash(this.sashContainer, { getVerticalSashLeft: s => this.getSashPosition(s), getVerticalSashHeight: this.getSashOrthogonalSize }, { ...opts, orientation: 0 /* Orientation.VERTICAL */ });\n                const sashEventMapper = this.orientation === 0 /* Orientation.VERTICAL */\n                    ? (e) => ({ sash, start: e.startY, current: e.currentY, alt: e.altKey })\n                    : (e) => ({ sash, start: e.startX, current: e.currentX, alt: e.altKey });\n                const onStart = Event.map(sash.onDidStart, sashEventMapper);\n                const onStartDisposable = onStart(this.onSashStart, this);\n                const onChange = Event.map(sash.onDidChange, sashEventMapper);\n                const onChangeDisposable = onChange(this.onSashChange, this);\n                const onEnd = Event.map(sash.onDidEnd, () => this.sashItems.findIndex(item => item.sash === sash));\n                const onEndDisposable = onEnd(this.onSashEnd, this);\n                const onDidResetDisposable = sash.onDidReset(() => {\n                    const index = this.sashItems.findIndex(item => item.sash === sash);\n                    const upIndexes = range(index, -1);\n                    const downIndexes = range(index + 1, this.viewItems.length);\n                    const snapBeforeIndex = this.findFirstSnapIndex(upIndexes);\n                    const snapAfterIndex = this.findFirstSnapIndex(downIndexes);\n                    if (typeof snapBeforeIndex === 'number' && !this.viewItems[snapBeforeIndex].visible) {\n                        return;\n                    }\n                    if (typeof snapAfterIndex === 'number' && !this.viewItems[snapAfterIndex].visible) {\n                        return;\n                    }\n                    this._onDidSashReset.fire(index);\n                });\n                const disposable = combinedDisposable(onStartDisposable, onChangeDisposable, onEndDisposable, onDidResetDisposable, sash);\n                const sashItem = { sash, disposable };\n                this.sashItems.splice(index - 1, 0, sashItem);\n            }\n            container.appendChild(view.element);\n            let highPriorityIndexes;\n            if (typeof size !== 'number' && size.type === 'split') {\n                highPriorityIndexes = [size.index];\n            }\n            if (!skipLayout) {\n                this.relayout([index], highPriorityIndexes);\n            }\n            if (!skipLayout && typeof size !== 'number' && size.type === 'distribute') {\n                this.distributeViewSizes();\n            }\n        }\n        finally {\n            this.state = State.Idle;\n        }\n    }\n    relayout(lowPriorityIndexes, highPriorityIndexes) {\n        const contentSize = this.viewItems.reduce((r, i) => r + i.size, 0);\n        this.resize(this.viewItems.length - 1, this.size - contentSize, undefined, lowPriorityIndexes, highPriorityIndexes);\n        this.distributeEmptySpace();\n        this.layoutViews();\n        this.saveProportions();\n    }\n    resize(index, delta, sizes = this.viewItems.map(i => i.size), lowPriorityIndexes, highPriorityIndexes, overloadMinDelta = Number.NEGATIVE_INFINITY, overloadMaxDelta = Number.POSITIVE_INFINITY, snapBefore, snapAfter) {\n        if (index < 0 || index >= this.viewItems.length) {\n            return 0;\n        }\n        const upIndexes = range(index, -1);\n        const downIndexes = range(index + 1, this.viewItems.length);\n        if (highPriorityIndexes) {\n            for (const index of highPriorityIndexes) {\n                pushToStart(upIndexes, index);\n                pushToStart(downIndexes, index);\n            }\n        }\n        if (lowPriorityIndexes) {\n            for (const index of lowPriorityIndexes) {\n                pushToEnd(upIndexes, index);\n                pushToEnd(downIndexes, index);\n            }\n        }\n        const upItems = upIndexes.map(i => this.viewItems[i]);\n        const upSizes = upIndexes.map(i => sizes[i]);\n        const downItems = downIndexes.map(i => this.viewItems[i]);\n        const downSizes = downIndexes.map(i => sizes[i]);\n        const minDeltaUp = upIndexes.reduce((r, i) => r + (this.viewItems[i].minimumSize - sizes[i]), 0);\n        const maxDeltaUp = upIndexes.reduce((r, i) => r + (this.viewItems[i].maximumSize - sizes[i]), 0);\n        const maxDeltaDown = downIndexes.length === 0 ? Number.POSITIVE_INFINITY : downIndexes.reduce((r, i) => r + (sizes[i] - this.viewItems[i].minimumSize), 0);\n        const minDeltaDown = downIndexes.length === 0 ? Number.NEGATIVE_INFINITY : downIndexes.reduce((r, i) => r + (sizes[i] - this.viewItems[i].maximumSize), 0);\n        const minDelta = Math.max(minDeltaUp, minDeltaDown, overloadMinDelta);\n        const maxDelta = Math.min(maxDeltaDown, maxDeltaUp, overloadMaxDelta);\n        let snapped = false;\n        if (snapBefore) {\n            const snapView = this.viewItems[snapBefore.index];\n            const visible = delta >= snapBefore.limitDelta;\n            snapped = visible !== snapView.visible;\n            snapView.setVisible(visible, snapBefore.size);\n        }\n        if (!snapped && snapAfter) {\n            const snapView = this.viewItems[snapAfter.index];\n            const visible = delta < snapAfter.limitDelta;\n            snapped = visible !== snapView.visible;\n            snapView.setVisible(visible, snapAfter.size);\n        }\n        if (snapped) {\n            return this.resize(index, delta, sizes, lowPriorityIndexes, highPriorityIndexes, overloadMinDelta, overloadMaxDelta);\n        }\n        delta = clamp(delta, minDelta, maxDelta);\n        for (let i = 0, deltaUp = delta; i < upItems.length; i++) {\n            const item = upItems[i];\n            const size = clamp(upSizes[i] + deltaUp, item.minimumSize, item.maximumSize);\n            const viewDelta = size - upSizes[i];\n            deltaUp -= viewDelta;\n            item.size = size;\n        }\n        for (let i = 0, deltaDown = delta; i < downItems.length; i++) {\n            const item = downItems[i];\n            const size = clamp(downSizes[i] - deltaDown, item.minimumSize, item.maximumSize);\n            const viewDelta = size - downSizes[i];\n            deltaDown += viewDelta;\n            item.size = size;\n        }\n        return delta;\n    }\n    distributeEmptySpace(lowPriorityIndex) {\n        const contentSize = this.viewItems.reduce((r, i) => r + i.size, 0);\n        let emptyDelta = this.size - contentSize;\n        const indexes = range(this.viewItems.length - 1, -1);\n        const lowPriorityIndexes = indexes.filter(i => this.viewItems[i].priority === 1 /* LayoutPriority.Low */);\n        const highPriorityIndexes = indexes.filter(i => this.viewItems[i].priority === 2 /* LayoutPriority.High */);\n        for (const index of highPriorityIndexes) {\n            pushToStart(indexes, index);\n        }\n        for (const index of lowPriorityIndexes) {\n            pushToEnd(indexes, index);\n        }\n        if (typeof lowPriorityIndex === 'number') {\n            pushToEnd(indexes, lowPriorityIndex);\n        }\n        for (let i = 0; emptyDelta !== 0 && i < indexes.length; i++) {\n            const item = this.viewItems[indexes[i]];\n            const size = clamp(item.size + emptyDelta, item.minimumSize, item.maximumSize);\n            const viewDelta = size - item.size;\n            emptyDelta -= viewDelta;\n            item.size = size;\n        }\n    }\n    layoutViews() {\n        // Save new content size\n        this._contentSize = this.viewItems.reduce((r, i) => r + i.size, 0);\n        // Layout views\n        let offset = 0;\n        for (const viewItem of this.viewItems) {\n            viewItem.layout(offset, this.layoutContext);\n            offset += viewItem.size;\n        }\n        // Layout sashes\n        this.sashItems.forEach(item => item.sash.layout());\n        this.updateSashEnablement();\n        this.updateScrollableElement();\n    }\n    updateScrollableElement() {\n        if (this.orientation === 0 /* Orientation.VERTICAL */) {\n            this.scrollableElement.setScrollDimensions({\n                height: this.size,\n                scrollHeight: this._contentSize\n            });\n        }\n        else {\n            this.scrollableElement.setScrollDimensions({\n                width: this.size,\n                scrollWidth: this._contentSize\n            });\n        }\n    }\n    updateSashEnablement() {\n        let previous = false;\n        const collapsesDown = this.viewItems.map(i => previous = (i.size - i.minimumSize > 0) || previous);\n        previous = false;\n        const expandsDown = this.viewItems.map(i => previous = (i.maximumSize - i.size > 0) || previous);\n        const reverseViews = [...this.viewItems].reverse();\n        previous = false;\n        const collapsesUp = reverseViews.map(i => previous = (i.size - i.minimumSize > 0) || previous).reverse();\n        previous = false;\n        const expandsUp = reverseViews.map(i => previous = (i.maximumSize - i.size > 0) || previous).reverse();\n        let position = 0;\n        for (let index = 0; index < this.sashItems.length; index++) {\n            const { sash } = this.sashItems[index];\n            const viewItem = this.viewItems[index];\n            position += viewItem.size;\n            const min = !(collapsesDown[index] && expandsUp[index + 1]);\n            const max = !(expandsDown[index] && collapsesUp[index + 1]);\n            if (min && max) {\n                const upIndexes = range(index, -1);\n                const downIndexes = range(index + 1, this.viewItems.length);\n                const snapBeforeIndex = this.findFirstSnapIndex(upIndexes);\n                const snapAfterIndex = this.findFirstSnapIndex(downIndexes);\n                const snappedBefore = typeof snapBeforeIndex === 'number' && !this.viewItems[snapBeforeIndex].visible;\n                const snappedAfter = typeof snapAfterIndex === 'number' && !this.viewItems[snapAfterIndex].visible;\n                if (snappedBefore && collapsesUp[index] && (position > 0 || this.startSnappingEnabled)) {\n                    sash.state = 1 /* SashState.AtMinimum */;\n                }\n                else if (snappedAfter && collapsesDown[index] && (position < this._contentSize || this.endSnappingEnabled)) {\n                    sash.state = 2 /* SashState.AtMaximum */;\n                }\n                else {\n                    sash.state = 0 /* SashState.Disabled */;\n                }\n            }\n            else if (min && !max) {\n                sash.state = 1 /* SashState.AtMinimum */;\n            }\n            else if (!min && max) {\n                sash.state = 2 /* SashState.AtMaximum */;\n            }\n            else {\n                sash.state = 3 /* SashState.Enabled */;\n            }\n        }\n    }\n    getSashPosition(sash) {\n        let position = 0;\n        for (let i = 0; i < this.sashItems.length; i++) {\n            position += this.viewItems[i].size;\n            if (this.sashItems[i].sash === sash) {\n                return position;\n            }\n        }\n        return 0;\n    }\n    findFirstSnapIndex(indexes) {\n        // visible views first\n        for (const index of indexes) {\n            const viewItem = this.viewItems[index];\n            if (!viewItem.visible) {\n                continue;\n            }\n            if (viewItem.snap) {\n                return index;\n            }\n        }\n        // then, hidden views\n        for (const index of indexes) {\n            const viewItem = this.viewItems[index];\n            if (viewItem.visible && viewItem.maximumSize - viewItem.minimumSize > 0) {\n                return undefined;\n            }\n            if (!viewItem.visible && viewItem.snap) {\n                return index;\n            }\n        }\n        return undefined;\n    }\n    areViewsDistributed() {\n        let min = undefined, max = undefined;\n        for (const view of this.viewItems) {\n            min = min === undefined ? view.size : Math.min(min, view.size);\n            max = max === undefined ? view.size : Math.max(max, view.size);\n            if (max - min > 2) {\n                return false;\n            }\n        }\n        return true;\n    }\n    dispose() {\n        var _a;\n        (_a = this.sashDragState) === null || _a === void 0 ? void 0 : _a.disposable.dispose();\n        dispose(this.viewItems);\n        this.viewItems = [];\n        this.sashItems.forEach(i => i.disposable.dispose());\n        this.sashItems = [];\n        super.dispose();\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}