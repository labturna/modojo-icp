{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { StandardKeyboardEvent } from '../../../../base/browser/keyboardEvent.js';\nimport * as aria from '../../../../base/browser/ui/aria/aria.js';\nimport { getBaseLayerHoverDelegate } from '../../../../base/browser/ui/hover/hoverDelegate2.js';\nimport { getDefaultHoverDelegate } from '../../../../base/browser/ui/hover/hoverDelegateFactory.js';\nimport { renderIcon } from '../../../../base/browser/ui/iconLabel/iconLabels.js';\nimport { List } from '../../../../base/browser/ui/list/listWidget.js';\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { DeferredPromise, raceCancellation } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { assertType, isDefined } from '../../../../base/common/types.js';\nimport './renameWidget.css';\nimport * as domFontInfo from '../../../browser/config/domFontInfo.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { NewSymbolNameTag, NewSymbolNameTriggerKind } from '../../../common/languages.js';\nimport * as nls from '../../../../nls.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { getListStyles } from '../../../../platform/theme/browser/defaultStyles.js';\nimport { editorWidgetBackground, inputBackground, inputBorder, inputForeground, quickInputListFocusBackground, quickInputListFocusForeground, widgetBorder, widgetShadow } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\n/** for debugging */\nconst _sticky = false;\nexport const CONTEXT_RENAME_INPUT_VISIBLE = new RawContextKey('renameInputVisible', false, localize('renameInputVisible', \"Whether the rename input widget is visible\"));\nexport const CONTEXT_RENAME_INPUT_FOCUSED = new RawContextKey('renameInputFocused', false, localize('renameInputFocused', \"Whether the rename input widget is focused\"));\nlet RenameWidget = class RenameWidget {\n  constructor(_editor, _acceptKeybindings, _themeService, _keybindingService, contextKeyService, _logService) {\n    this._editor = _editor;\n    this._acceptKeybindings = _acceptKeybindings;\n    this._themeService = _themeService;\n    this._keybindingService = _keybindingService;\n    this._logService = _logService;\n    // implement IContentWidget\n    this.allowEditorOverflow = true;\n    this._disposables = new DisposableStore();\n    this._visibleContextKey = CONTEXT_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n    this._isEditingRenameCandidate = false;\n    this._nRenameSuggestionsInvocations = 0;\n    this._hadAutomaticRenameSuggestionsInvocation = false;\n    this._candidates = new Set();\n    this._beforeFirstInputFieldEditSW = new StopWatch();\n    this._inputWithButton = new InputWithButton();\n    this._disposables.add(this._inputWithButton);\n    this._editor.addContentWidget(this);\n    this._disposables.add(this._editor.onDidChangeConfiguration(e => {\n      if (e.hasChanged(50 /* EditorOption.fontInfo */)) {\n        this._updateFont();\n      }\n    }));\n    this._disposables.add(_themeService.onDidColorThemeChange(this._updateStyles, this));\n  }\n  dispose() {\n    this._disposables.dispose();\n    this._editor.removeContentWidget(this);\n  }\n  getId() {\n    return '__renameInputWidget';\n  }\n  getDomNode() {\n    if (!this._domNode) {\n      this._domNode = document.createElement('div');\n      this._domNode.className = 'monaco-editor rename-box';\n      this._domNode.appendChild(this._inputWithButton.domNode);\n      this._renameCandidateListView = this._disposables.add(new RenameCandidateListView(this._domNode, {\n        fontInfo: this._editor.getOption(50 /* EditorOption.fontInfo */),\n        onFocusChange: newSymbolName => {\n          this._inputWithButton.input.value = newSymbolName;\n          this._isEditingRenameCandidate = false; // @ulugbekna: reset\n        },\n        onSelectionChange: () => {\n          this._isEditingRenameCandidate = false; // @ulugbekna: because user picked a rename suggestion\n          this.acceptInput(false); // we don't allow preview with mouse click for now\n        }\n      }));\n      this._disposables.add(this._inputWithButton.onDidInputChange(() => {\n        var _a, _b, _c, _d;\n        if (((_a = this._renameCandidateListView) === null || _a === void 0 ? void 0 : _a.focusedCandidate) !== undefined) {\n          this._isEditingRenameCandidate = true;\n        }\n        (_b = this._timeBeforeFirstInputFieldEdit) !== null && _b !== void 0 ? _b : this._timeBeforeFirstInputFieldEdit = this._beforeFirstInputFieldEditSW.elapsed();\n        if (((_c = this._renameCandidateProvidersCts) === null || _c === void 0 ? void 0 : _c.token.isCancellationRequested) === false) {\n          this._renameCandidateProvidersCts.cancel();\n        }\n        (_d = this._renameCandidateListView) === null || _d === void 0 ? void 0 : _d.clearFocus();\n      }));\n      this._label = document.createElement('div');\n      this._label.className = 'rename-label';\n      this._domNode.appendChild(this._label);\n      this._updateFont();\n      this._updateStyles(this._themeService.getColorTheme());\n    }\n    return this._domNode;\n  }\n  _updateStyles(theme) {\n    var _a, _b, _c, _d, _e;\n    if (!this._domNode) {\n      return;\n    }\n    const widgetShadowColor = theme.getColor(widgetShadow);\n    const widgetBorderColor = theme.getColor(widgetBorder);\n    this._domNode.style.backgroundColor = String((_a = theme.getColor(editorWidgetBackground)) !== null && _a !== void 0 ? _a : '');\n    this._domNode.style.boxShadow = widgetShadowColor ? ` 0 0 8px 2px ${widgetShadowColor}` : '';\n    this._domNode.style.border = widgetBorderColor ? `1px solid ${widgetBorderColor}` : '';\n    this._domNode.style.color = String((_b = theme.getColor(inputForeground)) !== null && _b !== void 0 ? _b : '');\n    const border = theme.getColor(inputBorder);\n    this._inputWithButton.domNode.style.backgroundColor = String((_c = theme.getColor(inputBackground)) !== null && _c !== void 0 ? _c : '');\n    this._inputWithButton.input.style.backgroundColor = String((_d = theme.getColor(inputBackground)) !== null && _d !== void 0 ? _d : '');\n    this._inputWithButton.domNode.style.borderWidth = border ? '1px' : '0px';\n    this._inputWithButton.domNode.style.borderStyle = border ? 'solid' : 'none';\n    this._inputWithButton.domNode.style.borderColor = (_e = border === null || border === void 0 ? void 0 : border.toString()) !== null && _e !== void 0 ? _e : 'none';\n  }\n  _updateFont() {\n    if (this._domNode === undefined) {\n      return;\n    }\n    assertType(this._label !== undefined, 'RenameWidget#_updateFont: _label must not be undefined given _domNode is defined');\n    this._editor.applyFontInfo(this._inputWithButton.input);\n    const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n    this._label.style.fontSize = `${this._computeLabelFontSize(fontInfo.fontSize)}px`;\n  }\n  _computeLabelFontSize(editorFontSize) {\n    return editorFontSize * 0.8;\n  }\n  getPosition() {\n    if (!this._visible) {\n      return null;\n    }\n    if (!this._editor.hasModel() ||\n    // @ulugbekna: shouldn't happen\n    !this._editor.getDomNode() // @ulugbekna: can happen during tests based on suggestWidget's similar predicate check\n    ) {\n      return null;\n    }\n    const bodyBox = dom.getClientArea(this.getDomNode().ownerDocument.body);\n    const editorBox = dom.getDomNodePagePosition(this._editor.getDomNode());\n    const cursorBoxTop = this._getTopForPosition();\n    this._nPxAvailableAbove = cursorBoxTop + editorBox.top;\n    this._nPxAvailableBelow = bodyBox.height - this._nPxAvailableAbove;\n    const lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n    const {\n      totalHeight: candidateViewHeight\n    } = RenameCandidateView.getLayoutInfo({\n      lineHeight\n    });\n    const positionPreference = this._nPxAvailableBelow > candidateViewHeight * 6 /* approximate # of candidates to fit in (inclusive of rename input box & rename label) */ ? [2 /* ContentWidgetPositionPreference.BELOW */, 1 /* ContentWidgetPositionPreference.ABOVE */] : [1 /* ContentWidgetPositionPreference.ABOVE */, 2 /* ContentWidgetPositionPreference.BELOW */];\n    return {\n      position: this._position,\n      preference: positionPreference\n    };\n  }\n  beforeRender() {\n    var _a, _b;\n    const [accept, preview] = this._acceptKeybindings;\n    this._label.innerText = localize({\n      key: 'label',\n      comment: ['placeholders are keybindings, e.g \"F2 to Rename, Shift+F2 to Preview\"']\n    }, \"{0} to Rename, {1} to Preview\", (_a = this._keybindingService.lookupKeybinding(accept)) === null || _a === void 0 ? void 0 : _a.getLabel(), (_b = this._keybindingService.lookupKeybinding(preview)) === null || _b === void 0 ? void 0 : _b.getLabel());\n    this._domNode.style.minWidth = `200px`; // to prevent from widening when candidates come in\n    return null;\n  }\n  afterRender(position) {\n    this._trace('invoking afterRender, position: ', position ? 'not null' : 'null');\n    if (position === null) {\n      // cancel rename when input widget isn't rendered anymore\n      this.cancelInput(true, 'afterRender (because position is null)');\n      return;\n    }\n    if (!this._editor.hasModel() ||\n    // shouldn't happen\n    !this._editor.getDomNode() // can happen during tests based on suggestWidget's similar predicate check\n    ) {\n      return;\n    }\n    assertType(this._renameCandidateListView);\n    assertType(this._nPxAvailableAbove !== undefined);\n    assertType(this._nPxAvailableBelow !== undefined);\n    const inputBoxHeight = dom.getTotalHeight(this._inputWithButton.domNode);\n    const labelHeight = dom.getTotalHeight(this._label);\n    let totalHeightAvailable;\n    if (position === 2 /* ContentWidgetPositionPreference.BELOW */) {\n      totalHeightAvailable = this._nPxAvailableBelow;\n    } else {\n      totalHeightAvailable = this._nPxAvailableAbove;\n    }\n    this._renameCandidateListView.layout({\n      height: totalHeightAvailable - labelHeight - inputBoxHeight,\n      width: dom.getTotalWidth(this._inputWithButton.domNode)\n    });\n  }\n  acceptInput(wantsPreview) {\n    var _a;\n    this._trace(`invoking acceptInput`);\n    (_a = this._currentAcceptInput) === null || _a === void 0 ? void 0 : _a.call(this, wantsPreview);\n  }\n  cancelInput(focusEditor, caller) {\n    var _a;\n    this._trace(`invoking cancelInput, caller: ${caller}, _currentCancelInput: ${this._currentAcceptInput ? 'not undefined' : 'undefined'}`);\n    (_a = this._currentCancelInput) === null || _a === void 0 ? void 0 : _a.call(this, focusEditor);\n  }\n  focusNextRenameSuggestion() {\n    var _a;\n    if (!((_a = this._renameCandidateListView) === null || _a === void 0 ? void 0 : _a.focusNext())) {\n      this._inputWithButton.input.value = this._currentName;\n    }\n  }\n  focusPreviousRenameSuggestion() {\n    var _a;\n    if (!((_a = this._renameCandidateListView) === null || _a === void 0 ? void 0 : _a.focusPrevious())) {\n      this._inputWithButton.input.value = this._currentName;\n    }\n  }\n  /**\n   * @param requestRenameCandidates is `undefined` when there are no rename suggestion providers\n   */\n  getInput(where, currentName, supportPreview, requestRenameCandidates, cts) {\n    const {\n      start: selectionStart,\n      end: selectionEnd\n    } = this._getSelection(where, currentName);\n    this._renameCts = cts;\n    const disposeOnDone = new DisposableStore();\n    this._nRenameSuggestionsInvocations = 0;\n    this._hadAutomaticRenameSuggestionsInvocation = false;\n    if (requestRenameCandidates === undefined) {\n      this._inputWithButton.button.style.display = 'none';\n    } else {\n      this._inputWithButton.button.style.display = 'flex';\n      this._requestRenameCandidatesOnce = requestRenameCandidates;\n      this._requestRenameCandidates(currentName, false);\n      disposeOnDone.add(dom.addDisposableListener(this._inputWithButton.button, 'click', () => this._requestRenameCandidates(currentName, true)));\n      disposeOnDone.add(dom.addDisposableListener(this._inputWithButton.button, dom.EventType.KEY_DOWN, e => {\n        const keyEvent = new StandardKeyboardEvent(e);\n        if (keyEvent.equals(3 /* KeyCode.Enter */) || keyEvent.equals(10 /* KeyCode.Space */)) {\n          keyEvent.stopPropagation();\n          keyEvent.preventDefault();\n          this._requestRenameCandidates(currentName, true);\n        }\n      }));\n    }\n    this._isEditingRenameCandidate = false;\n    this._domNode.classList.toggle('preview', supportPreview);\n    this._position = new Position(where.startLineNumber, where.startColumn);\n    this._currentName = currentName;\n    this._inputWithButton.input.value = currentName;\n    this._inputWithButton.input.setAttribute('selectionStart', selectionStart.toString());\n    this._inputWithButton.input.setAttribute('selectionEnd', selectionEnd.toString());\n    this._inputWithButton.input.size = Math.max((where.endColumn - where.startColumn) * 1.1, 20); // determines width\n    this._beforeFirstInputFieldEditSW.reset();\n    disposeOnDone.add(toDisposable(() => {\n      this._renameCts = undefined;\n      cts.dispose(true);\n    })); // @ulugbekna: this may result in `this.cancelInput` being called twice, but it should be safe since we set it to undefined after 1st call\n    disposeOnDone.add(toDisposable(() => {\n      if (this._renameCandidateProvidersCts !== undefined) {\n        this._renameCandidateProvidersCts.dispose(true);\n        this._renameCandidateProvidersCts = undefined;\n      }\n    }));\n    disposeOnDone.add(toDisposable(() => this._candidates.clear()));\n    const inputResult = new DeferredPromise();\n    inputResult.p.finally(() => {\n      disposeOnDone.dispose();\n      this._hide();\n    });\n    this._currentCancelInput = focusEditor => {\n      var _a;\n      this._trace('invoking _currentCancelInput');\n      this._currentAcceptInput = undefined;\n      this._currentCancelInput = undefined;\n      // fixme session cleanup\n      (_a = this._renameCandidateListView) === null || _a === void 0 ? void 0 : _a.clearCandidates();\n      inputResult.complete(focusEditor);\n      return true;\n    };\n    this._currentAcceptInput = wantsPreview => {\n      this._trace('invoking _currentAcceptInput');\n      assertType(this._renameCandidateListView !== undefined);\n      const nRenameSuggestions = this._renameCandidateListView.nCandidates;\n      let newName;\n      let source;\n      const focusedCandidate = this._renameCandidateListView.focusedCandidate;\n      if (focusedCandidate !== undefined) {\n        this._trace('using new name from renameSuggestion');\n        newName = focusedCandidate;\n        source = {\n          k: 'renameSuggestion'\n        };\n      } else {\n        this._trace('using new name from inputField');\n        newName = this._inputWithButton.input.value;\n        source = this._isEditingRenameCandidate ? {\n          k: 'userEditedRenameSuggestion'\n        } : {\n          k: 'inputField'\n        };\n      }\n      if (newName === currentName || newName.trim().length === 0 /* is just whitespace */) {\n        this.cancelInput(true, '_currentAcceptInput (because newName === value || newName.trim().length === 0)');\n        return;\n      }\n      this._currentAcceptInput = undefined;\n      this._currentCancelInput = undefined;\n      this._renameCandidateListView.clearCandidates();\n      // fixme session cleanup\n      inputResult.complete({\n        newName,\n        wantsPreview: supportPreview && wantsPreview,\n        stats: {\n          source,\n          nRenameSuggestions,\n          timeBeforeFirstInputFieldEdit: this._timeBeforeFirstInputFieldEdit,\n          nRenameSuggestionsInvocations: this._nRenameSuggestionsInvocations,\n          hadAutomaticRenameSuggestionsInvocation: this._hadAutomaticRenameSuggestionsInvocation\n        }\n      });\n    };\n    disposeOnDone.add(cts.token.onCancellationRequested(() => this.cancelInput(true, 'cts.token.onCancellationRequested')));\n    if (!_sticky) {\n      disposeOnDone.add(this._editor.onDidBlurEditorWidget(() => {\n        var _a;\n        return this.cancelInput(!((_a = this._domNode) === null || _a === void 0 ? void 0 : _a.ownerDocument.hasFocus()), 'editor.onDidBlurEditorWidget');\n      }));\n    }\n    this._show();\n    return inputResult.p;\n  }\n  _requestRenameCandidates(currentName, isManuallyTriggered) {\n    if (this._requestRenameCandidatesOnce === undefined) {\n      return;\n    }\n    if (this._renameCandidateProvidersCts !== undefined) {\n      this._renameCandidateProvidersCts.dispose(true);\n    }\n    assertType(this._renameCts);\n    if (this._inputWithButton.buttonState !== 'stop') {\n      this._renameCandidateProvidersCts = new CancellationTokenSource();\n      const triggerKind = isManuallyTriggered ? NewSymbolNameTriggerKind.Invoke : NewSymbolNameTriggerKind.Automatic;\n      const candidates = this._requestRenameCandidatesOnce(triggerKind, this._renameCandidateProvidersCts.token);\n      if (candidates.length === 0) {\n        this._inputWithButton.setSparkleButton();\n        return;\n      }\n      if (!isManuallyTriggered) {\n        this._hadAutomaticRenameSuggestionsInvocation = true;\n      }\n      this._nRenameSuggestionsInvocations += 1;\n      this._inputWithButton.setStopButton();\n      this._updateRenameCandidates(candidates, currentName, this._renameCts.token);\n    }\n  }\n  /**\n   * This allows selecting only part of the symbol name in the input field based on the selection in the editor\n   */\n  _getSelection(where, currentName) {\n    assertType(this._editor.hasModel());\n    const selection = this._editor.getSelection();\n    let start = 0;\n    let end = currentName.length;\n    if (!Range.isEmpty(selection) && !Range.spansMultipleLines(selection) && Range.containsRange(where, selection)) {\n      start = Math.max(0, selection.startColumn - where.startColumn);\n      end = Math.min(where.endColumn, selection.endColumn) - where.startColumn;\n    }\n    return {\n      start,\n      end\n    };\n  }\n  _show() {\n    this._trace('invoking _show');\n    this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber, 0 /* ScrollType.Smooth */);\n    this._visible = true;\n    this._visibleContextKey.set(true);\n    this._editor.layoutContentWidget(this);\n    // TODO@ulugbekna: could this be simply run in `afterRender`?\n    setTimeout(() => {\n      this._inputWithButton.input.focus();\n      this._inputWithButton.input.setSelectionRange(parseInt(this._inputWithButton.input.getAttribute('selectionStart')), parseInt(this._inputWithButton.input.getAttribute('selectionEnd')));\n    }, 100);\n  }\n  async _updateRenameCandidates(candidates, currentName, token) {\n    var _this = this;\n    const trace = function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      return _this._trace('_updateRenameCandidates', ...args);\n    };\n    trace('start');\n    const namesListResults = await raceCancellation(Promise.allSettled(candidates), token);\n    this._inputWithButton.setSparkleButton();\n    if (namesListResults === undefined) {\n      trace('returning early - received updateRenameCandidates results - undefined');\n      return;\n    }\n    const newNames = namesListResults.flatMap(namesListResult => namesListResult.status === 'fulfilled' && isDefined(namesListResult.value) ? namesListResult.value : []);\n    trace(`received updateRenameCandidates results - total (unfiltered) ${newNames.length} candidates.`);\n    // deduplicate and filter out the current value\n    const distinctNames = arrays.distinct(newNames, v => v.newSymbolName);\n    trace(`distinct candidates - ${distinctNames.length} candidates.`);\n    const validDistinctNames = distinctNames.filter(_ref => {\n      let {\n        newSymbolName\n      } = _ref;\n      return newSymbolName.trim().length > 0 && newSymbolName !== this._inputWithButton.input.value && newSymbolName !== currentName && !this._candidates.has(newSymbolName);\n    });\n    trace(`valid distinct candidates - ${newNames.length} candidates.`);\n    validDistinctNames.forEach(n => this._candidates.add(n.newSymbolName));\n    if (validDistinctNames.length < 1) {\n      trace('returning early - no valid distinct candidates');\n      return;\n    }\n    // show the candidates\n    trace('setting candidates');\n    this._renameCandidateListView.setCandidates(validDistinctNames);\n    // ask editor to re-layout given that the widget is now of a different size after rendering rename candidates\n    trace('asking editor to re-layout');\n    this._editor.layoutContentWidget(this);\n  }\n  _hide() {\n    this._trace('invoked _hide');\n    this._visible = false;\n    this._visibleContextKey.reset();\n    this._editor.layoutContentWidget(this);\n  }\n  _getTopForPosition() {\n    const visibleRanges = this._editor.getVisibleRanges();\n    let firstLineInViewport;\n    if (visibleRanges.length > 0) {\n      firstLineInViewport = visibleRanges[0].startLineNumber;\n    } else {\n      this._logService.warn('RenameWidget#_getTopForPosition: this should not happen - visibleRanges is empty');\n      firstLineInViewport = Math.max(1, this._position.lineNumber - 5); // @ulugbekna: fallback to current line minus 5\n    }\n    return this._editor.getTopForLineNumber(this._position.lineNumber) - this._editor.getTopForLineNumber(firstLineInViewport);\n  }\n  _trace() {\n    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      args[_key2] = arguments[_key2];\n    }\n    this._logService.trace('RenameWidget', ...args);\n  }\n};\nRenameWidget = __decorate([__param(2, IThemeService), __param(3, IKeybindingService), __param(4, IContextKeyService), __param(5, ILogService)], RenameWidget);\nexport { RenameWidget };\nclass RenameCandidateListView {\n  // FIXME@ulugbekna: rewrite using event emitters\n  constructor(parent, opts) {\n    this._disposables = new DisposableStore();\n    this._availableHeight = 0;\n    this._minimumWidth = 0;\n    this._lineHeight = opts.fontInfo.lineHeight;\n    this._typicalHalfwidthCharacterWidth = opts.fontInfo.typicalHalfwidthCharacterWidth;\n    this._listContainer = document.createElement('div');\n    this._listContainer.className = 'rename-box rename-candidate-list-container';\n    parent.appendChild(this._listContainer);\n    this._listWidget = RenameCandidateListView._createListWidget(this._listContainer, this._candidateViewHeight, opts.fontInfo);\n    this._listWidget.onDidChangeFocus(e => {\n      if (e.elements.length === 1) {\n        opts.onFocusChange(e.elements[0].newSymbolName);\n      }\n    }, this._disposables);\n    this._listWidget.onDidChangeSelection(e => {\n      if (e.elements.length === 1) {\n        opts.onSelectionChange();\n      }\n    }, this._disposables);\n    this._disposables.add(this._listWidget.onDidBlur(e => {\n      this._listWidget.setFocus([]);\n    }));\n    this._listWidget.style(getListStyles({\n      listInactiveFocusForeground: quickInputListFocusForeground,\n      listInactiveFocusBackground: quickInputListFocusBackground\n    }));\n  }\n  dispose() {\n    this._listWidget.dispose();\n    this._disposables.dispose();\n  }\n  // height - max height allowed by parent element\n  layout(_ref2) {\n    let {\n      height,\n      width\n    } = _ref2;\n    this._availableHeight = height;\n    this._minimumWidth = width;\n  }\n  setCandidates(candidates) {\n    // insert candidates into list widget\n    this._listWidget.splice(0, 0, candidates);\n    // adjust list widget layout\n    const height = this._pickListHeight(this._listWidget.length);\n    const width = this._pickListWidth(candidates);\n    this._listWidget.layout(height, width);\n    // adjust list container layout\n    this._listContainer.style.height = `${height}px`;\n    this._listContainer.style.width = `${width}px`;\n    aria.status(localize('renameSuggestionsReceivedAria', \"Received {0} rename suggestions\", candidates.length));\n  }\n  clearCandidates() {\n    this._listContainer.style.height = '0px';\n    this._listContainer.style.width = '0px';\n    this._listWidget.splice(0, this._listWidget.length, []);\n  }\n  get nCandidates() {\n    return this._listWidget.length;\n  }\n  get focusedCandidate() {\n    if (this._listWidget.length === 0) {\n      return;\n    }\n    const selectedElement = this._listWidget.getSelectedElements()[0];\n    if (selectedElement !== undefined) {\n      return selectedElement.newSymbolName;\n    }\n    const focusedElement = this._listWidget.getFocusedElements()[0];\n    if (focusedElement !== undefined) {\n      return focusedElement.newSymbolName;\n    }\n    return;\n  }\n  focusNext() {\n    if (this._listWidget.length === 0) {\n      return false;\n    }\n    const focusedIxs = this._listWidget.getFocus();\n    if (focusedIxs.length === 0) {\n      this._listWidget.focusFirst();\n      this._listWidget.reveal(0);\n      return true;\n    } else {\n      if (focusedIxs[0] === this._listWidget.length - 1) {\n        this._listWidget.setFocus([]);\n        this._listWidget.reveal(0); // @ulugbekna: without this, it seems like focused element is obstructed\n        return false;\n      } else {\n        this._listWidget.focusNext();\n        const focused = this._listWidget.getFocus()[0];\n        this._listWidget.reveal(focused);\n        return true;\n      }\n    }\n  }\n  /**\n   * @returns true if focus is moved to previous element\n   */\n  focusPrevious() {\n    if (this._listWidget.length === 0) {\n      return false;\n    }\n    const focusedIxs = this._listWidget.getFocus();\n    if (focusedIxs.length === 0) {\n      this._listWidget.focusLast();\n      const focused = this._listWidget.getFocus()[0];\n      this._listWidget.reveal(focused);\n      return true;\n    } else {\n      if (focusedIxs[0] === 0) {\n        this._listWidget.setFocus([]);\n        return false;\n      } else {\n        this._listWidget.focusPrevious();\n        const focused = this._listWidget.getFocus()[0];\n        this._listWidget.reveal(focused);\n        return true;\n      }\n    }\n  }\n  clearFocus() {\n    this._listWidget.setFocus([]);\n  }\n  get _candidateViewHeight() {\n    const {\n      totalHeight\n    } = RenameCandidateView.getLayoutInfo({\n      lineHeight: this._lineHeight\n    });\n    return totalHeight;\n  }\n  _pickListHeight(nCandidates) {\n    const heightToFitAllCandidates = this._candidateViewHeight * nCandidates;\n    const MAX_N_CANDIDATES = 7; // @ulugbekna: max # of candidates we want to show at once\n    const height = Math.min(heightToFitAllCandidates, this._availableHeight, this._candidateViewHeight * MAX_N_CANDIDATES);\n    return height;\n  }\n  _pickListWidth(candidates) {\n    const longestCandidateWidth = Math.ceil(Math.max(...candidates.map(c => c.newSymbolName.length)) * this._typicalHalfwidthCharacterWidth);\n    const width = Math.max(this._minimumWidth, 4 /* padding */ + 16 /* sparkle icon */ + 5 /* margin-left */ + longestCandidateWidth + 10 /* (possibly visible) scrollbar width */ // TODO@ulugbekna: approximate calc - clean this up\n    );\n    return width;\n  }\n  static _createListWidget(container, candidateViewHeight, fontInfo) {\n    const virtualDelegate = new class {\n      getTemplateId(element) {\n        return 'candidate';\n      }\n      getHeight(element) {\n        return candidateViewHeight;\n      }\n    }();\n    const renderer = new class {\n      constructor() {\n        this.templateId = 'candidate';\n      }\n      renderTemplate(container) {\n        return new RenameCandidateView(container, fontInfo);\n      }\n      renderElement(candidate, index, templateData) {\n        templateData.populate(candidate);\n      }\n      disposeTemplate(templateData) {\n        templateData.dispose();\n      }\n    }();\n    return new List('NewSymbolNameCandidates', container, virtualDelegate, [renderer], {\n      keyboardSupport: false,\n      // @ulugbekna: because we handle keyboard events through proper commands & keybinding service, see `rename.ts`\n      mouseSupport: true,\n      multipleSelectionSupport: false\n    });\n  }\n}\nclass InputWithButton {\n  constructor() {\n    this._onDidInputChange = new Emitter();\n    this.onDidInputChange = this._onDidInputChange.event;\n    this._disposables = new DisposableStore();\n  }\n  get domNode() {\n    if (!this._domNode) {\n      this._domNode = document.createElement('div');\n      this._domNode.className = 'rename-input-with-button';\n      this._domNode.style.display = 'flex';\n      this._domNode.style.flexDirection = 'row';\n      this._domNode.style.alignItems = 'center';\n      this._inputNode = document.createElement('input');\n      this._inputNode.className = 'rename-input';\n      this._inputNode.type = 'text';\n      this._inputNode.style.border = 'none';\n      this._inputNode.setAttribute('aria-label', localize('renameAriaLabel', \"Rename input. Type new name and press Enter to commit.\"));\n      this._domNode.appendChild(this._inputNode);\n      this._buttonNode = document.createElement('div');\n      this._buttonNode.className = 'rename-suggestions-button';\n      this._buttonNode.setAttribute('tabindex', '0');\n      this._buttonGenHoverText = nls.localize('generateRenameSuggestionsButton', \"Generate new name suggestions\");\n      this._buttonCancelHoverText = nls.localize('cancelRenameSuggestionsButton', \"Cancel\");\n      this._buttonHover = getBaseLayerHoverDelegate().setupUpdatableHover(getDefaultHoverDelegate('element'), this._buttonNode, this._buttonGenHoverText);\n      this._disposables.add(this._buttonHover);\n      this._domNode.appendChild(this._buttonNode);\n      // notify if selection changes to cancel request to rename-suggestion providers\n      this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.INPUT, () => this._onDidInputChange.fire()));\n      this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.KEY_DOWN, e => {\n        const keyEvent = new StandardKeyboardEvent(e);\n        if (keyEvent.keyCode === 15 /* KeyCode.LeftArrow */ || keyEvent.keyCode === 17 /* KeyCode.RightArrow */) {\n          this._onDidInputChange.fire();\n        }\n      }));\n      this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.CLICK, () => this._onDidInputChange.fire()));\n      // focus \"container\" border instead of input box\n      this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.FOCUS, () => {\n        this.domNode.style.outlineWidth = '1px';\n        this.domNode.style.outlineStyle = 'solid';\n        this.domNode.style.outlineOffset = '-1px';\n        this.domNode.style.outlineColor = 'var(--vscode-focusBorder)';\n      }));\n      this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.BLUR, () => {\n        this.domNode.style.outline = 'none';\n      }));\n    }\n    return this._domNode;\n  }\n  get input() {\n    assertType(this._inputNode);\n    return this._inputNode;\n  }\n  get button() {\n    assertType(this._buttonNode);\n    return this._buttonNode;\n  }\n  get buttonState() {\n    return this._buttonState;\n  }\n  setSparkleButton() {\n    var _a, _b;\n    this._buttonState = 'sparkle';\n    (_a = this._sparkleIcon) !== null && _a !== void 0 ? _a : this._sparkleIcon = renderIcon(Codicon.sparkle);\n    dom.clearNode(this.button);\n    this.button.appendChild(this._sparkleIcon);\n    this.button.setAttribute('aria-label', 'Generating new name suggestions');\n    (_b = this._buttonHover) === null || _b === void 0 ? void 0 : _b.update(this._buttonGenHoverText);\n    this.input.focus();\n  }\n  setStopButton() {\n    var _a, _b;\n    this._buttonState = 'stop';\n    (_a = this._stopIcon) !== null && _a !== void 0 ? _a : this._stopIcon = renderIcon(Codicon.primitiveSquare);\n    dom.clearNode(this.button);\n    this.button.appendChild(this._stopIcon);\n    this.button.setAttribute('aria-label', 'Cancel generating new name suggestions');\n    (_b = this._buttonHover) === null || _b === void 0 ? void 0 : _b.update(this._buttonCancelHoverText);\n    this.input.focus();\n  }\n  dispose() {\n    this._disposables.dispose();\n  }\n}\nclass RenameCandidateView {\n  constructor(parent, fontInfo) {\n    this._domNode = document.createElement('div');\n    this._domNode.className = 'rename-box rename-candidate';\n    this._domNode.style.display = `flex`;\n    this._domNode.style.columnGap = `5px`;\n    this._domNode.style.alignItems = `center`;\n    this._domNode.style.height = `${fontInfo.lineHeight}px`;\n    this._domNode.style.padding = `${RenameCandidateView._PADDING}px`;\n    // @ulugbekna: needed to keep space when the `icon.style.display` is set to `none`\n    const iconContainer = document.createElement('div');\n    iconContainer.style.display = `flex`;\n    iconContainer.style.alignItems = `center`;\n    iconContainer.style.width = iconContainer.style.height = `${fontInfo.lineHeight * 0.8}px`;\n    this._domNode.appendChild(iconContainer);\n    this._icon = renderIcon(Codicon.sparkle);\n    this._icon.style.display = `none`;\n    iconContainer.appendChild(this._icon);\n    this._label = document.createElement('div');\n    domFontInfo.applyFontInfo(this._label, fontInfo);\n    this._domNode.appendChild(this._label);\n    parent.appendChild(this._domNode);\n  }\n  populate(value) {\n    this._updateIcon(value);\n    this._updateLabel(value);\n  }\n  _updateIcon(value) {\n    var _a;\n    const isAIGenerated = !!((_a = value.tags) === null || _a === void 0 ? void 0 : _a.includes(NewSymbolNameTag.AIGenerated));\n    this._icon.style.display = isAIGenerated ? 'inherit' : 'none';\n  }\n  _updateLabel(value) {\n    this._label.innerText = value.newSymbolName;\n  }\n  static getLayoutInfo(_ref3) {\n    let {\n      lineHeight\n    } = _ref3;\n    const totalHeight = lineHeight + RenameCandidateView._PADDING * 2 /* top & bottom padding */;\n    return {\n      totalHeight\n    };\n  }\n  dispose() {}\n}\nRenameCandidateView._PADDING = 2;","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","dom","StandardKeyboardEvent","aria","getBaseLayerHoverDelegate","getDefaultHoverDelegate","renderIcon","List","arrays","DeferredPromise","raceCancellation","CancellationTokenSource","Codicon","Emitter","DisposableStore","toDisposable","StopWatch","assertType","isDefined","domFontInfo","Position","Range","NewSymbolNameTag","NewSymbolNameTriggerKind","nls","localize","IContextKeyService","RawContextKey","IKeybindingService","ILogService","getListStyles","editorWidgetBackground","inputBackground","inputBorder","inputForeground","quickInputListFocusBackground","quickInputListFocusForeground","widgetBorder","widgetShadow","IThemeService","_sticky","CONTEXT_RENAME_INPUT_VISIBLE","CONTEXT_RENAME_INPUT_FOCUSED","RenameWidget","constructor","_editor","_acceptKeybindings","_themeService","_keybindingService","contextKeyService","_logService","allowEditorOverflow","_disposables","_visibleContextKey","bindTo","_isEditingRenameCandidate","_nRenameSuggestionsInvocations","_hadAutomaticRenameSuggestionsInvocation","_candidates","Set","_beforeFirstInputFieldEditSW","_inputWithButton","InputWithButton","add","addContentWidget","onDidChangeConfiguration","e","hasChanged","_updateFont","onDidColorThemeChange","_updateStyles","dispose","removeContentWidget","getId","getDomNode","_domNode","document","createElement","className","appendChild","domNode","_renameCandidateListView","RenameCandidateListView","fontInfo","getOption","onFocusChange","newSymbolName","input","value","onSelectionChange","acceptInput","onDidInputChange","_a","_b","_c","_d","focusedCandidate","undefined","_timeBeforeFirstInputFieldEdit","elapsed","_renameCandidateProvidersCts","token","isCancellationRequested","cancel","clearFocus","_label","getColorTheme","theme","_e","widgetShadowColor","getColor","widgetBorderColor","style","backgroundColor","String","boxShadow","border","color","borderWidth","borderStyle","borderColor","toString","applyFontInfo","fontSize","_computeLabelFontSize","editorFontSize","getPosition","_visible","hasModel","bodyBox","getClientArea","ownerDocument","body","editorBox","getDomNodePagePosition","cursorBoxTop","_getTopForPosition","_nPxAvailableAbove","top","_nPxAvailableBelow","height","lineHeight","totalHeight","candidateViewHeight","RenameCandidateView","getLayoutInfo","positionPreference","position","_position","preference","beforeRender","accept","preview","innerText","comment","lookupKeybinding","getLabel","minWidth","afterRender","_trace","cancelInput","inputBoxHeight","getTotalHeight","labelHeight","totalHeightAvailable","layout","width","getTotalWidth","wantsPreview","_currentAcceptInput","call","focusEditor","caller","_currentCancelInput","focusNextRenameSuggestion","focusNext","_currentName","focusPreviousRenameSuggestion","focusPrevious","getInput","where","currentName","supportPreview","requestRenameCandidates","cts","start","selectionStart","end","selectionEnd","_getSelection","_renameCts","disposeOnDone","button","display","_requestRenameCandidatesOnce","_requestRenameCandidates","addDisposableListener","EventType","KEY_DOWN","keyEvent","equals","stopPropagation","preventDefault","classList","toggle","startLineNumber","startColumn","setAttribute","size","Math","max","endColumn","reset","clear","inputResult","p","finally","_hide","clearCandidates","complete","nRenameSuggestions","nCandidates","newName","source","k","trim","stats","timeBeforeFirstInputFieldEdit","nRenameSuggestionsInvocations","hadAutomaticRenameSuggestionsInvocation","onCancellationRequested","onDidBlurEditorWidget","hasFocus","_show","isManuallyTriggered","buttonState","triggerKind","Invoke","Automatic","candidates","setSparkleButton","setStopButton","_updateRenameCandidates","selection","getSelection","isEmpty","spansMultipleLines","containsRange","min","revealLineInCenterIfOutsideViewport","lineNumber","set","layoutContentWidget","setTimeout","focus","setSelectionRange","parseInt","getAttribute","_this","trace","_len","args","Array","_key","namesListResults","Promise","allSettled","newNames","flatMap","namesListResult","status","distinctNames","distinct","v","validDistinctNames","filter","_ref","has","forEach","n","setCandidates","visibleRanges","getVisibleRanges","firstLineInViewport","warn","getTopForLineNumber","_len2","_key2","parent","opts","_availableHeight","_minimumWidth","_lineHeight","_typicalHalfwidthCharacterWidth","typicalHalfwidthCharacterWidth","_listContainer","_listWidget","_createListWidget","_candidateViewHeight","onDidChangeFocus","elements","onDidChangeSelection","onDidBlur","setFocus","listInactiveFocusForeground","listInactiveFocusBackground","_ref2","splice","_pickListHeight","_pickListWidth","selectedElement","getSelectedElements","focusedElement","getFocusedElements","focusedIxs","getFocus","focusFirst","reveal","focused","focusLast","heightToFitAllCandidates","MAX_N_CANDIDATES","longestCandidateWidth","ceil","map","container","virtualDelegate","getTemplateId","element","getHeight","renderer","templateId","renderTemplate","renderElement","candidate","index","templateData","populate","disposeTemplate","keyboardSupport","mouseSupport","multipleSelectionSupport","_onDidInputChange","event","flexDirection","alignItems","_inputNode","type","_buttonNode","_buttonGenHoverText","_buttonCancelHoverText","_buttonHover","setupUpdatableHover","INPUT","fire","keyCode","CLICK","FOCUS","outlineWidth","outlineStyle","outlineOffset","outlineColor","BLUR","outline","_buttonState","_sparkleIcon","sparkle","clearNode","update","_stopIcon","primitiveSquare","columnGap","padding","_PADDING","iconContainer","_icon","_updateIcon","_updateLabel","isAIGenerated","tags","includes","AIGenerated","_ref3"],"sources":["/home/arslan/modojo/node_modules/monaco-editor/esm/vs/editor/contrib/rename/browser/renameWidget.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport * as dom from '../../../../base/browser/dom.js';\nimport { StandardKeyboardEvent } from '../../../../base/browser/keyboardEvent.js';\nimport * as aria from '../../../../base/browser/ui/aria/aria.js';\nimport { getBaseLayerHoverDelegate } from '../../../../base/browser/ui/hover/hoverDelegate2.js';\nimport { getDefaultHoverDelegate } from '../../../../base/browser/ui/hover/hoverDelegateFactory.js';\nimport { renderIcon } from '../../../../base/browser/ui/iconLabel/iconLabels.js';\nimport { List } from '../../../../base/browser/ui/list/listWidget.js';\nimport * as arrays from '../../../../base/common/arrays.js';\nimport { DeferredPromise, raceCancellation } from '../../../../base/common/async.js';\nimport { CancellationTokenSource } from '../../../../base/common/cancellation.js';\nimport { Codicon } from '../../../../base/common/codicons.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport { DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { StopWatch } from '../../../../base/common/stopwatch.js';\nimport { assertType, isDefined } from '../../../../base/common/types.js';\nimport './renameWidget.css';\nimport * as domFontInfo from '../../../browser/config/domFontInfo.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { NewSymbolNameTag, NewSymbolNameTriggerKind } from '../../../common/languages.js';\nimport * as nls from '../../../../nls.js';\nimport { localize } from '../../../../nls.js';\nimport { IContextKeyService, RawContextKey } from '../../../../platform/contextkey/common/contextkey.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { ILogService } from '../../../../platform/log/common/log.js';\nimport { getListStyles } from '../../../../platform/theme/browser/defaultStyles.js';\nimport { editorWidgetBackground, inputBackground, inputBorder, inputForeground, quickInputListFocusBackground, quickInputListFocusForeground, widgetBorder, widgetShadow } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IThemeService } from '../../../../platform/theme/common/themeService.js';\n/** for debugging */\nconst _sticky = false;\nexport const CONTEXT_RENAME_INPUT_VISIBLE = new RawContextKey('renameInputVisible', false, localize('renameInputVisible', \"Whether the rename input widget is visible\"));\nexport const CONTEXT_RENAME_INPUT_FOCUSED = new RawContextKey('renameInputFocused', false, localize('renameInputFocused', \"Whether the rename input widget is focused\"));\nlet RenameWidget = class RenameWidget {\n    constructor(_editor, _acceptKeybindings, _themeService, _keybindingService, contextKeyService, _logService) {\n        this._editor = _editor;\n        this._acceptKeybindings = _acceptKeybindings;\n        this._themeService = _themeService;\n        this._keybindingService = _keybindingService;\n        this._logService = _logService;\n        // implement IContentWidget\n        this.allowEditorOverflow = true;\n        this._disposables = new DisposableStore();\n        this._visibleContextKey = CONTEXT_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n        this._isEditingRenameCandidate = false;\n        this._nRenameSuggestionsInvocations = 0;\n        this._hadAutomaticRenameSuggestionsInvocation = false;\n        this._candidates = new Set();\n        this._beforeFirstInputFieldEditSW = new StopWatch();\n        this._inputWithButton = new InputWithButton();\n        this._disposables.add(this._inputWithButton);\n        this._editor.addContentWidget(this);\n        this._disposables.add(this._editor.onDidChangeConfiguration(e => {\n            if (e.hasChanged(50 /* EditorOption.fontInfo */)) {\n                this._updateFont();\n            }\n        }));\n        this._disposables.add(_themeService.onDidColorThemeChange(this._updateStyles, this));\n    }\n    dispose() {\n        this._disposables.dispose();\n        this._editor.removeContentWidget(this);\n    }\n    getId() {\n        return '__renameInputWidget';\n    }\n    getDomNode() {\n        if (!this._domNode) {\n            this._domNode = document.createElement('div');\n            this._domNode.className = 'monaco-editor rename-box';\n            this._domNode.appendChild(this._inputWithButton.domNode);\n            this._renameCandidateListView = this._disposables.add(new RenameCandidateListView(this._domNode, {\n                fontInfo: this._editor.getOption(50 /* EditorOption.fontInfo */),\n                onFocusChange: (newSymbolName) => {\n                    this._inputWithButton.input.value = newSymbolName;\n                    this._isEditingRenameCandidate = false; // @ulugbekna: reset\n                },\n                onSelectionChange: () => {\n                    this._isEditingRenameCandidate = false; // @ulugbekna: because user picked a rename suggestion\n                    this.acceptInput(false); // we don't allow preview with mouse click for now\n                }\n            }));\n            this._disposables.add(this._inputWithButton.onDidInputChange(() => {\n                var _a, _b, _c, _d;\n                if (((_a = this._renameCandidateListView) === null || _a === void 0 ? void 0 : _a.focusedCandidate) !== undefined) {\n                    this._isEditingRenameCandidate = true;\n                }\n                (_b = this._timeBeforeFirstInputFieldEdit) !== null && _b !== void 0 ? _b : (this._timeBeforeFirstInputFieldEdit = this._beforeFirstInputFieldEditSW.elapsed());\n                if (((_c = this._renameCandidateProvidersCts) === null || _c === void 0 ? void 0 : _c.token.isCancellationRequested) === false) {\n                    this._renameCandidateProvidersCts.cancel();\n                }\n                (_d = this._renameCandidateListView) === null || _d === void 0 ? void 0 : _d.clearFocus();\n            }));\n            this._label = document.createElement('div');\n            this._label.className = 'rename-label';\n            this._domNode.appendChild(this._label);\n            this._updateFont();\n            this._updateStyles(this._themeService.getColorTheme());\n        }\n        return this._domNode;\n    }\n    _updateStyles(theme) {\n        var _a, _b, _c, _d, _e;\n        if (!this._domNode) {\n            return;\n        }\n        const widgetShadowColor = theme.getColor(widgetShadow);\n        const widgetBorderColor = theme.getColor(widgetBorder);\n        this._domNode.style.backgroundColor = String((_a = theme.getColor(editorWidgetBackground)) !== null && _a !== void 0 ? _a : '');\n        this._domNode.style.boxShadow = widgetShadowColor ? ` 0 0 8px 2px ${widgetShadowColor}` : '';\n        this._domNode.style.border = widgetBorderColor ? `1px solid ${widgetBorderColor}` : '';\n        this._domNode.style.color = String((_b = theme.getColor(inputForeground)) !== null && _b !== void 0 ? _b : '');\n        const border = theme.getColor(inputBorder);\n        this._inputWithButton.domNode.style.backgroundColor = String((_c = theme.getColor(inputBackground)) !== null && _c !== void 0 ? _c : '');\n        this._inputWithButton.input.style.backgroundColor = String((_d = theme.getColor(inputBackground)) !== null && _d !== void 0 ? _d : '');\n        this._inputWithButton.domNode.style.borderWidth = border ? '1px' : '0px';\n        this._inputWithButton.domNode.style.borderStyle = border ? 'solid' : 'none';\n        this._inputWithButton.domNode.style.borderColor = (_e = border === null || border === void 0 ? void 0 : border.toString()) !== null && _e !== void 0 ? _e : 'none';\n    }\n    _updateFont() {\n        if (this._domNode === undefined) {\n            return;\n        }\n        assertType(this._label !== undefined, 'RenameWidget#_updateFont: _label must not be undefined given _domNode is defined');\n        this._editor.applyFontInfo(this._inputWithButton.input);\n        const fontInfo = this._editor.getOption(50 /* EditorOption.fontInfo */);\n        this._label.style.fontSize = `${this._computeLabelFontSize(fontInfo.fontSize)}px`;\n    }\n    _computeLabelFontSize(editorFontSize) {\n        return editorFontSize * 0.8;\n    }\n    getPosition() {\n        if (!this._visible) {\n            return null;\n        }\n        if (!this._editor.hasModel() || // @ulugbekna: shouldn't happen\n            !this._editor.getDomNode() // @ulugbekna: can happen during tests based on suggestWidget's similar predicate check\n        ) {\n            return null;\n        }\n        const bodyBox = dom.getClientArea(this.getDomNode().ownerDocument.body);\n        const editorBox = dom.getDomNodePagePosition(this._editor.getDomNode());\n        const cursorBoxTop = this._getTopForPosition();\n        this._nPxAvailableAbove = cursorBoxTop + editorBox.top;\n        this._nPxAvailableBelow = bodyBox.height - this._nPxAvailableAbove;\n        const lineHeight = this._editor.getOption(67 /* EditorOption.lineHeight */);\n        const { totalHeight: candidateViewHeight } = RenameCandidateView.getLayoutInfo({ lineHeight });\n        const positionPreference = this._nPxAvailableBelow > candidateViewHeight * 6 /* approximate # of candidates to fit in (inclusive of rename input box & rename label) */\n            ? [2 /* ContentWidgetPositionPreference.BELOW */, 1 /* ContentWidgetPositionPreference.ABOVE */]\n            : [1 /* ContentWidgetPositionPreference.ABOVE */, 2 /* ContentWidgetPositionPreference.BELOW */];\n        return {\n            position: this._position,\n            preference: positionPreference,\n        };\n    }\n    beforeRender() {\n        var _a, _b;\n        const [accept, preview] = this._acceptKeybindings;\n        this._label.innerText = localize({ key: 'label', comment: ['placeholders are keybindings, e.g \"F2 to Rename, Shift+F2 to Preview\"'] }, \"{0} to Rename, {1} to Preview\", (_a = this._keybindingService.lookupKeybinding(accept)) === null || _a === void 0 ? void 0 : _a.getLabel(), (_b = this._keybindingService.lookupKeybinding(preview)) === null || _b === void 0 ? void 0 : _b.getLabel());\n        this._domNode.style.minWidth = `200px`; // to prevent from widening when candidates come in\n        return null;\n    }\n    afterRender(position) {\n        this._trace('invoking afterRender, position: ', position ? 'not null' : 'null');\n        if (position === null) {\n            // cancel rename when input widget isn't rendered anymore\n            this.cancelInput(true, 'afterRender (because position is null)');\n            return;\n        }\n        if (!this._editor.hasModel() || // shouldn't happen\n            !this._editor.getDomNode() // can happen during tests based on suggestWidget's similar predicate check\n        ) {\n            return;\n        }\n        assertType(this._renameCandidateListView);\n        assertType(this._nPxAvailableAbove !== undefined);\n        assertType(this._nPxAvailableBelow !== undefined);\n        const inputBoxHeight = dom.getTotalHeight(this._inputWithButton.domNode);\n        const labelHeight = dom.getTotalHeight(this._label);\n        let totalHeightAvailable;\n        if (position === 2 /* ContentWidgetPositionPreference.BELOW */) {\n            totalHeightAvailable = this._nPxAvailableBelow;\n        }\n        else {\n            totalHeightAvailable = this._nPxAvailableAbove;\n        }\n        this._renameCandidateListView.layout({\n            height: totalHeightAvailable - labelHeight - inputBoxHeight,\n            width: dom.getTotalWidth(this._inputWithButton.domNode),\n        });\n    }\n    acceptInput(wantsPreview) {\n        var _a;\n        this._trace(`invoking acceptInput`);\n        (_a = this._currentAcceptInput) === null || _a === void 0 ? void 0 : _a.call(this, wantsPreview);\n    }\n    cancelInput(focusEditor, caller) {\n        var _a;\n        this._trace(`invoking cancelInput, caller: ${caller}, _currentCancelInput: ${this._currentAcceptInput ? 'not undefined' : 'undefined'}`);\n        (_a = this._currentCancelInput) === null || _a === void 0 ? void 0 : _a.call(this, focusEditor);\n    }\n    focusNextRenameSuggestion() {\n        var _a;\n        if (!((_a = this._renameCandidateListView) === null || _a === void 0 ? void 0 : _a.focusNext())) {\n            this._inputWithButton.input.value = this._currentName;\n        }\n    }\n    focusPreviousRenameSuggestion() {\n        var _a;\n        if (!((_a = this._renameCandidateListView) === null || _a === void 0 ? void 0 : _a.focusPrevious())) {\n            this._inputWithButton.input.value = this._currentName;\n        }\n    }\n    /**\n     * @param requestRenameCandidates is `undefined` when there are no rename suggestion providers\n     */\n    getInput(where, currentName, supportPreview, requestRenameCandidates, cts) {\n        const { start: selectionStart, end: selectionEnd } = this._getSelection(where, currentName);\n        this._renameCts = cts;\n        const disposeOnDone = new DisposableStore();\n        this._nRenameSuggestionsInvocations = 0;\n        this._hadAutomaticRenameSuggestionsInvocation = false;\n        if (requestRenameCandidates === undefined) {\n            this._inputWithButton.button.style.display = 'none';\n        }\n        else {\n            this._inputWithButton.button.style.display = 'flex';\n            this._requestRenameCandidatesOnce = requestRenameCandidates;\n            this._requestRenameCandidates(currentName, false);\n            disposeOnDone.add(dom.addDisposableListener(this._inputWithButton.button, 'click', () => this._requestRenameCandidates(currentName, true)));\n            disposeOnDone.add(dom.addDisposableListener(this._inputWithButton.button, dom.EventType.KEY_DOWN, (e) => {\n                const keyEvent = new StandardKeyboardEvent(e);\n                if (keyEvent.equals(3 /* KeyCode.Enter */) || keyEvent.equals(10 /* KeyCode.Space */)) {\n                    keyEvent.stopPropagation();\n                    keyEvent.preventDefault();\n                    this._requestRenameCandidates(currentName, true);\n                }\n            }));\n        }\n        this._isEditingRenameCandidate = false;\n        this._domNode.classList.toggle('preview', supportPreview);\n        this._position = new Position(where.startLineNumber, where.startColumn);\n        this._currentName = currentName;\n        this._inputWithButton.input.value = currentName;\n        this._inputWithButton.input.setAttribute('selectionStart', selectionStart.toString());\n        this._inputWithButton.input.setAttribute('selectionEnd', selectionEnd.toString());\n        this._inputWithButton.input.size = Math.max((where.endColumn - where.startColumn) * 1.1, 20); // determines width\n        this._beforeFirstInputFieldEditSW.reset();\n        disposeOnDone.add(toDisposable(() => {\n            this._renameCts = undefined;\n            cts.dispose(true);\n        })); // @ulugbekna: this may result in `this.cancelInput` being called twice, but it should be safe since we set it to undefined after 1st call\n        disposeOnDone.add(toDisposable(() => {\n            if (this._renameCandidateProvidersCts !== undefined) {\n                this._renameCandidateProvidersCts.dispose(true);\n                this._renameCandidateProvidersCts = undefined;\n            }\n        }));\n        disposeOnDone.add(toDisposable(() => this._candidates.clear()));\n        const inputResult = new DeferredPromise();\n        inputResult.p.finally(() => {\n            disposeOnDone.dispose();\n            this._hide();\n        });\n        this._currentCancelInput = (focusEditor) => {\n            var _a;\n            this._trace('invoking _currentCancelInput');\n            this._currentAcceptInput = undefined;\n            this._currentCancelInput = undefined;\n            // fixme session cleanup\n            (_a = this._renameCandidateListView) === null || _a === void 0 ? void 0 : _a.clearCandidates();\n            inputResult.complete(focusEditor);\n            return true;\n        };\n        this._currentAcceptInput = (wantsPreview) => {\n            this._trace('invoking _currentAcceptInput');\n            assertType(this._renameCandidateListView !== undefined);\n            const nRenameSuggestions = this._renameCandidateListView.nCandidates;\n            let newName;\n            let source;\n            const focusedCandidate = this._renameCandidateListView.focusedCandidate;\n            if (focusedCandidate !== undefined) {\n                this._trace('using new name from renameSuggestion');\n                newName = focusedCandidate;\n                source = { k: 'renameSuggestion' };\n            }\n            else {\n                this._trace('using new name from inputField');\n                newName = this._inputWithButton.input.value;\n                source = this._isEditingRenameCandidate ? { k: 'userEditedRenameSuggestion' } : { k: 'inputField' };\n            }\n            if (newName === currentName || newName.trim().length === 0 /* is just whitespace */) {\n                this.cancelInput(true, '_currentAcceptInput (because newName === value || newName.trim().length === 0)');\n                return;\n            }\n            this._currentAcceptInput = undefined;\n            this._currentCancelInput = undefined;\n            this._renameCandidateListView.clearCandidates();\n            // fixme session cleanup\n            inputResult.complete({\n                newName,\n                wantsPreview: supportPreview && wantsPreview,\n                stats: {\n                    source,\n                    nRenameSuggestions,\n                    timeBeforeFirstInputFieldEdit: this._timeBeforeFirstInputFieldEdit,\n                    nRenameSuggestionsInvocations: this._nRenameSuggestionsInvocations,\n                    hadAutomaticRenameSuggestionsInvocation: this._hadAutomaticRenameSuggestionsInvocation,\n                }\n            });\n        };\n        disposeOnDone.add(cts.token.onCancellationRequested(() => this.cancelInput(true, 'cts.token.onCancellationRequested')));\n        if (!_sticky) {\n            disposeOnDone.add(this._editor.onDidBlurEditorWidget(() => { var _a; return this.cancelInput(!((_a = this._domNode) === null || _a === void 0 ? void 0 : _a.ownerDocument.hasFocus()), 'editor.onDidBlurEditorWidget'); }));\n        }\n        this._show();\n        return inputResult.p;\n    }\n    _requestRenameCandidates(currentName, isManuallyTriggered) {\n        if (this._requestRenameCandidatesOnce === undefined) {\n            return;\n        }\n        if (this._renameCandidateProvidersCts !== undefined) {\n            this._renameCandidateProvidersCts.dispose(true);\n        }\n        assertType(this._renameCts);\n        if (this._inputWithButton.buttonState !== 'stop') {\n            this._renameCandidateProvidersCts = new CancellationTokenSource();\n            const triggerKind = isManuallyTriggered ? NewSymbolNameTriggerKind.Invoke : NewSymbolNameTriggerKind.Automatic;\n            const candidates = this._requestRenameCandidatesOnce(triggerKind, this._renameCandidateProvidersCts.token);\n            if (candidates.length === 0) {\n                this._inputWithButton.setSparkleButton();\n                return;\n            }\n            if (!isManuallyTriggered) {\n                this._hadAutomaticRenameSuggestionsInvocation = true;\n            }\n            this._nRenameSuggestionsInvocations += 1;\n            this._inputWithButton.setStopButton();\n            this._updateRenameCandidates(candidates, currentName, this._renameCts.token);\n        }\n    }\n    /**\n     * This allows selecting only part of the symbol name in the input field based on the selection in the editor\n     */\n    _getSelection(where, currentName) {\n        assertType(this._editor.hasModel());\n        const selection = this._editor.getSelection();\n        let start = 0;\n        let end = currentName.length;\n        if (!Range.isEmpty(selection) && !Range.spansMultipleLines(selection) && Range.containsRange(where, selection)) {\n            start = Math.max(0, selection.startColumn - where.startColumn);\n            end = Math.min(where.endColumn, selection.endColumn) - where.startColumn;\n        }\n        return { start, end };\n    }\n    _show() {\n        this._trace('invoking _show');\n        this._editor.revealLineInCenterIfOutsideViewport(this._position.lineNumber, 0 /* ScrollType.Smooth */);\n        this._visible = true;\n        this._visibleContextKey.set(true);\n        this._editor.layoutContentWidget(this);\n        // TODO@ulugbekna: could this be simply run in `afterRender`?\n        setTimeout(() => {\n            this._inputWithButton.input.focus();\n            this._inputWithButton.input.setSelectionRange(parseInt(this._inputWithButton.input.getAttribute('selectionStart')), parseInt(this._inputWithButton.input.getAttribute('selectionEnd')));\n        }, 100);\n    }\n    async _updateRenameCandidates(candidates, currentName, token) {\n        const trace = (...args) => this._trace('_updateRenameCandidates', ...args);\n        trace('start');\n        const namesListResults = await raceCancellation(Promise.allSettled(candidates), token);\n        this._inputWithButton.setSparkleButton();\n        if (namesListResults === undefined) {\n            trace('returning early - received updateRenameCandidates results - undefined');\n            return;\n        }\n        const newNames = namesListResults.flatMap(namesListResult => namesListResult.status === 'fulfilled' && isDefined(namesListResult.value)\n            ? namesListResult.value\n            : []);\n        trace(`received updateRenameCandidates results - total (unfiltered) ${newNames.length} candidates.`);\n        // deduplicate and filter out the current value\n        const distinctNames = arrays.distinct(newNames, v => v.newSymbolName);\n        trace(`distinct candidates - ${distinctNames.length} candidates.`);\n        const validDistinctNames = distinctNames.filter(({ newSymbolName }) => newSymbolName.trim().length > 0 && newSymbolName !== this._inputWithButton.input.value && newSymbolName !== currentName && !this._candidates.has(newSymbolName));\n        trace(`valid distinct candidates - ${newNames.length} candidates.`);\n        validDistinctNames.forEach(n => this._candidates.add(n.newSymbolName));\n        if (validDistinctNames.length < 1) {\n            trace('returning early - no valid distinct candidates');\n            return;\n        }\n        // show the candidates\n        trace('setting candidates');\n        this._renameCandidateListView.setCandidates(validDistinctNames);\n        // ask editor to re-layout given that the widget is now of a different size after rendering rename candidates\n        trace('asking editor to re-layout');\n        this._editor.layoutContentWidget(this);\n    }\n    _hide() {\n        this._trace('invoked _hide');\n        this._visible = false;\n        this._visibleContextKey.reset();\n        this._editor.layoutContentWidget(this);\n    }\n    _getTopForPosition() {\n        const visibleRanges = this._editor.getVisibleRanges();\n        let firstLineInViewport;\n        if (visibleRanges.length > 0) {\n            firstLineInViewport = visibleRanges[0].startLineNumber;\n        }\n        else {\n            this._logService.warn('RenameWidget#_getTopForPosition: this should not happen - visibleRanges is empty');\n            firstLineInViewport = Math.max(1, this._position.lineNumber - 5); // @ulugbekna: fallback to current line minus 5\n        }\n        return this._editor.getTopForLineNumber(this._position.lineNumber) - this._editor.getTopForLineNumber(firstLineInViewport);\n    }\n    _trace(...args) {\n        this._logService.trace('RenameWidget', ...args);\n    }\n};\nRenameWidget = __decorate([\n    __param(2, IThemeService),\n    __param(3, IKeybindingService),\n    __param(4, IContextKeyService),\n    __param(5, ILogService)\n], RenameWidget);\nexport { RenameWidget };\nclass RenameCandidateListView {\n    // FIXME@ulugbekna: rewrite using event emitters\n    constructor(parent, opts) {\n        this._disposables = new DisposableStore();\n        this._availableHeight = 0;\n        this._minimumWidth = 0;\n        this._lineHeight = opts.fontInfo.lineHeight;\n        this._typicalHalfwidthCharacterWidth = opts.fontInfo.typicalHalfwidthCharacterWidth;\n        this._listContainer = document.createElement('div');\n        this._listContainer.className = 'rename-box rename-candidate-list-container';\n        parent.appendChild(this._listContainer);\n        this._listWidget = RenameCandidateListView._createListWidget(this._listContainer, this._candidateViewHeight, opts.fontInfo);\n        this._listWidget.onDidChangeFocus(e => {\n            if (e.elements.length === 1) {\n                opts.onFocusChange(e.elements[0].newSymbolName);\n            }\n        }, this._disposables);\n        this._listWidget.onDidChangeSelection(e => {\n            if (e.elements.length === 1) {\n                opts.onSelectionChange();\n            }\n        }, this._disposables);\n        this._disposables.add(this._listWidget.onDidBlur(e => {\n            this._listWidget.setFocus([]);\n        }));\n        this._listWidget.style(getListStyles({\n            listInactiveFocusForeground: quickInputListFocusForeground,\n            listInactiveFocusBackground: quickInputListFocusBackground,\n        }));\n    }\n    dispose() {\n        this._listWidget.dispose();\n        this._disposables.dispose();\n    }\n    // height - max height allowed by parent element\n    layout({ height, width }) {\n        this._availableHeight = height;\n        this._minimumWidth = width;\n    }\n    setCandidates(candidates) {\n        // insert candidates into list widget\n        this._listWidget.splice(0, 0, candidates);\n        // adjust list widget layout\n        const height = this._pickListHeight(this._listWidget.length);\n        const width = this._pickListWidth(candidates);\n        this._listWidget.layout(height, width);\n        // adjust list container layout\n        this._listContainer.style.height = `${height}px`;\n        this._listContainer.style.width = `${width}px`;\n        aria.status(localize('renameSuggestionsReceivedAria', \"Received {0} rename suggestions\", candidates.length));\n    }\n    clearCandidates() {\n        this._listContainer.style.height = '0px';\n        this._listContainer.style.width = '0px';\n        this._listWidget.splice(0, this._listWidget.length, []);\n    }\n    get nCandidates() {\n        return this._listWidget.length;\n    }\n    get focusedCandidate() {\n        if (this._listWidget.length === 0) {\n            return;\n        }\n        const selectedElement = this._listWidget.getSelectedElements()[0];\n        if (selectedElement !== undefined) {\n            return selectedElement.newSymbolName;\n        }\n        const focusedElement = this._listWidget.getFocusedElements()[0];\n        if (focusedElement !== undefined) {\n            return focusedElement.newSymbolName;\n        }\n        return;\n    }\n    focusNext() {\n        if (this._listWidget.length === 0) {\n            return false;\n        }\n        const focusedIxs = this._listWidget.getFocus();\n        if (focusedIxs.length === 0) {\n            this._listWidget.focusFirst();\n            this._listWidget.reveal(0);\n            return true;\n        }\n        else {\n            if (focusedIxs[0] === this._listWidget.length - 1) {\n                this._listWidget.setFocus([]);\n                this._listWidget.reveal(0); // @ulugbekna: without this, it seems like focused element is obstructed\n                return false;\n            }\n            else {\n                this._listWidget.focusNext();\n                const focused = this._listWidget.getFocus()[0];\n                this._listWidget.reveal(focused);\n                return true;\n            }\n        }\n    }\n    /**\n     * @returns true if focus is moved to previous element\n     */\n    focusPrevious() {\n        if (this._listWidget.length === 0) {\n            return false;\n        }\n        const focusedIxs = this._listWidget.getFocus();\n        if (focusedIxs.length === 0) {\n            this._listWidget.focusLast();\n            const focused = this._listWidget.getFocus()[0];\n            this._listWidget.reveal(focused);\n            return true;\n        }\n        else {\n            if (focusedIxs[0] === 0) {\n                this._listWidget.setFocus([]);\n                return false;\n            }\n            else {\n                this._listWidget.focusPrevious();\n                const focused = this._listWidget.getFocus()[0];\n                this._listWidget.reveal(focused);\n                return true;\n            }\n        }\n    }\n    clearFocus() {\n        this._listWidget.setFocus([]);\n    }\n    get _candidateViewHeight() {\n        const { totalHeight } = RenameCandidateView.getLayoutInfo({ lineHeight: this._lineHeight });\n        return totalHeight;\n    }\n    _pickListHeight(nCandidates) {\n        const heightToFitAllCandidates = this._candidateViewHeight * nCandidates;\n        const MAX_N_CANDIDATES = 7; // @ulugbekna: max # of candidates we want to show at once\n        const height = Math.min(heightToFitAllCandidates, this._availableHeight, this._candidateViewHeight * MAX_N_CANDIDATES);\n        return height;\n    }\n    _pickListWidth(candidates) {\n        const longestCandidateWidth = Math.ceil(Math.max(...candidates.map(c => c.newSymbolName.length)) * this._typicalHalfwidthCharacterWidth);\n        const width = Math.max(this._minimumWidth, 4 /* padding */ + 16 /* sparkle icon */ + 5 /* margin-left */ + longestCandidateWidth + 10 /* (possibly visible) scrollbar width */ // TODO@ulugbekna: approximate calc - clean this up\n        );\n        return width;\n    }\n    static _createListWidget(container, candidateViewHeight, fontInfo) {\n        const virtualDelegate = new class {\n            getTemplateId(element) {\n                return 'candidate';\n            }\n            getHeight(element) {\n                return candidateViewHeight;\n            }\n        };\n        const renderer = new class {\n            constructor() {\n                this.templateId = 'candidate';\n            }\n            renderTemplate(container) {\n                return new RenameCandidateView(container, fontInfo);\n            }\n            renderElement(candidate, index, templateData) {\n                templateData.populate(candidate);\n            }\n            disposeTemplate(templateData) {\n                templateData.dispose();\n            }\n        };\n        return new List('NewSymbolNameCandidates', container, virtualDelegate, [renderer], {\n            keyboardSupport: false, // @ulugbekna: because we handle keyboard events through proper commands & keybinding service, see `rename.ts`\n            mouseSupport: true,\n            multipleSelectionSupport: false,\n        });\n    }\n}\nclass InputWithButton {\n    constructor() {\n        this._onDidInputChange = new Emitter();\n        this.onDidInputChange = this._onDidInputChange.event;\n        this._disposables = new DisposableStore();\n    }\n    get domNode() {\n        if (!this._domNode) {\n            this._domNode = document.createElement('div');\n            this._domNode.className = 'rename-input-with-button';\n            this._domNode.style.display = 'flex';\n            this._domNode.style.flexDirection = 'row';\n            this._domNode.style.alignItems = 'center';\n            this._inputNode = document.createElement('input');\n            this._inputNode.className = 'rename-input';\n            this._inputNode.type = 'text';\n            this._inputNode.style.border = 'none';\n            this._inputNode.setAttribute('aria-label', localize('renameAriaLabel', \"Rename input. Type new name and press Enter to commit.\"));\n            this._domNode.appendChild(this._inputNode);\n            this._buttonNode = document.createElement('div');\n            this._buttonNode.className = 'rename-suggestions-button';\n            this._buttonNode.setAttribute('tabindex', '0');\n            this._buttonGenHoverText = nls.localize('generateRenameSuggestionsButton', \"Generate new name suggestions\");\n            this._buttonCancelHoverText = nls.localize('cancelRenameSuggestionsButton', \"Cancel\");\n            this._buttonHover = getBaseLayerHoverDelegate().setupUpdatableHover(getDefaultHoverDelegate('element'), this._buttonNode, this._buttonGenHoverText);\n            this._disposables.add(this._buttonHover);\n            this._domNode.appendChild(this._buttonNode);\n            // notify if selection changes to cancel request to rename-suggestion providers\n            this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.INPUT, () => this._onDidInputChange.fire()));\n            this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.KEY_DOWN, (e) => {\n                const keyEvent = new StandardKeyboardEvent(e);\n                if (keyEvent.keyCode === 15 /* KeyCode.LeftArrow */ || keyEvent.keyCode === 17 /* KeyCode.RightArrow */) {\n                    this._onDidInputChange.fire();\n                }\n            }));\n            this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.CLICK, () => this._onDidInputChange.fire()));\n            // focus \"container\" border instead of input box\n            this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.FOCUS, () => {\n                this.domNode.style.outlineWidth = '1px';\n                this.domNode.style.outlineStyle = 'solid';\n                this.domNode.style.outlineOffset = '-1px';\n                this.domNode.style.outlineColor = 'var(--vscode-focusBorder)';\n            }));\n            this._disposables.add(dom.addDisposableListener(this.input, dom.EventType.BLUR, () => {\n                this.domNode.style.outline = 'none';\n            }));\n        }\n        return this._domNode;\n    }\n    get input() {\n        assertType(this._inputNode);\n        return this._inputNode;\n    }\n    get button() {\n        assertType(this._buttonNode);\n        return this._buttonNode;\n    }\n    get buttonState() {\n        return this._buttonState;\n    }\n    setSparkleButton() {\n        var _a, _b;\n        this._buttonState = 'sparkle';\n        (_a = this._sparkleIcon) !== null && _a !== void 0 ? _a : (this._sparkleIcon = renderIcon(Codicon.sparkle));\n        dom.clearNode(this.button);\n        this.button.appendChild(this._sparkleIcon);\n        this.button.setAttribute('aria-label', 'Generating new name suggestions');\n        (_b = this._buttonHover) === null || _b === void 0 ? void 0 : _b.update(this._buttonGenHoverText);\n        this.input.focus();\n    }\n    setStopButton() {\n        var _a, _b;\n        this._buttonState = 'stop';\n        (_a = this._stopIcon) !== null && _a !== void 0 ? _a : (this._stopIcon = renderIcon(Codicon.primitiveSquare));\n        dom.clearNode(this.button);\n        this.button.appendChild(this._stopIcon);\n        this.button.setAttribute('aria-label', 'Cancel generating new name suggestions');\n        (_b = this._buttonHover) === null || _b === void 0 ? void 0 : _b.update(this._buttonCancelHoverText);\n        this.input.focus();\n    }\n    dispose() {\n        this._disposables.dispose();\n    }\n}\nclass RenameCandidateView {\n    constructor(parent, fontInfo) {\n        this._domNode = document.createElement('div');\n        this._domNode.className = 'rename-box rename-candidate';\n        this._domNode.style.display = `flex`;\n        this._domNode.style.columnGap = `5px`;\n        this._domNode.style.alignItems = `center`;\n        this._domNode.style.height = `${fontInfo.lineHeight}px`;\n        this._domNode.style.padding = `${RenameCandidateView._PADDING}px`;\n        // @ulugbekna: needed to keep space when the `icon.style.display` is set to `none`\n        const iconContainer = document.createElement('div');\n        iconContainer.style.display = `flex`;\n        iconContainer.style.alignItems = `center`;\n        iconContainer.style.width = iconContainer.style.height = `${fontInfo.lineHeight * 0.8}px`;\n        this._domNode.appendChild(iconContainer);\n        this._icon = renderIcon(Codicon.sparkle);\n        this._icon.style.display = `none`;\n        iconContainer.appendChild(this._icon);\n        this._label = document.createElement('div');\n        domFontInfo.applyFontInfo(this._label, fontInfo);\n        this._domNode.appendChild(this._label);\n        parent.appendChild(this._domNode);\n    }\n    populate(value) {\n        this._updateIcon(value);\n        this._updateLabel(value);\n    }\n    _updateIcon(value) {\n        var _a;\n        const isAIGenerated = !!((_a = value.tags) === null || _a === void 0 ? void 0 : _a.includes(NewSymbolNameTag.AIGenerated));\n        this._icon.style.display = isAIGenerated ? 'inherit' : 'none';\n    }\n    _updateLabel(value) {\n        this._label.innerText = value.newSymbolName;\n    }\n    static getLayoutInfo({ lineHeight }) {\n        const totalHeight = lineHeight + RenameCandidateView._PADDING * 2 /* top & bottom padding */;\n        return { totalHeight };\n    }\n    dispose() {\n    }\n}\nRenameCandidateView._PADDING = 2;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}