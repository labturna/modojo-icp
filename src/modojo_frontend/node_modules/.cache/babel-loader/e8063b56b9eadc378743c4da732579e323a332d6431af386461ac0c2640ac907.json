{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nimport './hover.css';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { EDITOR_FONT_DEFAULTS } from '../../../common/config/editorOptions.js';\nimport { HoverAction, HoverWidget as BaseHoverWidget, getHoverAccessibleViewHint } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { Widget } from '../../../../base/browser/ui/widget.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { MarkdownRenderer, openLinkFromMarkdown } from '../../widget/markdownRenderer/browser/markdownRenderer.js';\nimport { isMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { localize } from '../../../../nls.js';\nimport { isMacintosh } from '../../../../base/common/platform.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { status } from '../../../../base/browser/ui/aria/aria.js';\nconst $ = dom.$;\nlet HoverWidget = class HoverWidget extends Widget {\n  get _targetWindow() {\n    return dom.getWindow(this._target.targetElements[0]);\n  }\n  get _targetDocumentElement() {\n    return dom.getWindow(this._target.targetElements[0]).document.documentElement;\n  }\n  get isDisposed() {\n    return this._isDisposed;\n  }\n  get isMouseIn() {\n    return this._lockMouseTracker.isMouseIn;\n  }\n  get domNode() {\n    return this._hover.containerDomNode;\n  }\n  get onDispose() {\n    return this._onDispose.event;\n  }\n  get onRequestLayout() {\n    return this._onRequestLayout.event;\n  }\n  get anchor() {\n    return this._hoverPosition === 2 /* HoverPosition.BELOW */ ? 0 /* AnchorPosition.BELOW */ : 1 /* AnchorPosition.ABOVE */;\n  }\n  get x() {\n    return this._x;\n  }\n  get y() {\n    return this._y;\n  }\n  /**\n   * Whether the hover is \"locked\" by holding the alt/option key. When locked, the hover will not\n   * hide and can be hovered regardless of whether the `hideOnHover` hover option is set.\n   */\n  get isLocked() {\n    return this._isLocked;\n  }\n  set isLocked(value) {\n    if (this._isLocked === value) {\n      return;\n    }\n    this._isLocked = value;\n    this._hoverContainer.classList.toggle('locked', this._isLocked);\n  }\n  constructor(options, _keybindingService, _configurationService, _openerService, _instantiationService, _accessibilityService) {\n    var _a, _b, _c, _d, _e, _f, _g, _h;\n    super();\n    this._keybindingService = _keybindingService;\n    this._configurationService = _configurationService;\n    this._openerService = _openerService;\n    this._instantiationService = _instantiationService;\n    this._accessibilityService = _accessibilityService;\n    this._messageListeners = new DisposableStore();\n    this._isDisposed = false;\n    this._forcePosition = false;\n    this._x = 0;\n    this._y = 0;\n    this._isLocked = false;\n    this._enableFocusTraps = false;\n    this._addedFocusTrap = false;\n    this._onDispose = this._register(new Emitter());\n    this._onRequestLayout = this._register(new Emitter());\n    this._linkHandler = options.linkHandler || (url => {\n      return openLinkFromMarkdown(this._openerService, url, isMarkdownString(options.content) ? options.content.isTrusted : undefined);\n    });\n    this._target = 'targetElements' in options.target ? options.target : new ElementHoverTarget(options.target);\n    this._hoverPointer = ((_a = options.appearance) === null || _a === void 0 ? void 0 : _a.showPointer) ? $('div.workbench-hover-pointer') : undefined;\n    this._hover = this._register(new BaseHoverWidget());\n    this._hover.containerDomNode.classList.add('workbench-hover', 'fadeIn');\n    if ((_b = options.appearance) === null || _b === void 0 ? void 0 : _b.compact) {\n      this._hover.containerDomNode.classList.add('workbench-hover', 'compact');\n    }\n    if ((_c = options.appearance) === null || _c === void 0 ? void 0 : _c.skipFadeInAnimation) {\n      this._hover.containerDomNode.classList.add('skip-fade-in');\n    }\n    if (options.additionalClasses) {\n      this._hover.containerDomNode.classList.add(...options.additionalClasses);\n    }\n    if ((_d = options.position) === null || _d === void 0 ? void 0 : _d.forcePosition) {\n      this._forcePosition = true;\n    }\n    if (options.trapFocus) {\n      this._enableFocusTraps = true;\n    }\n    this._hoverPosition = (_f = (_e = options.position) === null || _e === void 0 ? void 0 : _e.hoverPosition) !== null && _f !== void 0 ? _f : 3 /* HoverPosition.ABOVE */;\n    // Don't allow mousedown out of the widget, otherwise preventDefault will call and text will\n    // not be selected.\n    this.onmousedown(this._hover.containerDomNode, e => e.stopPropagation());\n    // Hide hover on escape\n    this.onkeydown(this._hover.containerDomNode, e => {\n      if (e.equals(9 /* KeyCode.Escape */)) {\n        this.dispose();\n      }\n    });\n    // Hide when the window loses focus\n    this._register(dom.addDisposableListener(this._targetWindow, 'blur', () => this.dispose()));\n    const rowElement = $('div.hover-row.markdown-hover');\n    const contentsElement = $('div.hover-contents');\n    if (typeof options.content === 'string') {\n      contentsElement.textContent = options.content;\n      contentsElement.style.whiteSpace = 'pre-wrap';\n    } else if (dom.isHTMLElement(options.content)) {\n      contentsElement.appendChild(options.content);\n      contentsElement.classList.add('html-hover-contents');\n    } else {\n      const markdown = options.content;\n      const mdRenderer = this._instantiationService.createInstance(MarkdownRenderer, {\n        codeBlockFontFamily: this._configurationService.getValue('editor').fontFamily || EDITOR_FONT_DEFAULTS.fontFamily\n      });\n      const {\n        element\n      } = mdRenderer.render(markdown, {\n        actionHandler: {\n          callback: content => this._linkHandler(content),\n          disposables: this._messageListeners\n        },\n        asyncRenderCallback: () => {\n          contentsElement.classList.add('code-hover-contents');\n          this.layout();\n          // This changes the dimensions of the hover so trigger a layout\n          this._onRequestLayout.fire();\n        }\n      });\n      contentsElement.appendChild(element);\n    }\n    rowElement.appendChild(contentsElement);\n    this._hover.contentsDomNode.appendChild(rowElement);\n    if (options.actions && options.actions.length > 0) {\n      const statusBarElement = $('div.hover-row.status-bar');\n      const actionsElement = $('div.actions');\n      options.actions.forEach(action => {\n        const keybinding = this._keybindingService.lookupKeybinding(action.commandId);\n        const keybindingLabel = keybinding ? keybinding.getLabel() : null;\n        HoverAction.render(actionsElement, {\n          label: action.label,\n          commandId: action.commandId,\n          run: e => {\n            action.run(e);\n            this.dispose();\n          },\n          iconClass: action.iconClass\n        }, keybindingLabel);\n      });\n      statusBarElement.appendChild(actionsElement);\n      this._hover.containerDomNode.appendChild(statusBarElement);\n    }\n    this._hoverContainer = $('div.workbench-hover-container');\n    if (this._hoverPointer) {\n      this._hoverContainer.appendChild(this._hoverPointer);\n    }\n    this._hoverContainer.appendChild(this._hover.containerDomNode);\n    // Determine whether to hide on hover\n    let hideOnHover;\n    if (options.actions && options.actions.length > 0) {\n      // If there are actions, require hover so they can be accessed\n      hideOnHover = false;\n    } else {\n      if (((_g = options.persistence) === null || _g === void 0 ? void 0 : _g.hideOnHover) === undefined) {\n        // When unset, will default to true when it's a string or when it's markdown that\n        // appears to have a link using a naive check for '](' and '</a>'\n        hideOnHover = typeof options.content === 'string' || isMarkdownString(options.content) && !options.content.value.includes('](') && !options.content.value.includes('</a>');\n      } else {\n        // It's set explicitly\n        hideOnHover = options.persistence.hideOnHover;\n      }\n    }\n    // Show the hover hint if needed\n    if (hideOnHover && ((_h = options.appearance) === null || _h === void 0 ? void 0 : _h.showHoverHint)) {\n      const statusBarElement = $('div.hover-row.status-bar');\n      const infoElement = $('div.info');\n      infoElement.textContent = localize('hoverhint', 'Hold {0} key to mouse over', isMacintosh ? 'Option' : 'Alt');\n      statusBarElement.appendChild(infoElement);\n      this._hover.containerDomNode.appendChild(statusBarElement);\n    }\n    const mouseTrackerTargets = [...this._target.targetElements];\n    if (!hideOnHover) {\n      mouseTrackerTargets.push(this._hoverContainer);\n    }\n    const mouseTracker = this._register(new CompositeMouseTracker(mouseTrackerTargets));\n    this._register(mouseTracker.onMouseOut(() => {\n      if (!this._isLocked) {\n        this.dispose();\n      }\n    }));\n    // Setup another mouse tracker when hideOnHover is set in order to track the hover as well\n    // when it is locked. This ensures the hover will hide on mouseout after alt has been\n    // released to unlock the element.\n    if (hideOnHover) {\n      const mouseTracker2Targets = [...this._target.targetElements, this._hoverContainer];\n      this._lockMouseTracker = this._register(new CompositeMouseTracker(mouseTracker2Targets));\n      this._register(this._lockMouseTracker.onMouseOut(() => {\n        if (!this._isLocked) {\n          this.dispose();\n        }\n      }));\n    } else {\n      this._lockMouseTracker = mouseTracker;\n    }\n  }\n  addFocusTrap() {\n    if (!this._enableFocusTraps || this._addedFocusTrap) {\n      return;\n    }\n    this._addedFocusTrap = true;\n    // Add a hover tab loop if the hover has at least one element with a valid tabIndex\n    const firstContainerFocusElement = this._hover.containerDomNode;\n    const lastContainerFocusElement = this.findLastFocusableChild(this._hover.containerDomNode);\n    if (lastContainerFocusElement) {\n      const beforeContainerFocusElement = dom.prepend(this._hoverContainer, $('div'));\n      const afterContainerFocusElement = dom.append(this._hoverContainer, $('div'));\n      beforeContainerFocusElement.tabIndex = 0;\n      afterContainerFocusElement.tabIndex = 0;\n      this._register(dom.addDisposableListener(afterContainerFocusElement, 'focus', e => {\n        firstContainerFocusElement.focus();\n        e.preventDefault();\n      }));\n      this._register(dom.addDisposableListener(beforeContainerFocusElement, 'focus', e => {\n        lastContainerFocusElement.focus();\n        e.preventDefault();\n      }));\n    }\n  }\n  findLastFocusableChild(root) {\n    if (root.hasChildNodes()) {\n      for (let i = 0; i < root.childNodes.length; i++) {\n        const node = root.childNodes.item(root.childNodes.length - i - 1);\n        if (node.nodeType === node.ELEMENT_NODE) {\n          const parsedNode = node;\n          if (typeof parsedNode.tabIndex === 'number' && parsedNode.tabIndex >= 0) {\n            return parsedNode;\n          }\n        }\n        const recursivelyFoundElement = this.findLastFocusableChild(node);\n        if (recursivelyFoundElement) {\n          return recursivelyFoundElement;\n        }\n      }\n    }\n    return undefined;\n  }\n  render(container) {\n    var _a;\n    container.appendChild(this._hoverContainer);\n    const hoverFocused = this._hoverContainer.contains(this._hoverContainer.ownerDocument.activeElement);\n    const accessibleViewHint = hoverFocused && getHoverAccessibleViewHint(this._configurationService.getValue('accessibility.verbosity.hover') === true && this._accessibilityService.isScreenReaderOptimized(), (_a = this._keybindingService.lookupKeybinding('editor.action.accessibleView')) === null || _a === void 0 ? void 0 : _a.getAriaLabel());\n    if (accessibleViewHint) {\n      status(accessibleViewHint);\n    }\n    this.layout();\n    this.addFocusTrap();\n  }\n  layout() {\n    this._hover.containerDomNode.classList.remove('right-aligned');\n    this._hover.contentsDomNode.style.maxHeight = '';\n    const getZoomAccountedBoundingClientRect = e => {\n      const zoom = dom.getDomNodeZoomLevel(e);\n      const boundingRect = e.getBoundingClientRect();\n      return {\n        top: boundingRect.top * zoom,\n        bottom: boundingRect.bottom * zoom,\n        right: boundingRect.right * zoom,\n        left: boundingRect.left * zoom\n      };\n    };\n    const targetBounds = this._target.targetElements.map(e => getZoomAccountedBoundingClientRect(e));\n    const {\n      top,\n      right,\n      bottom,\n      left\n    } = targetBounds[0];\n    const width = right - left;\n    const height = bottom - top;\n    const targetRect = {\n      top,\n      right,\n      bottom,\n      left,\n      width,\n      height,\n      center: {\n        x: left + width / 2,\n        y: top + height / 2\n      }\n    };\n    // These calls adjust the position depending on spacing.\n    this.adjustHorizontalHoverPosition(targetRect);\n    this.adjustVerticalHoverPosition(targetRect);\n    // This call limits the maximum height of the hover.\n    this.adjustHoverMaxHeight(targetRect);\n    // Offset the hover position if there is a pointer so it aligns with the target element\n    this._hoverContainer.style.padding = '';\n    this._hoverContainer.style.margin = '';\n    if (this._hoverPointer) {\n      switch (this._hoverPosition) {\n        case 1 /* HoverPosition.RIGHT */:\n          targetRect.left += 3 /* Constants.PointerSize */;\n          targetRect.right += 3 /* Constants.PointerSize */;\n          this._hoverContainer.style.paddingLeft = `${3 /* Constants.PointerSize */}px`;\n          this._hoverContainer.style.marginLeft = `${-3 /* Constants.PointerSize */}px`;\n          break;\n        case 0 /* HoverPosition.LEFT */:\n          targetRect.left -= 3 /* Constants.PointerSize */;\n          targetRect.right -= 3 /* Constants.PointerSize */;\n          this._hoverContainer.style.paddingRight = `${3 /* Constants.PointerSize */}px`;\n          this._hoverContainer.style.marginRight = `${-3 /* Constants.PointerSize */}px`;\n          break;\n        case 2 /* HoverPosition.BELOW */:\n          targetRect.top += 3 /* Constants.PointerSize */;\n          targetRect.bottom += 3 /* Constants.PointerSize */;\n          this._hoverContainer.style.paddingTop = `${3 /* Constants.PointerSize */}px`;\n          this._hoverContainer.style.marginTop = `${-3 /* Constants.PointerSize */}px`;\n          break;\n        case 3 /* HoverPosition.ABOVE */:\n          targetRect.top -= 3 /* Constants.PointerSize */;\n          targetRect.bottom -= 3 /* Constants.PointerSize */;\n          this._hoverContainer.style.paddingBottom = `${3 /* Constants.PointerSize */}px`;\n          this._hoverContainer.style.marginBottom = `${-3 /* Constants.PointerSize */}px`;\n          break;\n      }\n      targetRect.center.x = targetRect.left + width / 2;\n      targetRect.center.y = targetRect.top + height / 2;\n    }\n    this.computeXCordinate(targetRect);\n    this.computeYCordinate(targetRect);\n    if (this._hoverPointer) {\n      // reset\n      this._hoverPointer.classList.remove('top');\n      this._hoverPointer.classList.remove('left');\n      this._hoverPointer.classList.remove('right');\n      this._hoverPointer.classList.remove('bottom');\n      this.setHoverPointerPosition(targetRect);\n    }\n    this._hover.onContentsChanged();\n  }\n  computeXCordinate(target) {\n    const hoverWidth = this._hover.containerDomNode.clientWidth + 2 /* Constants.HoverBorderWidth */;\n    if (this._target.x !== undefined) {\n      this._x = this._target.x;\n    } else if (this._hoverPosition === 1 /* HoverPosition.RIGHT */) {\n      this._x = target.right;\n    } else if (this._hoverPosition === 0 /* HoverPosition.LEFT */) {\n      this._x = target.left - hoverWidth;\n    } else {\n      if (this._hoverPointer) {\n        this._x = target.center.x - this._hover.containerDomNode.clientWidth / 2;\n      } else {\n        this._x = target.left;\n      }\n      // Hover is going beyond window towards right end\n      if (this._x + hoverWidth >= this._targetDocumentElement.clientWidth) {\n        this._hover.containerDomNode.classList.add('right-aligned');\n        this._x = Math.max(this._targetDocumentElement.clientWidth - hoverWidth - 2 /* Constants.HoverWindowEdgeMargin */, this._targetDocumentElement.clientLeft);\n      }\n    }\n    // Hover is going beyond window towards left end\n    if (this._x < this._targetDocumentElement.clientLeft) {\n      this._x = target.left + 2 /* Constants.HoverWindowEdgeMargin */;\n    }\n  }\n  computeYCordinate(target) {\n    if (this._target.y !== undefined) {\n      this._y = this._target.y;\n    } else if (this._hoverPosition === 3 /* HoverPosition.ABOVE */) {\n      this._y = target.top;\n    } else if (this._hoverPosition === 2 /* HoverPosition.BELOW */) {\n      this._y = target.bottom - 2;\n    } else {\n      if (this._hoverPointer) {\n        this._y = target.center.y + this._hover.containerDomNode.clientHeight / 2;\n      } else {\n        this._y = target.bottom;\n      }\n    }\n    // Hover on bottom is going beyond window\n    if (this._y > this._targetWindow.innerHeight) {\n      this._y = target.bottom;\n    }\n  }\n  adjustHorizontalHoverPosition(target) {\n    // Do not adjust horizontal hover position if x cordiante is provided\n    if (this._target.x !== undefined) {\n      return;\n    }\n    const hoverPointerOffset = this._hoverPointer ? 3 /* Constants.PointerSize */ : 0;\n    // When force position is enabled, restrict max width\n    if (this._forcePosition) {\n      const padding = hoverPointerOffset + 2 /* Constants.HoverBorderWidth */;\n      if (this._hoverPosition === 1 /* HoverPosition.RIGHT */) {\n        this._hover.containerDomNode.style.maxWidth = `${this._targetDocumentElement.clientWidth - target.right - padding}px`;\n      } else if (this._hoverPosition === 0 /* HoverPosition.LEFT */) {\n        this._hover.containerDomNode.style.maxWidth = `${target.left - padding}px`;\n      }\n      return;\n    }\n    // Position hover on right to target\n    if (this._hoverPosition === 1 /* HoverPosition.RIGHT */) {\n      const roomOnRight = this._targetDocumentElement.clientWidth - target.right;\n      // Hover on the right is going beyond window.\n      if (roomOnRight < this._hover.containerDomNode.clientWidth + hoverPointerOffset) {\n        const roomOnLeft = target.left;\n        // There's enough room on the left, flip the hover position\n        if (roomOnLeft >= this._hover.containerDomNode.clientWidth + hoverPointerOffset) {\n          this._hoverPosition = 0 /* HoverPosition.LEFT */;\n        }\n        // Hover on the left would go beyond window too\n        else {\n          this._hoverPosition = 2 /* HoverPosition.BELOW */;\n        }\n      }\n    }\n    // Position hover on left to target\n    else if (this._hoverPosition === 0 /* HoverPosition.LEFT */) {\n      const roomOnLeft = target.left;\n      // Hover on the left is going beyond window.\n      if (roomOnLeft < this._hover.containerDomNode.clientWidth + hoverPointerOffset) {\n        const roomOnRight = this._targetDocumentElement.clientWidth - target.right;\n        // There's enough room on the right, flip the hover position\n        if (roomOnRight >= this._hover.containerDomNode.clientWidth + hoverPointerOffset) {\n          this._hoverPosition = 1 /* HoverPosition.RIGHT */;\n        }\n        // Hover on the right would go beyond window too\n        else {\n          this._hoverPosition = 2 /* HoverPosition.BELOW */;\n        }\n      }\n      // Hover on the left is going beyond window.\n      if (target.left - this._hover.containerDomNode.clientWidth - hoverPointerOffset <= this._targetDocumentElement.clientLeft) {\n        this._hoverPosition = 1 /* HoverPosition.RIGHT */;\n      }\n    }\n  }\n  adjustVerticalHoverPosition(target) {\n    // Do not adjust vertical hover position if the y coordinate is provided\n    // or the position is forced\n    if (this._target.y !== undefined || this._forcePosition) {\n      return;\n    }\n    const hoverPointerOffset = this._hoverPointer ? 3 /* Constants.PointerSize */ : 0;\n    // Position hover on top of the target\n    if (this._hoverPosition === 3 /* HoverPosition.ABOVE */) {\n      // Hover on top is going beyond window\n      if (target.top - this._hover.containerDomNode.clientHeight - hoverPointerOffset < 0) {\n        this._hoverPosition = 2 /* HoverPosition.BELOW */;\n      }\n    }\n    // Position hover below the target\n    else if (this._hoverPosition === 2 /* HoverPosition.BELOW */) {\n      // Hover on bottom is going beyond window\n      if (target.bottom + this._hover.containerDomNode.clientHeight + hoverPointerOffset > this._targetWindow.innerHeight) {\n        this._hoverPosition = 3 /* HoverPosition.ABOVE */;\n      }\n    }\n  }\n  adjustHoverMaxHeight(target) {\n    let maxHeight = this._targetWindow.innerHeight / 2;\n    // When force position is enabled, restrict max height\n    if (this._forcePosition) {\n      const padding = (this._hoverPointer ? 3 /* Constants.PointerSize */ : 0) + 2 /* Constants.HoverBorderWidth */;\n      if (this._hoverPosition === 3 /* HoverPosition.ABOVE */) {\n        maxHeight = Math.min(maxHeight, target.top - padding);\n      } else if (this._hoverPosition === 2 /* HoverPosition.BELOW */) {\n        maxHeight = Math.min(maxHeight, this._targetWindow.innerHeight - target.bottom - padding);\n      }\n    }\n    this._hover.containerDomNode.style.maxHeight = `${maxHeight}px`;\n    if (this._hover.contentsDomNode.clientHeight < this._hover.contentsDomNode.scrollHeight) {\n      // Add padding for a vertical scrollbar\n      const extraRightPadding = `${this._hover.scrollbar.options.verticalScrollbarSize}px`;\n      if (this._hover.contentsDomNode.style.paddingRight !== extraRightPadding) {\n        this._hover.contentsDomNode.style.paddingRight = extraRightPadding;\n      }\n    }\n  }\n  setHoverPointerPosition(target) {\n    if (!this._hoverPointer) {\n      return;\n    }\n    switch (this._hoverPosition) {\n      case 0 /* HoverPosition.LEFT */:\n      case 1 /* HoverPosition.RIGHT */:\n        {\n          this._hoverPointer.classList.add(this._hoverPosition === 0 /* HoverPosition.LEFT */ ? 'right' : 'left');\n          const hoverHeight = this._hover.containerDomNode.clientHeight;\n          // If hover is taller than target, then show the pointer at the center of target\n          if (hoverHeight > target.height) {\n            this._hoverPointer.style.top = `${target.center.y - (this._y - hoverHeight) - 3 /* Constants.PointerSize */}px`;\n          }\n          // Otherwise show the pointer at the center of hover\n          else {\n            this._hoverPointer.style.top = `${Math.round(hoverHeight / 2) - 3 /* Constants.PointerSize */}px`;\n          }\n          break;\n        }\n      case 3 /* HoverPosition.ABOVE */:\n      case 2 /* HoverPosition.BELOW */:\n        {\n          this._hoverPointer.classList.add(this._hoverPosition === 3 /* HoverPosition.ABOVE */ ? 'bottom' : 'top');\n          const hoverWidth = this._hover.containerDomNode.clientWidth;\n          // Position pointer at the center of the hover\n          let pointerLeftPosition = Math.round(hoverWidth / 2) - 3 /* Constants.PointerSize */;\n          // If pointer goes beyond target then position it at the center of the target\n          const pointerX = this._x + pointerLeftPosition;\n          if (pointerX < target.left || pointerX > target.right) {\n            pointerLeftPosition = target.center.x - this._x - 3 /* Constants.PointerSize */;\n          }\n          this._hoverPointer.style.left = `${pointerLeftPosition}px`;\n          break;\n        }\n    }\n  }\n  focus() {\n    this._hover.containerDomNode.focus();\n  }\n  dispose() {\n    if (!this._isDisposed) {\n      this._onDispose.fire();\n      this._hoverContainer.remove();\n      this._messageListeners.dispose();\n      this._target.dispose();\n      super.dispose();\n    }\n    this._isDisposed = true;\n  }\n};\nHoverWidget = __decorate([__param(1, IKeybindingService), __param(2, IConfigurationService), __param(3, IOpenerService), __param(4, IInstantiationService), __param(5, IAccessibilityService)], HoverWidget);\nexport { HoverWidget };\nclass CompositeMouseTracker extends Widget {\n  get onMouseOut() {\n    return this._onMouseOut.event;\n  }\n  get isMouseIn() {\n    return this._isMouseIn;\n  }\n  constructor(_elements) {\n    super();\n    this._elements = _elements;\n    this._isMouseIn = true;\n    this._onMouseOut = this._register(new Emitter());\n    this._elements.forEach(n => this.onmouseover(n, () => this._onTargetMouseOver(n)));\n    this._elements.forEach(n => this.onmouseleave(n, () => this._onTargetMouseLeave(n)));\n  }\n  _onTargetMouseOver(target) {\n    this._isMouseIn = true;\n    this._clearEvaluateMouseStateTimeout(target);\n  }\n  _onTargetMouseLeave(target) {\n    this._isMouseIn = false;\n    this._evaluateMouseState(target);\n  }\n  _evaluateMouseState(target) {\n    this._clearEvaluateMouseStateTimeout(target);\n    // Evaluate whether the mouse is still outside asynchronously such that other mouse targets\n    // have the opportunity to first their mouse in event.\n    this._mouseTimeout = dom.getWindow(target).setTimeout(() => this._fireIfMouseOutside(), 0);\n  }\n  _clearEvaluateMouseStateTimeout(target) {\n    if (this._mouseTimeout) {\n      dom.getWindow(target).clearTimeout(this._mouseTimeout);\n      this._mouseTimeout = undefined;\n    }\n  }\n  _fireIfMouseOutside() {\n    if (!this._isMouseIn) {\n      this._onMouseOut.fire();\n    }\n  }\n}\nclass ElementHoverTarget {\n  constructor(_element) {\n    this._element = _element;\n    this.targetElements = [this._element];\n  }\n  dispose() {}\n}","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","DisposableStore","Emitter","dom","IKeybindingService","IConfigurationService","EDITOR_FONT_DEFAULTS","HoverAction","HoverWidget","BaseHoverWidget","getHoverAccessibleViewHint","Widget","IOpenerService","IInstantiationService","MarkdownRenderer","openLinkFromMarkdown","isMarkdownString","localize","isMacintosh","IAccessibilityService","status","$","_targetWindow","getWindow","_target","targetElements","_targetDocumentElement","document","documentElement","isDisposed","_isDisposed","isMouseIn","_lockMouseTracker","domNode","_hover","containerDomNode","onDispose","_onDispose","event","onRequestLayout","_onRequestLayout","anchor","_hoverPosition","x","_x","y","_y","isLocked","_isLocked","value","_hoverContainer","classList","toggle","constructor","options","_keybindingService","_configurationService","_openerService","_instantiationService","_accessibilityService","_a","_b","_c","_d","_e","_f","_g","_h","_messageListeners","_forcePosition","_enableFocusTraps","_addedFocusTrap","_register","_linkHandler","linkHandler","url","content","isTrusted","undefined","ElementHoverTarget","_hoverPointer","appearance","showPointer","add","compact","skipFadeInAnimation","additionalClasses","position","forcePosition","trapFocus","hoverPosition","onmousedown","e","stopPropagation","onkeydown","equals","dispose","addDisposableListener","rowElement","contentsElement","textContent","style","whiteSpace","isHTMLElement","appendChild","markdown","mdRenderer","createInstance","codeBlockFontFamily","getValue","fontFamily","element","render","actionHandler","callback","disposables","asyncRenderCallback","layout","fire","contentsDomNode","actions","statusBarElement","actionsElement","forEach","action","keybinding","lookupKeybinding","commandId","keybindingLabel","getLabel","label","run","iconClass","hideOnHover","persistence","includes","showHoverHint","infoElement","mouseTrackerTargets","push","mouseTracker","CompositeMouseTracker","onMouseOut","mouseTracker2Targets","addFocusTrap","firstContainerFocusElement","lastContainerFocusElement","findLastFocusableChild","beforeContainerFocusElement","prepend","afterContainerFocusElement","append","tabIndex","focus","preventDefault","root","hasChildNodes","childNodes","node","item","nodeType","ELEMENT_NODE","parsedNode","recursivelyFoundElement","container","hoverFocused","contains","ownerDocument","activeElement","accessibleViewHint","isScreenReaderOptimized","getAriaLabel","remove","maxHeight","getZoomAccountedBoundingClientRect","zoom","getDomNodeZoomLevel","boundingRect","getBoundingClientRect","top","bottom","right","left","targetBounds","map","width","height","targetRect","center","adjustHorizontalHoverPosition","adjustVerticalHoverPosition","adjustHoverMaxHeight","padding","margin","paddingLeft","marginLeft","paddingRight","marginRight","paddingTop","marginTop","paddingBottom","marginBottom","computeXCordinate","computeYCordinate","setHoverPointerPosition","onContentsChanged","hoverWidth","clientWidth","Math","max","clientLeft","clientHeight","innerHeight","hoverPointerOffset","maxWidth","roomOnRight","roomOnLeft","min","scrollHeight","extraRightPadding","scrollbar","verticalScrollbarSize","hoverHeight","round","pointerLeftPosition","pointerX","_onMouseOut","_isMouseIn","_elements","n","onmouseover","_onTargetMouseOver","onmouseleave","_onTargetMouseLeave","_clearEvaluateMouseStateTimeout","_evaluateMouseState","_mouseTimeout","setTimeout","_fireIfMouseOutside","clearTimeout","_element"],"sources":["/home/arslan/modojo/node_modules/monaco-editor/esm/vs/editor/browser/services/hoverService/hoverWidget.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport './hover.css';\nimport { DisposableStore } from '../../../../base/common/lifecycle.js';\nimport { Emitter } from '../../../../base/common/event.js';\nimport * as dom from '../../../../base/browser/dom.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { IConfigurationService } from '../../../../platform/configuration/common/configuration.js';\nimport { EDITOR_FONT_DEFAULTS } from '../../../common/config/editorOptions.js';\nimport { HoverAction, HoverWidget as BaseHoverWidget, getHoverAccessibleViewHint } from '../../../../base/browser/ui/hover/hoverWidget.js';\nimport { Widget } from '../../../../base/browser/ui/widget.js';\nimport { IOpenerService } from '../../../../platform/opener/common/opener.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { MarkdownRenderer, openLinkFromMarkdown } from '../../widget/markdownRenderer/browser/markdownRenderer.js';\nimport { isMarkdownString } from '../../../../base/common/htmlContent.js';\nimport { localize } from '../../../../nls.js';\nimport { isMacintosh } from '../../../../base/common/platform.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { status } from '../../../../base/browser/ui/aria/aria.js';\nconst $ = dom.$;\nlet HoverWidget = class HoverWidget extends Widget {\n    get _targetWindow() {\n        return dom.getWindow(this._target.targetElements[0]);\n    }\n    get _targetDocumentElement() {\n        return dom.getWindow(this._target.targetElements[0]).document.documentElement;\n    }\n    get isDisposed() { return this._isDisposed; }\n    get isMouseIn() { return this._lockMouseTracker.isMouseIn; }\n    get domNode() { return this._hover.containerDomNode; }\n    get onDispose() { return this._onDispose.event; }\n    get onRequestLayout() { return this._onRequestLayout.event; }\n    get anchor() { return this._hoverPosition === 2 /* HoverPosition.BELOW */ ? 0 /* AnchorPosition.BELOW */ : 1 /* AnchorPosition.ABOVE */; }\n    get x() { return this._x; }\n    get y() { return this._y; }\n    /**\n     * Whether the hover is \"locked\" by holding the alt/option key. When locked, the hover will not\n     * hide and can be hovered regardless of whether the `hideOnHover` hover option is set.\n     */\n    get isLocked() { return this._isLocked; }\n    set isLocked(value) {\n        if (this._isLocked === value) {\n            return;\n        }\n        this._isLocked = value;\n        this._hoverContainer.classList.toggle('locked', this._isLocked);\n    }\n    constructor(options, _keybindingService, _configurationService, _openerService, _instantiationService, _accessibilityService) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        super();\n        this._keybindingService = _keybindingService;\n        this._configurationService = _configurationService;\n        this._openerService = _openerService;\n        this._instantiationService = _instantiationService;\n        this._accessibilityService = _accessibilityService;\n        this._messageListeners = new DisposableStore();\n        this._isDisposed = false;\n        this._forcePosition = false;\n        this._x = 0;\n        this._y = 0;\n        this._isLocked = false;\n        this._enableFocusTraps = false;\n        this._addedFocusTrap = false;\n        this._onDispose = this._register(new Emitter());\n        this._onRequestLayout = this._register(new Emitter());\n        this._linkHandler = options.linkHandler || (url => {\n            return openLinkFromMarkdown(this._openerService, url, isMarkdownString(options.content) ? options.content.isTrusted : undefined);\n        });\n        this._target = 'targetElements' in options.target ? options.target : new ElementHoverTarget(options.target);\n        this._hoverPointer = ((_a = options.appearance) === null || _a === void 0 ? void 0 : _a.showPointer) ? $('div.workbench-hover-pointer') : undefined;\n        this._hover = this._register(new BaseHoverWidget());\n        this._hover.containerDomNode.classList.add('workbench-hover', 'fadeIn');\n        if ((_b = options.appearance) === null || _b === void 0 ? void 0 : _b.compact) {\n            this._hover.containerDomNode.classList.add('workbench-hover', 'compact');\n        }\n        if ((_c = options.appearance) === null || _c === void 0 ? void 0 : _c.skipFadeInAnimation) {\n            this._hover.containerDomNode.classList.add('skip-fade-in');\n        }\n        if (options.additionalClasses) {\n            this._hover.containerDomNode.classList.add(...options.additionalClasses);\n        }\n        if ((_d = options.position) === null || _d === void 0 ? void 0 : _d.forcePosition) {\n            this._forcePosition = true;\n        }\n        if (options.trapFocus) {\n            this._enableFocusTraps = true;\n        }\n        this._hoverPosition = (_f = (_e = options.position) === null || _e === void 0 ? void 0 : _e.hoverPosition) !== null && _f !== void 0 ? _f : 3 /* HoverPosition.ABOVE */;\n        // Don't allow mousedown out of the widget, otherwise preventDefault will call and text will\n        // not be selected.\n        this.onmousedown(this._hover.containerDomNode, e => e.stopPropagation());\n        // Hide hover on escape\n        this.onkeydown(this._hover.containerDomNode, e => {\n            if (e.equals(9 /* KeyCode.Escape */)) {\n                this.dispose();\n            }\n        });\n        // Hide when the window loses focus\n        this._register(dom.addDisposableListener(this._targetWindow, 'blur', () => this.dispose()));\n        const rowElement = $('div.hover-row.markdown-hover');\n        const contentsElement = $('div.hover-contents');\n        if (typeof options.content === 'string') {\n            contentsElement.textContent = options.content;\n            contentsElement.style.whiteSpace = 'pre-wrap';\n        }\n        else if (dom.isHTMLElement(options.content)) {\n            contentsElement.appendChild(options.content);\n            contentsElement.classList.add('html-hover-contents');\n        }\n        else {\n            const markdown = options.content;\n            const mdRenderer = this._instantiationService.createInstance(MarkdownRenderer, { codeBlockFontFamily: this._configurationService.getValue('editor').fontFamily || EDITOR_FONT_DEFAULTS.fontFamily });\n            const { element } = mdRenderer.render(markdown, {\n                actionHandler: {\n                    callback: (content) => this._linkHandler(content),\n                    disposables: this._messageListeners\n                },\n                asyncRenderCallback: () => {\n                    contentsElement.classList.add('code-hover-contents');\n                    this.layout();\n                    // This changes the dimensions of the hover so trigger a layout\n                    this._onRequestLayout.fire();\n                }\n            });\n            contentsElement.appendChild(element);\n        }\n        rowElement.appendChild(contentsElement);\n        this._hover.contentsDomNode.appendChild(rowElement);\n        if (options.actions && options.actions.length > 0) {\n            const statusBarElement = $('div.hover-row.status-bar');\n            const actionsElement = $('div.actions');\n            options.actions.forEach(action => {\n                const keybinding = this._keybindingService.lookupKeybinding(action.commandId);\n                const keybindingLabel = keybinding ? keybinding.getLabel() : null;\n                HoverAction.render(actionsElement, {\n                    label: action.label,\n                    commandId: action.commandId,\n                    run: e => {\n                        action.run(e);\n                        this.dispose();\n                    },\n                    iconClass: action.iconClass\n                }, keybindingLabel);\n            });\n            statusBarElement.appendChild(actionsElement);\n            this._hover.containerDomNode.appendChild(statusBarElement);\n        }\n        this._hoverContainer = $('div.workbench-hover-container');\n        if (this._hoverPointer) {\n            this._hoverContainer.appendChild(this._hoverPointer);\n        }\n        this._hoverContainer.appendChild(this._hover.containerDomNode);\n        // Determine whether to hide on hover\n        let hideOnHover;\n        if (options.actions && options.actions.length > 0) {\n            // If there are actions, require hover so they can be accessed\n            hideOnHover = false;\n        }\n        else {\n            if (((_g = options.persistence) === null || _g === void 0 ? void 0 : _g.hideOnHover) === undefined) {\n                // When unset, will default to true when it's a string or when it's markdown that\n                // appears to have a link using a naive check for '](' and '</a>'\n                hideOnHover = typeof options.content === 'string' ||\n                    isMarkdownString(options.content) && !options.content.value.includes('](') && !options.content.value.includes('</a>');\n            }\n            else {\n                // It's set explicitly\n                hideOnHover = options.persistence.hideOnHover;\n            }\n        }\n        // Show the hover hint if needed\n        if (hideOnHover && ((_h = options.appearance) === null || _h === void 0 ? void 0 : _h.showHoverHint)) {\n            const statusBarElement = $('div.hover-row.status-bar');\n            const infoElement = $('div.info');\n            infoElement.textContent = localize('hoverhint', 'Hold {0} key to mouse over', isMacintosh ? 'Option' : 'Alt');\n            statusBarElement.appendChild(infoElement);\n            this._hover.containerDomNode.appendChild(statusBarElement);\n        }\n        const mouseTrackerTargets = [...this._target.targetElements];\n        if (!hideOnHover) {\n            mouseTrackerTargets.push(this._hoverContainer);\n        }\n        const mouseTracker = this._register(new CompositeMouseTracker(mouseTrackerTargets));\n        this._register(mouseTracker.onMouseOut(() => {\n            if (!this._isLocked) {\n                this.dispose();\n            }\n        }));\n        // Setup another mouse tracker when hideOnHover is set in order to track the hover as well\n        // when it is locked. This ensures the hover will hide on mouseout after alt has been\n        // released to unlock the element.\n        if (hideOnHover) {\n            const mouseTracker2Targets = [...this._target.targetElements, this._hoverContainer];\n            this._lockMouseTracker = this._register(new CompositeMouseTracker(mouseTracker2Targets));\n            this._register(this._lockMouseTracker.onMouseOut(() => {\n                if (!this._isLocked) {\n                    this.dispose();\n                }\n            }));\n        }\n        else {\n            this._lockMouseTracker = mouseTracker;\n        }\n    }\n    addFocusTrap() {\n        if (!this._enableFocusTraps || this._addedFocusTrap) {\n            return;\n        }\n        this._addedFocusTrap = true;\n        // Add a hover tab loop if the hover has at least one element with a valid tabIndex\n        const firstContainerFocusElement = this._hover.containerDomNode;\n        const lastContainerFocusElement = this.findLastFocusableChild(this._hover.containerDomNode);\n        if (lastContainerFocusElement) {\n            const beforeContainerFocusElement = dom.prepend(this._hoverContainer, $('div'));\n            const afterContainerFocusElement = dom.append(this._hoverContainer, $('div'));\n            beforeContainerFocusElement.tabIndex = 0;\n            afterContainerFocusElement.tabIndex = 0;\n            this._register(dom.addDisposableListener(afterContainerFocusElement, 'focus', (e) => {\n                firstContainerFocusElement.focus();\n                e.preventDefault();\n            }));\n            this._register(dom.addDisposableListener(beforeContainerFocusElement, 'focus', (e) => {\n                lastContainerFocusElement.focus();\n                e.preventDefault();\n            }));\n        }\n    }\n    findLastFocusableChild(root) {\n        if (root.hasChildNodes()) {\n            for (let i = 0; i < root.childNodes.length; i++) {\n                const node = root.childNodes.item(root.childNodes.length - i - 1);\n                if (node.nodeType === node.ELEMENT_NODE) {\n                    const parsedNode = node;\n                    if (typeof parsedNode.tabIndex === 'number' && parsedNode.tabIndex >= 0) {\n                        return parsedNode;\n                    }\n                }\n                const recursivelyFoundElement = this.findLastFocusableChild(node);\n                if (recursivelyFoundElement) {\n                    return recursivelyFoundElement;\n                }\n            }\n        }\n        return undefined;\n    }\n    render(container) {\n        var _a;\n        container.appendChild(this._hoverContainer);\n        const hoverFocused = this._hoverContainer.contains(this._hoverContainer.ownerDocument.activeElement);\n        const accessibleViewHint = hoverFocused && getHoverAccessibleViewHint(this._configurationService.getValue('accessibility.verbosity.hover') === true && this._accessibilityService.isScreenReaderOptimized(), (_a = this._keybindingService.lookupKeybinding('editor.action.accessibleView')) === null || _a === void 0 ? void 0 : _a.getAriaLabel());\n        if (accessibleViewHint) {\n            status(accessibleViewHint);\n        }\n        this.layout();\n        this.addFocusTrap();\n    }\n    layout() {\n        this._hover.containerDomNode.classList.remove('right-aligned');\n        this._hover.contentsDomNode.style.maxHeight = '';\n        const getZoomAccountedBoundingClientRect = (e) => {\n            const zoom = dom.getDomNodeZoomLevel(e);\n            const boundingRect = e.getBoundingClientRect();\n            return {\n                top: boundingRect.top * zoom,\n                bottom: boundingRect.bottom * zoom,\n                right: boundingRect.right * zoom,\n                left: boundingRect.left * zoom,\n            };\n        };\n        const targetBounds = this._target.targetElements.map(e => getZoomAccountedBoundingClientRect(e));\n        const { top, right, bottom, left } = targetBounds[0];\n        const width = right - left;\n        const height = bottom - top;\n        const targetRect = {\n            top, right, bottom, left, width, height,\n            center: {\n                x: left + (width / 2),\n                y: top + (height / 2)\n            }\n        };\n        // These calls adjust the position depending on spacing.\n        this.adjustHorizontalHoverPosition(targetRect);\n        this.adjustVerticalHoverPosition(targetRect);\n        // This call limits the maximum height of the hover.\n        this.adjustHoverMaxHeight(targetRect);\n        // Offset the hover position if there is a pointer so it aligns with the target element\n        this._hoverContainer.style.padding = '';\n        this._hoverContainer.style.margin = '';\n        if (this._hoverPointer) {\n            switch (this._hoverPosition) {\n                case 1 /* HoverPosition.RIGHT */:\n                    targetRect.left += 3 /* Constants.PointerSize */;\n                    targetRect.right += 3 /* Constants.PointerSize */;\n                    this._hoverContainer.style.paddingLeft = `${3 /* Constants.PointerSize */}px`;\n                    this._hoverContainer.style.marginLeft = `${-3 /* Constants.PointerSize */}px`;\n                    break;\n                case 0 /* HoverPosition.LEFT */:\n                    targetRect.left -= 3 /* Constants.PointerSize */;\n                    targetRect.right -= 3 /* Constants.PointerSize */;\n                    this._hoverContainer.style.paddingRight = `${3 /* Constants.PointerSize */}px`;\n                    this._hoverContainer.style.marginRight = `${-3 /* Constants.PointerSize */}px`;\n                    break;\n                case 2 /* HoverPosition.BELOW */:\n                    targetRect.top += 3 /* Constants.PointerSize */;\n                    targetRect.bottom += 3 /* Constants.PointerSize */;\n                    this._hoverContainer.style.paddingTop = `${3 /* Constants.PointerSize */}px`;\n                    this._hoverContainer.style.marginTop = `${-3 /* Constants.PointerSize */}px`;\n                    break;\n                case 3 /* HoverPosition.ABOVE */:\n                    targetRect.top -= 3 /* Constants.PointerSize */;\n                    targetRect.bottom -= 3 /* Constants.PointerSize */;\n                    this._hoverContainer.style.paddingBottom = `${3 /* Constants.PointerSize */}px`;\n                    this._hoverContainer.style.marginBottom = `${-3 /* Constants.PointerSize */}px`;\n                    break;\n            }\n            targetRect.center.x = targetRect.left + (width / 2);\n            targetRect.center.y = targetRect.top + (height / 2);\n        }\n        this.computeXCordinate(targetRect);\n        this.computeYCordinate(targetRect);\n        if (this._hoverPointer) {\n            // reset\n            this._hoverPointer.classList.remove('top');\n            this._hoverPointer.classList.remove('left');\n            this._hoverPointer.classList.remove('right');\n            this._hoverPointer.classList.remove('bottom');\n            this.setHoverPointerPosition(targetRect);\n        }\n        this._hover.onContentsChanged();\n    }\n    computeXCordinate(target) {\n        const hoverWidth = this._hover.containerDomNode.clientWidth + 2 /* Constants.HoverBorderWidth */;\n        if (this._target.x !== undefined) {\n            this._x = this._target.x;\n        }\n        else if (this._hoverPosition === 1 /* HoverPosition.RIGHT */) {\n            this._x = target.right;\n        }\n        else if (this._hoverPosition === 0 /* HoverPosition.LEFT */) {\n            this._x = target.left - hoverWidth;\n        }\n        else {\n            if (this._hoverPointer) {\n                this._x = target.center.x - (this._hover.containerDomNode.clientWidth / 2);\n            }\n            else {\n                this._x = target.left;\n            }\n            // Hover is going beyond window towards right end\n            if (this._x + hoverWidth >= this._targetDocumentElement.clientWidth) {\n                this._hover.containerDomNode.classList.add('right-aligned');\n                this._x = Math.max(this._targetDocumentElement.clientWidth - hoverWidth - 2 /* Constants.HoverWindowEdgeMargin */, this._targetDocumentElement.clientLeft);\n            }\n        }\n        // Hover is going beyond window towards left end\n        if (this._x < this._targetDocumentElement.clientLeft) {\n            this._x = target.left + 2 /* Constants.HoverWindowEdgeMargin */;\n        }\n    }\n    computeYCordinate(target) {\n        if (this._target.y !== undefined) {\n            this._y = this._target.y;\n        }\n        else if (this._hoverPosition === 3 /* HoverPosition.ABOVE */) {\n            this._y = target.top;\n        }\n        else if (this._hoverPosition === 2 /* HoverPosition.BELOW */) {\n            this._y = target.bottom - 2;\n        }\n        else {\n            if (this._hoverPointer) {\n                this._y = target.center.y + (this._hover.containerDomNode.clientHeight / 2);\n            }\n            else {\n                this._y = target.bottom;\n            }\n        }\n        // Hover on bottom is going beyond window\n        if (this._y > this._targetWindow.innerHeight) {\n            this._y = target.bottom;\n        }\n    }\n    adjustHorizontalHoverPosition(target) {\n        // Do not adjust horizontal hover position if x cordiante is provided\n        if (this._target.x !== undefined) {\n            return;\n        }\n        const hoverPointerOffset = (this._hoverPointer ? 3 /* Constants.PointerSize */ : 0);\n        // When force position is enabled, restrict max width\n        if (this._forcePosition) {\n            const padding = hoverPointerOffset + 2 /* Constants.HoverBorderWidth */;\n            if (this._hoverPosition === 1 /* HoverPosition.RIGHT */) {\n                this._hover.containerDomNode.style.maxWidth = `${this._targetDocumentElement.clientWidth - target.right - padding}px`;\n            }\n            else if (this._hoverPosition === 0 /* HoverPosition.LEFT */) {\n                this._hover.containerDomNode.style.maxWidth = `${target.left - padding}px`;\n            }\n            return;\n        }\n        // Position hover on right to target\n        if (this._hoverPosition === 1 /* HoverPosition.RIGHT */) {\n            const roomOnRight = this._targetDocumentElement.clientWidth - target.right;\n            // Hover on the right is going beyond window.\n            if (roomOnRight < this._hover.containerDomNode.clientWidth + hoverPointerOffset) {\n                const roomOnLeft = target.left;\n                // There's enough room on the left, flip the hover position\n                if (roomOnLeft >= this._hover.containerDomNode.clientWidth + hoverPointerOffset) {\n                    this._hoverPosition = 0 /* HoverPosition.LEFT */;\n                }\n                // Hover on the left would go beyond window too\n                else {\n                    this._hoverPosition = 2 /* HoverPosition.BELOW */;\n                }\n            }\n        }\n        // Position hover on left to target\n        else if (this._hoverPosition === 0 /* HoverPosition.LEFT */) {\n            const roomOnLeft = target.left;\n            // Hover on the left is going beyond window.\n            if (roomOnLeft < this._hover.containerDomNode.clientWidth + hoverPointerOffset) {\n                const roomOnRight = this._targetDocumentElement.clientWidth - target.right;\n                // There's enough room on the right, flip the hover position\n                if (roomOnRight >= this._hover.containerDomNode.clientWidth + hoverPointerOffset) {\n                    this._hoverPosition = 1 /* HoverPosition.RIGHT */;\n                }\n                // Hover on the right would go beyond window too\n                else {\n                    this._hoverPosition = 2 /* HoverPosition.BELOW */;\n                }\n            }\n            // Hover on the left is going beyond window.\n            if (target.left - this._hover.containerDomNode.clientWidth - hoverPointerOffset <= this._targetDocumentElement.clientLeft) {\n                this._hoverPosition = 1 /* HoverPosition.RIGHT */;\n            }\n        }\n    }\n    adjustVerticalHoverPosition(target) {\n        // Do not adjust vertical hover position if the y coordinate is provided\n        // or the position is forced\n        if (this._target.y !== undefined || this._forcePosition) {\n            return;\n        }\n        const hoverPointerOffset = (this._hoverPointer ? 3 /* Constants.PointerSize */ : 0);\n        // Position hover on top of the target\n        if (this._hoverPosition === 3 /* HoverPosition.ABOVE */) {\n            // Hover on top is going beyond window\n            if (target.top - this._hover.containerDomNode.clientHeight - hoverPointerOffset < 0) {\n                this._hoverPosition = 2 /* HoverPosition.BELOW */;\n            }\n        }\n        // Position hover below the target\n        else if (this._hoverPosition === 2 /* HoverPosition.BELOW */) {\n            // Hover on bottom is going beyond window\n            if (target.bottom + this._hover.containerDomNode.clientHeight + hoverPointerOffset > this._targetWindow.innerHeight) {\n                this._hoverPosition = 3 /* HoverPosition.ABOVE */;\n            }\n        }\n    }\n    adjustHoverMaxHeight(target) {\n        let maxHeight = this._targetWindow.innerHeight / 2;\n        // When force position is enabled, restrict max height\n        if (this._forcePosition) {\n            const padding = (this._hoverPointer ? 3 /* Constants.PointerSize */ : 0) + 2 /* Constants.HoverBorderWidth */;\n            if (this._hoverPosition === 3 /* HoverPosition.ABOVE */) {\n                maxHeight = Math.min(maxHeight, target.top - padding);\n            }\n            else if (this._hoverPosition === 2 /* HoverPosition.BELOW */) {\n                maxHeight = Math.min(maxHeight, this._targetWindow.innerHeight - target.bottom - padding);\n            }\n        }\n        this._hover.containerDomNode.style.maxHeight = `${maxHeight}px`;\n        if (this._hover.contentsDomNode.clientHeight < this._hover.contentsDomNode.scrollHeight) {\n            // Add padding for a vertical scrollbar\n            const extraRightPadding = `${this._hover.scrollbar.options.verticalScrollbarSize}px`;\n            if (this._hover.contentsDomNode.style.paddingRight !== extraRightPadding) {\n                this._hover.contentsDomNode.style.paddingRight = extraRightPadding;\n            }\n        }\n    }\n    setHoverPointerPosition(target) {\n        if (!this._hoverPointer) {\n            return;\n        }\n        switch (this._hoverPosition) {\n            case 0 /* HoverPosition.LEFT */:\n            case 1 /* HoverPosition.RIGHT */: {\n                this._hoverPointer.classList.add(this._hoverPosition === 0 /* HoverPosition.LEFT */ ? 'right' : 'left');\n                const hoverHeight = this._hover.containerDomNode.clientHeight;\n                // If hover is taller than target, then show the pointer at the center of target\n                if (hoverHeight > target.height) {\n                    this._hoverPointer.style.top = `${target.center.y - (this._y - hoverHeight) - 3 /* Constants.PointerSize */}px`;\n                }\n                // Otherwise show the pointer at the center of hover\n                else {\n                    this._hoverPointer.style.top = `${Math.round((hoverHeight / 2)) - 3 /* Constants.PointerSize */}px`;\n                }\n                break;\n            }\n            case 3 /* HoverPosition.ABOVE */:\n            case 2 /* HoverPosition.BELOW */: {\n                this._hoverPointer.classList.add(this._hoverPosition === 3 /* HoverPosition.ABOVE */ ? 'bottom' : 'top');\n                const hoverWidth = this._hover.containerDomNode.clientWidth;\n                // Position pointer at the center of the hover\n                let pointerLeftPosition = Math.round((hoverWidth / 2)) - 3 /* Constants.PointerSize */;\n                // If pointer goes beyond target then position it at the center of the target\n                const pointerX = this._x + pointerLeftPosition;\n                if (pointerX < target.left || pointerX > target.right) {\n                    pointerLeftPosition = target.center.x - this._x - 3 /* Constants.PointerSize */;\n                }\n                this._hoverPointer.style.left = `${pointerLeftPosition}px`;\n                break;\n            }\n        }\n    }\n    focus() {\n        this._hover.containerDomNode.focus();\n    }\n    dispose() {\n        if (!this._isDisposed) {\n            this._onDispose.fire();\n            this._hoverContainer.remove();\n            this._messageListeners.dispose();\n            this._target.dispose();\n            super.dispose();\n        }\n        this._isDisposed = true;\n    }\n};\nHoverWidget = __decorate([\n    __param(1, IKeybindingService),\n    __param(2, IConfigurationService),\n    __param(3, IOpenerService),\n    __param(4, IInstantiationService),\n    __param(5, IAccessibilityService)\n], HoverWidget);\nexport { HoverWidget };\nclass CompositeMouseTracker extends Widget {\n    get onMouseOut() { return this._onMouseOut.event; }\n    get isMouseIn() { return this._isMouseIn; }\n    constructor(_elements) {\n        super();\n        this._elements = _elements;\n        this._isMouseIn = true;\n        this._onMouseOut = this._register(new Emitter());\n        this._elements.forEach(n => this.onmouseover(n, () => this._onTargetMouseOver(n)));\n        this._elements.forEach(n => this.onmouseleave(n, () => this._onTargetMouseLeave(n)));\n    }\n    _onTargetMouseOver(target) {\n        this._isMouseIn = true;\n        this._clearEvaluateMouseStateTimeout(target);\n    }\n    _onTargetMouseLeave(target) {\n        this._isMouseIn = false;\n        this._evaluateMouseState(target);\n    }\n    _evaluateMouseState(target) {\n        this._clearEvaluateMouseStateTimeout(target);\n        // Evaluate whether the mouse is still outside asynchronously such that other mouse targets\n        // have the opportunity to first their mouse in event.\n        this._mouseTimeout = dom.getWindow(target).setTimeout(() => this._fireIfMouseOutside(), 0);\n    }\n    _clearEvaluateMouseStateTimeout(target) {\n        if (this._mouseTimeout) {\n            dom.getWindow(target).clearTimeout(this._mouseTimeout);\n            this._mouseTimeout = undefined;\n        }\n    }\n    _fireIfMouseOutside() {\n        if (!this._isMouseIn) {\n            this._onMouseOut.fire();\n        }\n    }\n}\nclass ElementHoverTarget {\n    constructor(_element) {\n        this._element = _element;\n        this.targetElements = [this._element];\n    }\n    dispose() {\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}