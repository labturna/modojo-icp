{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { SelectedSuggestionInfo } from '../../../common/languages.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { SnippetSession } from '../../snippet/browser/snippetSession.js';\nimport { SuggestController } from '../../suggest/browser/suggestController.js';\nimport { observableValue, transaction } from '../../../../base/common/observable.js';\nimport { SingleTextEdit } from '../../../common/core/textEdit.js';\nimport { compareBy, numberComparator } from '../../../../base/common/arrays.js';\nimport { findFirstMax } from '../../../../base/common/arraysFind.js';\nimport { singleTextEditAugments, singleTextRemoveCommonPrefix } from './singleTextEdit.js';\nexport class SuggestWidgetAdaptor extends Disposable {\n  get selectedItem() {\n    return this._selectedItem;\n  }\n  constructor(editor, suggestControllerPreselector, checkModelVersion, onWillAccept) {\n    super();\n    this.editor = editor;\n    this.suggestControllerPreselector = suggestControllerPreselector;\n    this.checkModelVersion = checkModelVersion;\n    this.onWillAccept = onWillAccept;\n    this.isSuggestWidgetVisible = false;\n    this.isShiftKeyPressed = false;\n    this._isActive = false;\n    this._currentSuggestItemInfo = undefined;\n    this._selectedItem = observableValue(this, undefined);\n    // See the command acceptAlternativeSelectedSuggestion that is bound to shift+tab\n    this._register(editor.onKeyDown(e => {\n      if (e.shiftKey && !this.isShiftKeyPressed) {\n        this.isShiftKeyPressed = true;\n        this.update(this._isActive);\n      }\n    }));\n    this._register(editor.onKeyUp(e => {\n      if (e.shiftKey && this.isShiftKeyPressed) {\n        this.isShiftKeyPressed = false;\n        this.update(this._isActive);\n      }\n    }));\n    const suggestController = SuggestController.get(this.editor);\n    if (suggestController) {\n      this._register(suggestController.registerSelector({\n        priority: 100,\n        select: (model, pos, suggestItems) => {\n          transaction(tx => this.checkModelVersion(tx));\n          const textModel = this.editor.getModel();\n          if (!textModel) {\n            // Should not happen\n            return -1;\n          }\n          const i = this.suggestControllerPreselector();\n          const itemToPreselect = i ? singleTextRemoveCommonPrefix(i, textModel) : undefined;\n          if (!itemToPreselect) {\n            return -1;\n          }\n          const position = Position.lift(pos);\n          const candidates = suggestItems.map((suggestItem, index) => {\n            const suggestItemInfo = SuggestItemInfo.fromSuggestion(suggestController, textModel, position, suggestItem, this.isShiftKeyPressed);\n            const suggestItemTextEdit = singleTextRemoveCommonPrefix(suggestItemInfo.toSingleTextEdit(), textModel);\n            const valid = singleTextEditAugments(itemToPreselect, suggestItemTextEdit);\n            return {\n              index,\n              valid,\n              prefixLength: suggestItemTextEdit.text.length,\n              suggestItem\n            };\n          }).filter(item => item && item.valid && item.prefixLength > 0);\n          const result = findFirstMax(candidates, compareBy(s => s.prefixLength, numberComparator));\n          return result ? result.index : -1;\n        }\n      }));\n      let isBoundToSuggestWidget = false;\n      const bindToSuggestWidget = () => {\n        if (isBoundToSuggestWidget) {\n          return;\n        }\n        isBoundToSuggestWidget = true;\n        this._register(suggestController.widget.value.onDidShow(() => {\n          this.isSuggestWidgetVisible = true;\n          this.update(true);\n        }));\n        this._register(suggestController.widget.value.onDidHide(() => {\n          this.isSuggestWidgetVisible = false;\n          this.update(false);\n        }));\n        this._register(suggestController.widget.value.onDidFocus(() => {\n          this.isSuggestWidgetVisible = true;\n          this.update(true);\n        }));\n      };\n      this._register(Event.once(suggestController.model.onDidTrigger)(e => {\n        bindToSuggestWidget();\n      }));\n      this._register(suggestController.onWillInsertSuggestItem(e => {\n        const position = this.editor.getPosition();\n        const model = this.editor.getModel();\n        if (!position || !model) {\n          return undefined;\n        }\n        const suggestItemInfo = SuggestItemInfo.fromSuggestion(suggestController, model, position, e.item, this.isShiftKeyPressed);\n        this.onWillAccept(suggestItemInfo);\n      }));\n    }\n    this.update(this._isActive);\n  }\n  update(newActive) {\n    const newInlineCompletion = this.getSuggestItemInfo();\n    if (this._isActive !== newActive || !suggestItemInfoEquals(this._currentSuggestItemInfo, newInlineCompletion)) {\n      this._isActive = newActive;\n      this._currentSuggestItemInfo = newInlineCompletion;\n      transaction(tx => {\n        /** @description Update state from suggest widget */\n        this.checkModelVersion(tx);\n        this._selectedItem.set(this._isActive ? this._currentSuggestItemInfo : undefined, tx);\n      });\n    }\n  }\n  getSuggestItemInfo() {\n    const suggestController = SuggestController.get(this.editor);\n    if (!suggestController || !this.isSuggestWidgetVisible) {\n      return undefined;\n    }\n    const focusedItem = suggestController.widget.value.getFocusedItem();\n    const position = this.editor.getPosition();\n    const model = this.editor.getModel();\n    if (!focusedItem || !position || !model) {\n      return undefined;\n    }\n    return SuggestItemInfo.fromSuggestion(suggestController, model, position, focusedItem.item, this.isShiftKeyPressed);\n  }\n  stopForceRenderingAbove() {\n    const suggestController = SuggestController.get(this.editor);\n    suggestController === null || suggestController === void 0 ? void 0 : suggestController.stopForceRenderingAbove();\n  }\n  forceRenderingAbove() {\n    const suggestController = SuggestController.get(this.editor);\n    suggestController === null || suggestController === void 0 ? void 0 : suggestController.forceRenderingAbove();\n  }\n}\nexport class SuggestItemInfo {\n  static fromSuggestion(suggestController, model, position, item, toggleMode) {\n    let {\n      insertText\n    } = item.completion;\n    let isSnippetText = false;\n    if (item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */) {\n      const snippet = new SnippetParser().parse(insertText);\n      if (snippet.children.length < 100) {\n        // Adjust whitespace is expensive.\n        SnippetSession.adjustWhitespace(model, position, true, snippet);\n      }\n      insertText = snippet.toString();\n      isSnippetText = true;\n    }\n    const info = suggestController.getOverwriteInfo(item, toggleMode);\n    return new SuggestItemInfo(Range.fromPositions(position.delta(0, -info.overwriteBefore), position.delta(0, Math.max(info.overwriteAfter, 0))), insertText, item.completion.kind, isSnippetText);\n  }\n  constructor(range, insertText, completionItemKind, isSnippetText) {\n    this.range = range;\n    this.insertText = insertText;\n    this.completionItemKind = completionItemKind;\n    this.isSnippetText = isSnippetText;\n  }\n  equals(other) {\n    return this.range.equalsRange(other.range) && this.insertText === other.insertText && this.completionItemKind === other.completionItemKind && this.isSnippetText === other.isSnippetText;\n  }\n  toSelectedSuggestionInfo() {\n    return new SelectedSuggestionInfo(this.range, this.insertText, this.completionItemKind, this.isSnippetText);\n  }\n  toSingleTextEdit() {\n    return new SingleTextEdit(this.range, this.insertText);\n  }\n}\nfunction suggestItemInfoEquals(a, b) {\n  if (a === b) {\n    return true;\n  }\n  if (!a || !b) {\n    return false;\n  }\n  return a.equals(b);\n}","map":{"version":3,"names":["Event","Disposable","Position","Range","SelectedSuggestionInfo","SnippetParser","SnippetSession","SuggestController","observableValue","transaction","SingleTextEdit","compareBy","numberComparator","findFirstMax","singleTextEditAugments","singleTextRemoveCommonPrefix","SuggestWidgetAdaptor","selectedItem","_selectedItem","constructor","editor","suggestControllerPreselector","checkModelVersion","onWillAccept","isSuggestWidgetVisible","isShiftKeyPressed","_isActive","_currentSuggestItemInfo","undefined","_register","onKeyDown","e","shiftKey","update","onKeyUp","suggestController","get","registerSelector","priority","select","model","pos","suggestItems","tx","textModel","getModel","i","itemToPreselect","position","lift","candidates","map","suggestItem","index","suggestItemInfo","SuggestItemInfo","fromSuggestion","suggestItemTextEdit","toSingleTextEdit","valid","prefixLength","text","length","filter","item","result","s","isBoundToSuggestWidget","bindToSuggestWidget","widget","value","onDidShow","onDidHide","onDidFocus","once","onDidTrigger","onWillInsertSuggestItem","getPosition","newActive","newInlineCompletion","getSuggestItemInfo","suggestItemInfoEquals","set","focusedItem","getFocusedItem","stopForceRenderingAbove","forceRenderingAbove","toggleMode","insertText","completion","isSnippetText","insertTextRules","snippet","parse","children","adjustWhitespace","toString","info","getOverwriteInfo","fromPositions","delta","overwriteBefore","Math","max","overwriteAfter","kind","range","completionItemKind","equals","other","equalsRange","toSelectedSuggestionInfo","a","b"],"sources":["/home/arslan/modojo/node_modules/monaco-editor/esm/vs/editor/contrib/inlineCompletions/browser/suggestWidgetInlineCompletionProvider.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport { Event } from '../../../../base/common/event.js';\nimport { Disposable } from '../../../../base/common/lifecycle.js';\nimport { Position } from '../../../common/core/position.js';\nimport { Range } from '../../../common/core/range.js';\nimport { SelectedSuggestionInfo } from '../../../common/languages.js';\nimport { SnippetParser } from '../../snippet/browser/snippetParser.js';\nimport { SnippetSession } from '../../snippet/browser/snippetSession.js';\nimport { SuggestController } from '../../suggest/browser/suggestController.js';\nimport { observableValue, transaction } from '../../../../base/common/observable.js';\nimport { SingleTextEdit } from '../../../common/core/textEdit.js';\nimport { compareBy, numberComparator } from '../../../../base/common/arrays.js';\nimport { findFirstMax } from '../../../../base/common/arraysFind.js';\nimport { singleTextEditAugments, singleTextRemoveCommonPrefix } from './singleTextEdit.js';\nexport class SuggestWidgetAdaptor extends Disposable {\n    get selectedItem() {\n        return this._selectedItem;\n    }\n    constructor(editor, suggestControllerPreselector, checkModelVersion, onWillAccept) {\n        super();\n        this.editor = editor;\n        this.suggestControllerPreselector = suggestControllerPreselector;\n        this.checkModelVersion = checkModelVersion;\n        this.onWillAccept = onWillAccept;\n        this.isSuggestWidgetVisible = false;\n        this.isShiftKeyPressed = false;\n        this._isActive = false;\n        this._currentSuggestItemInfo = undefined;\n        this._selectedItem = observableValue(this, undefined);\n        // See the command acceptAlternativeSelectedSuggestion that is bound to shift+tab\n        this._register(editor.onKeyDown(e => {\n            if (e.shiftKey && !this.isShiftKeyPressed) {\n                this.isShiftKeyPressed = true;\n                this.update(this._isActive);\n            }\n        }));\n        this._register(editor.onKeyUp(e => {\n            if (e.shiftKey && this.isShiftKeyPressed) {\n                this.isShiftKeyPressed = false;\n                this.update(this._isActive);\n            }\n        }));\n        const suggestController = SuggestController.get(this.editor);\n        if (suggestController) {\n            this._register(suggestController.registerSelector({\n                priority: 100,\n                select: (model, pos, suggestItems) => {\n                    transaction(tx => this.checkModelVersion(tx));\n                    const textModel = this.editor.getModel();\n                    if (!textModel) {\n                        // Should not happen\n                        return -1;\n                    }\n                    const i = this.suggestControllerPreselector();\n                    const itemToPreselect = i ? singleTextRemoveCommonPrefix(i, textModel) : undefined;\n                    if (!itemToPreselect) {\n                        return -1;\n                    }\n                    const position = Position.lift(pos);\n                    const candidates = suggestItems\n                        .map((suggestItem, index) => {\n                        const suggestItemInfo = SuggestItemInfo.fromSuggestion(suggestController, textModel, position, suggestItem, this.isShiftKeyPressed);\n                        const suggestItemTextEdit = singleTextRemoveCommonPrefix(suggestItemInfo.toSingleTextEdit(), textModel);\n                        const valid = singleTextEditAugments(itemToPreselect, suggestItemTextEdit);\n                        return { index, valid, prefixLength: suggestItemTextEdit.text.length, suggestItem };\n                    })\n                        .filter(item => item && item.valid && item.prefixLength > 0);\n                    const result = findFirstMax(candidates, compareBy(s => s.prefixLength, numberComparator));\n                    return result ? result.index : -1;\n                }\n            }));\n            let isBoundToSuggestWidget = false;\n            const bindToSuggestWidget = () => {\n                if (isBoundToSuggestWidget) {\n                    return;\n                }\n                isBoundToSuggestWidget = true;\n                this._register(suggestController.widget.value.onDidShow(() => {\n                    this.isSuggestWidgetVisible = true;\n                    this.update(true);\n                }));\n                this._register(suggestController.widget.value.onDidHide(() => {\n                    this.isSuggestWidgetVisible = false;\n                    this.update(false);\n                }));\n                this._register(suggestController.widget.value.onDidFocus(() => {\n                    this.isSuggestWidgetVisible = true;\n                    this.update(true);\n                }));\n            };\n            this._register(Event.once(suggestController.model.onDidTrigger)(e => {\n                bindToSuggestWidget();\n            }));\n            this._register(suggestController.onWillInsertSuggestItem(e => {\n                const position = this.editor.getPosition();\n                const model = this.editor.getModel();\n                if (!position || !model) {\n                    return undefined;\n                }\n                const suggestItemInfo = SuggestItemInfo.fromSuggestion(suggestController, model, position, e.item, this.isShiftKeyPressed);\n                this.onWillAccept(suggestItemInfo);\n            }));\n        }\n        this.update(this._isActive);\n    }\n    update(newActive) {\n        const newInlineCompletion = this.getSuggestItemInfo();\n        if (this._isActive !== newActive || !suggestItemInfoEquals(this._currentSuggestItemInfo, newInlineCompletion)) {\n            this._isActive = newActive;\n            this._currentSuggestItemInfo = newInlineCompletion;\n            transaction(tx => {\n                /** @description Update state from suggest widget */\n                this.checkModelVersion(tx);\n                this._selectedItem.set(this._isActive ? this._currentSuggestItemInfo : undefined, tx);\n            });\n        }\n    }\n    getSuggestItemInfo() {\n        const suggestController = SuggestController.get(this.editor);\n        if (!suggestController || !this.isSuggestWidgetVisible) {\n            return undefined;\n        }\n        const focusedItem = suggestController.widget.value.getFocusedItem();\n        const position = this.editor.getPosition();\n        const model = this.editor.getModel();\n        if (!focusedItem || !position || !model) {\n            return undefined;\n        }\n        return SuggestItemInfo.fromSuggestion(suggestController, model, position, focusedItem.item, this.isShiftKeyPressed);\n    }\n    stopForceRenderingAbove() {\n        const suggestController = SuggestController.get(this.editor);\n        suggestController === null || suggestController === void 0 ? void 0 : suggestController.stopForceRenderingAbove();\n    }\n    forceRenderingAbove() {\n        const suggestController = SuggestController.get(this.editor);\n        suggestController === null || suggestController === void 0 ? void 0 : suggestController.forceRenderingAbove();\n    }\n}\nexport class SuggestItemInfo {\n    static fromSuggestion(suggestController, model, position, item, toggleMode) {\n        let { insertText } = item.completion;\n        let isSnippetText = false;\n        if (item.completion.insertTextRules & 4 /* CompletionItemInsertTextRule.InsertAsSnippet */) {\n            const snippet = new SnippetParser().parse(insertText);\n            if (snippet.children.length < 100) {\n                // Adjust whitespace is expensive.\n                SnippetSession.adjustWhitespace(model, position, true, snippet);\n            }\n            insertText = snippet.toString();\n            isSnippetText = true;\n        }\n        const info = suggestController.getOverwriteInfo(item, toggleMode);\n        return new SuggestItemInfo(Range.fromPositions(position.delta(0, -info.overwriteBefore), position.delta(0, Math.max(info.overwriteAfter, 0))), insertText, item.completion.kind, isSnippetText);\n    }\n    constructor(range, insertText, completionItemKind, isSnippetText) {\n        this.range = range;\n        this.insertText = insertText;\n        this.completionItemKind = completionItemKind;\n        this.isSnippetText = isSnippetText;\n    }\n    equals(other) {\n        return this.range.equalsRange(other.range)\n            && this.insertText === other.insertText\n            && this.completionItemKind === other.completionItemKind\n            && this.isSnippetText === other.isSnippetText;\n    }\n    toSelectedSuggestionInfo() {\n        return new SelectedSuggestionInfo(this.range, this.insertText, this.completionItemKind, this.isSnippetText);\n    }\n    toSingleTextEdit() {\n        return new SingleTextEdit(this.range, this.insertText);\n    }\n}\nfunction suggestItemInfoEquals(a, b) {\n    if (a === b) {\n        return true;\n    }\n    if (!a || !b) {\n        return false;\n    }\n    return a.equals(b);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}