{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n    r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n    d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { editorHoverBorder } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { HoverWidget } from './hoverWidget.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { addDisposableListener, EventType, getActiveElement, isAncestorOfActiveElement, isAncestor, getWindow, isHTMLElement } from '../../../../base/browser/dom.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { StandardKeyboardEvent } from '../../../../base/browser/keyboardEvent.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { ILayoutService } from '../../../../platform/layout/browser/layoutService.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { ContextViewHandler } from '../../../../platform/contextview/browser/contextViewService.js';\nimport { UpdatableHoverWidget } from './updatableHoverWidget.js';\nimport { TimeoutTimer } from '../../../../base/common/async.js';\nlet HoverService = class HoverService extends Disposable {\n  constructor(_instantiationService, contextMenuService, _keybindingService, _layoutService, _accessibilityService) {\n    super();\n    this._instantiationService = _instantiationService;\n    this._keybindingService = _keybindingService;\n    this._layoutService = _layoutService;\n    this._accessibilityService = _accessibilityService;\n    this._existingHovers = new Map();\n    contextMenuService.onDidShowContextMenu(() => this.hideHover());\n    this._contextViewHandler = this._register(new ContextViewHandler(this._layoutService));\n  }\n  showHover(options, focus, skipLastFocusedUpdate) {\n    var _a, _b, _c, _d;\n    if (getHoverOptionsIdentity(this._currentHoverOptions) === getHoverOptionsIdentity(options)) {\n      return undefined;\n    }\n    if (this._currentHover && ((_b = (_a = this._currentHoverOptions) === null || _a === void 0 ? void 0 : _a.persistence) === null || _b === void 0 ? void 0 : _b.sticky)) {\n      return undefined;\n    }\n    this._currentHoverOptions = options;\n    this._lastHoverOptions = options;\n    const trapFocus = options.trapFocus || this._accessibilityService.isScreenReaderOptimized();\n    const activeElement = getActiveElement();\n    // HACK, remove this check when #189076 is fixed\n    if (!skipLastFocusedUpdate) {\n      if (trapFocus && activeElement) {\n        if (!activeElement.classList.contains('monaco-hover')) {\n          this._lastFocusedElementBeforeOpen = activeElement;\n        }\n      } else {\n        this._lastFocusedElementBeforeOpen = undefined;\n      }\n    }\n    const hoverDisposables = new DisposableStore();\n    const hover = this._instantiationService.createInstance(HoverWidget, options);\n    if ((_c = options.persistence) === null || _c === void 0 ? void 0 : _c.sticky) {\n      hover.isLocked = true;\n    }\n    hover.onDispose(() => {\n      var _a, _b;\n      const hoverWasFocused = ((_a = this._currentHover) === null || _a === void 0 ? void 0 : _a.domNode) && isAncestorOfActiveElement(this._currentHover.domNode);\n      if (hoverWasFocused) {\n        // Required to handle cases such as closing the hover with the escape key\n        (_b = this._lastFocusedElementBeforeOpen) === null || _b === void 0 ? void 0 : _b.focus();\n      }\n      // Only clear the current options if it's the current hover, the current options help\n      // reduce flickering when the same hover is shown multiple times\n      if (this._currentHoverOptions === options) {\n        this._currentHoverOptions = undefined;\n      }\n      hoverDisposables.dispose();\n    }, undefined, hoverDisposables);\n    // Set the container explicitly to enable aux window support\n    if (!options.container) {\n      const targetElement = isHTMLElement(options.target) ? options.target : options.target.targetElements[0];\n      options.container = this._layoutService.getContainer(getWindow(targetElement));\n    }\n    this._contextViewHandler.showContextView(new HoverContextViewDelegate(hover, focus), options.container);\n    hover.onRequestLayout(() => this._contextViewHandler.layout(), undefined, hoverDisposables);\n    if ((_d = options.persistence) === null || _d === void 0 ? void 0 : _d.sticky) {\n      hoverDisposables.add(addDisposableListener(getWindow(options.container).document, EventType.MOUSE_DOWN, e => {\n        if (!isAncestor(e.target, hover.domNode)) {\n          this.doHideHover();\n        }\n      }));\n    } else {\n      if ('targetElements' in options.target) {\n        for (const element of options.target.targetElements) {\n          hoverDisposables.add(addDisposableListener(element, EventType.CLICK, () => this.hideHover()));\n        }\n      } else {\n        hoverDisposables.add(addDisposableListener(options.target, EventType.CLICK, () => this.hideHover()));\n      }\n      const focusedElement = getActiveElement();\n      if (focusedElement) {\n        const focusedElementDocument = getWindow(focusedElement).document;\n        hoverDisposables.add(addDisposableListener(focusedElement, EventType.KEY_DOWN, e => {\n          var _a;\n          return this._keyDown(e, hover, !!((_a = options.persistence) === null || _a === void 0 ? void 0 : _a.hideOnKeyDown));\n        }));\n        hoverDisposables.add(addDisposableListener(focusedElementDocument, EventType.KEY_DOWN, e => {\n          var _a;\n          return this._keyDown(e, hover, !!((_a = options.persistence) === null || _a === void 0 ? void 0 : _a.hideOnKeyDown));\n        }));\n        hoverDisposables.add(addDisposableListener(focusedElement, EventType.KEY_UP, e => this._keyUp(e, hover)));\n        hoverDisposables.add(addDisposableListener(focusedElementDocument, EventType.KEY_UP, e => this._keyUp(e, hover)));\n      }\n    }\n    if ('IntersectionObserver' in mainWindow) {\n      const observer = new IntersectionObserver(e => this._intersectionChange(e, hover), {\n        threshold: 0\n      });\n      const firstTargetElement = 'targetElements' in options.target ? options.target.targetElements[0] : options.target;\n      observer.observe(firstTargetElement);\n      hoverDisposables.add(toDisposable(() => observer.disconnect()));\n    }\n    this._currentHover = hover;\n    return hover;\n  }\n  hideHover() {\n    var _a;\n    if (((_a = this._currentHover) === null || _a === void 0 ? void 0 : _a.isLocked) || !this._currentHoverOptions) {\n      return;\n    }\n    this.doHideHover();\n  }\n  doHideHover() {\n    this._currentHover = undefined;\n    this._currentHoverOptions = undefined;\n    this._contextViewHandler.hideContextView();\n  }\n  _intersectionChange(entries, hover) {\n    const entry = entries[entries.length - 1];\n    if (!entry.isIntersecting) {\n      hover.dispose();\n    }\n  }\n  showAndFocusLastHover() {\n    if (!this._lastHoverOptions) {\n      return;\n    }\n    this.showHover(this._lastHoverOptions, true, true);\n  }\n  _keyDown(e, hover, hideOnKeyDown) {\n    var _a, _b;\n    if (e.key === 'Alt') {\n      hover.isLocked = true;\n      return;\n    }\n    const event = new StandardKeyboardEvent(e);\n    const keybinding = this._keybindingService.resolveKeyboardEvent(event);\n    if (keybinding.getSingleModifierDispatchChords().some(value => !!value) || this._keybindingService.softDispatch(event, event.target).kind !== 0 /* ResultKind.NoMatchingKb */) {\n      return;\n    }\n    if (hideOnKeyDown && (!((_a = this._currentHoverOptions) === null || _a === void 0 ? void 0 : _a.trapFocus) || e.key !== 'Tab')) {\n      this.hideHover();\n      (_b = this._lastFocusedElementBeforeOpen) === null || _b === void 0 ? void 0 : _b.focus();\n    }\n  }\n  _keyUp(e, hover) {\n    var _a;\n    if (e.key === 'Alt') {\n      hover.isLocked = false;\n      // Hide if alt is released while the mouse is not over hover/target\n      if (!hover.isMouseIn) {\n        this.hideHover();\n        (_a = this._lastFocusedElementBeforeOpen) === null || _a === void 0 ? void 0 : _a.focus();\n      }\n    }\n  }\n  // TODO: Investigate performance of this function. There seems to be a lot of content created\n  //       and thrown away on start up\n  setupUpdatableHover(hoverDelegate, htmlElement, content, options) {\n    htmlElement.setAttribute('custom-hover', 'true');\n    if (htmlElement.title !== '') {\n      console.warn('HTML element already has a title attribute, which will conflict with the custom hover. Please remove the title attribute.');\n      console.trace('Stack trace:', htmlElement.title);\n      htmlElement.title = '';\n    }\n    let hoverPreparation;\n    let hoverWidget;\n    const hideHover = (disposeWidget, disposePreparation) => {\n      var _a;\n      const hadHover = hoverWidget !== undefined;\n      if (disposeWidget) {\n        hoverWidget === null || hoverWidget === void 0 ? void 0 : hoverWidget.dispose();\n        hoverWidget = undefined;\n      }\n      if (disposePreparation) {\n        hoverPreparation === null || hoverPreparation === void 0 ? void 0 : hoverPreparation.dispose();\n        hoverPreparation = undefined;\n      }\n      if (hadHover) {\n        (_a = hoverDelegate.onDidHideHover) === null || _a === void 0 ? void 0 : _a.call(hoverDelegate);\n        hoverWidget = undefined;\n      }\n    };\n    const triggerShowHover = (delay, focus, target, trapFocus) => {\n      return new TimeoutTimer(async () => {\n        if (!hoverWidget || hoverWidget.isDisposed) {\n          hoverWidget = new UpdatableHoverWidget(hoverDelegate, target || htmlElement, delay > 0);\n          await hoverWidget.update(typeof content === 'function' ? content() : content, focus, {\n            ...options,\n            trapFocus\n          });\n        }\n      }, delay);\n    };\n    let isMouseDown = false;\n    const mouseDownEmitter = addDisposableListener(htmlElement, EventType.MOUSE_DOWN, () => {\n      isMouseDown = true;\n      hideHover(true, true);\n    }, true);\n    const mouseUpEmitter = addDisposableListener(htmlElement, EventType.MOUSE_UP, () => {\n      isMouseDown = false;\n    }, true);\n    const mouseLeaveEmitter = addDisposableListener(htmlElement, EventType.MOUSE_LEAVE, e => {\n      isMouseDown = false;\n      hideHover(false, e.fromElement === htmlElement);\n    }, true);\n    const onMouseOver = e => {\n      if (hoverPreparation) {\n        return;\n      }\n      const toDispose = new DisposableStore();\n      const target = {\n        targetElements: [htmlElement],\n        dispose: () => {}\n      };\n      if (hoverDelegate.placement === undefined || hoverDelegate.placement === 'mouse') {\n        // track the mouse position\n        const onMouseMove = e => {\n          target.x = e.x + 10;\n          if (isHTMLElement(e.target) && getHoverTargetElement(e.target, htmlElement) !== htmlElement) {\n            hideHover(true, true);\n          }\n        };\n        toDispose.add(addDisposableListener(htmlElement, EventType.MOUSE_MOVE, onMouseMove, true));\n      }\n      hoverPreparation = toDispose;\n      if (isHTMLElement(e.target) && getHoverTargetElement(e.target, htmlElement) !== htmlElement) {\n        return; // Do not show hover when the mouse is over another hover target\n      }\n      toDispose.add(triggerShowHover(hoverDelegate.delay, false, target));\n    };\n    const mouseOverDomEmitter = addDisposableListener(htmlElement, EventType.MOUSE_OVER, onMouseOver, true);\n    const onFocus = () => {\n      if (isMouseDown || hoverPreparation) {\n        return;\n      }\n      const target = {\n        targetElements: [htmlElement],\n        dispose: () => {}\n      };\n      const toDispose = new DisposableStore();\n      const onBlur = () => hideHover(true, true);\n      toDispose.add(addDisposableListener(htmlElement, EventType.BLUR, onBlur, true));\n      toDispose.add(triggerShowHover(hoverDelegate.delay, false, target));\n      hoverPreparation = toDispose;\n    };\n    // Do not show hover when focusing an input or textarea\n    let focusDomEmitter;\n    const tagName = htmlElement.tagName.toLowerCase();\n    if (tagName !== 'input' && tagName !== 'textarea') {\n      focusDomEmitter = addDisposableListener(htmlElement, EventType.FOCUS, onFocus, true);\n    }\n    const hover = {\n      show: focus => {\n        hideHover(false, true); // terminate a ongoing mouse over preparation\n        triggerShowHover(0, focus, undefined, focus); // show hover immediately\n      },\n      hide: () => {\n        hideHover(true, true);\n      },\n      update: async (newContent, hoverOptions) => {\n        content = newContent;\n        await (hoverWidget === null || hoverWidget === void 0 ? void 0 : hoverWidget.update(content, undefined, hoverOptions));\n      },\n      dispose: () => {\n        this._existingHovers.delete(htmlElement);\n        mouseOverDomEmitter.dispose();\n        mouseLeaveEmitter.dispose();\n        mouseDownEmitter.dispose();\n        mouseUpEmitter.dispose();\n        focusDomEmitter === null || focusDomEmitter === void 0 ? void 0 : focusDomEmitter.dispose();\n        hideHover(true, true);\n      }\n    };\n    this._existingHovers.set(htmlElement, hover);\n    return hover;\n  }\n  triggerUpdatableHover(target) {\n    const hover = this._existingHovers.get(target);\n    if (hover) {\n      hover.show(true);\n    }\n  }\n  dispose() {\n    this._existingHovers.forEach(hover => hover.dispose());\n    super.dispose();\n  }\n};\nHoverService = __decorate([__param(0, IInstantiationService), __param(1, IContextMenuService), __param(2, IKeybindingService), __param(3, ILayoutService), __param(4, IAccessibilityService)], HoverService);\nexport { HoverService };\nfunction getHoverOptionsIdentity(options) {\n  var _a;\n  if (options === undefined) {\n    return undefined;\n  }\n  return (_a = options === null || options === void 0 ? void 0 : options.id) !== null && _a !== void 0 ? _a : options;\n}\nclass HoverContextViewDelegate {\n  get anchorPosition() {\n    return this._hover.anchor;\n  }\n  constructor(_hover) {\n    let _focus = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    this._hover = _hover;\n    this._focus = _focus;\n    // Render over all other context views\n    this.layer = 1;\n  }\n  render(container) {\n    this._hover.render(container);\n    if (this._focus) {\n      this._hover.focus();\n    }\n    return this._hover;\n  }\n  getAnchor() {\n    return {\n      x: this._hover.x,\n      y: this._hover.y\n    };\n  }\n  layout() {\n    this._hover.layout();\n  }\n}\nfunction getHoverTargetElement(element, stopElement) {\n  stopElement = stopElement !== null && stopElement !== void 0 ? stopElement : getWindow(element).document.body;\n  while (!element.hasAttribute('custom-hover') && element !== stopElement) {\n    element = element.parentElement;\n  }\n  return element;\n}\nregisterSingleton(IHoverService, HoverService, 1 /* InstantiationType.Delayed */);\nregisterThemingParticipant((theme, collector) => {\n  const hoverBorder = theme.getColor(editorHoverBorder);\n  if (hoverBorder) {\n    collector.addRule(`.monaco-workbench .workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n    collector.addRule(`.monaco-workbench .workbench-hover hr { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n  }\n});","map":{"version":3,"names":["__decorate","decorators","target","key","desc","c","arguments","length","r","Object","getOwnPropertyDescriptor","d","Reflect","decorate","i","defineProperty","__param","paramIndex","decorator","registerSingleton","registerThemingParticipant","editorHoverBorder","IHoverService","IContextMenuService","IInstantiationService","HoverWidget","Disposable","DisposableStore","toDisposable","addDisposableListener","EventType","getActiveElement","isAncestorOfActiveElement","isAncestor","getWindow","isHTMLElement","IKeybindingService","StandardKeyboardEvent","IAccessibilityService","ILayoutService","mainWindow","ContextViewHandler","UpdatableHoverWidget","TimeoutTimer","HoverService","constructor","_instantiationService","contextMenuService","_keybindingService","_layoutService","_accessibilityService","_existingHovers","Map","onDidShowContextMenu","hideHover","_contextViewHandler","_register","showHover","options","focus","skipLastFocusedUpdate","_a","_b","_c","_d","getHoverOptionsIdentity","_currentHoverOptions","undefined","_currentHover","persistence","sticky","_lastHoverOptions","trapFocus","isScreenReaderOptimized","activeElement","classList","contains","_lastFocusedElementBeforeOpen","hoverDisposables","hover","createInstance","isLocked","onDispose","hoverWasFocused","domNode","dispose","container","targetElement","targetElements","getContainer","showContextView","HoverContextViewDelegate","onRequestLayout","layout","add","document","MOUSE_DOWN","e","doHideHover","element","CLICK","focusedElement","focusedElementDocument","KEY_DOWN","_keyDown","hideOnKeyDown","KEY_UP","_keyUp","observer","IntersectionObserver","_intersectionChange","threshold","firstTargetElement","observe","disconnect","hideContextView","entries","entry","isIntersecting","showAndFocusLastHover","event","keybinding","resolveKeyboardEvent","getSingleModifierDispatchChords","some","value","softDispatch","kind","isMouseIn","setupUpdatableHover","hoverDelegate","htmlElement","content","setAttribute","title","console","warn","trace","hoverPreparation","hoverWidget","disposeWidget","disposePreparation","hadHover","onDidHideHover","call","triggerShowHover","delay","isDisposed","update","isMouseDown","mouseDownEmitter","mouseUpEmitter","MOUSE_UP","mouseLeaveEmitter","MOUSE_LEAVE","fromElement","onMouseOver","toDispose","placement","onMouseMove","x","getHoverTargetElement","MOUSE_MOVE","mouseOverDomEmitter","MOUSE_OVER","onFocus","onBlur","BLUR","focusDomEmitter","tagName","toLowerCase","FOCUS","show","hide","newContent","hoverOptions","delete","set","triggerUpdatableHover","get","forEach","id","anchorPosition","_hover","anchor","_focus","layer","render","getAnchor","y","stopElement","body","hasAttribute","parentElement","theme","collector","hoverBorder","getColor","addRule","transparent"],"sources":["/home/arslan/modojo/node_modules/monaco-editor/esm/vs/editor/browser/services/hoverService/hoverService.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __param = (this && this.__param) || function (paramIndex, decorator) {\n    return function (target, key) { decorator(target, key, paramIndex); }\n};\nimport { registerSingleton } from '../../../../platform/instantiation/common/extensions.js';\nimport { registerThemingParticipant } from '../../../../platform/theme/common/themeService.js';\nimport { editorHoverBorder } from '../../../../platform/theme/common/colorRegistry.js';\nimport { IHoverService } from '../../../../platform/hover/browser/hover.js';\nimport { IContextMenuService } from '../../../../platform/contextview/browser/contextView.js';\nimport { IInstantiationService } from '../../../../platform/instantiation/common/instantiation.js';\nimport { HoverWidget } from './hoverWidget.js';\nimport { Disposable, DisposableStore, toDisposable } from '../../../../base/common/lifecycle.js';\nimport { addDisposableListener, EventType, getActiveElement, isAncestorOfActiveElement, isAncestor, getWindow, isHTMLElement } from '../../../../base/browser/dom.js';\nimport { IKeybindingService } from '../../../../platform/keybinding/common/keybinding.js';\nimport { StandardKeyboardEvent } from '../../../../base/browser/keyboardEvent.js';\nimport { IAccessibilityService } from '../../../../platform/accessibility/common/accessibility.js';\nimport { ILayoutService } from '../../../../platform/layout/browser/layoutService.js';\nimport { mainWindow } from '../../../../base/browser/window.js';\nimport { ContextViewHandler } from '../../../../platform/contextview/browser/contextViewService.js';\nimport { UpdatableHoverWidget } from './updatableHoverWidget.js';\nimport { TimeoutTimer } from '../../../../base/common/async.js';\nlet HoverService = class HoverService extends Disposable {\n    constructor(_instantiationService, contextMenuService, _keybindingService, _layoutService, _accessibilityService) {\n        super();\n        this._instantiationService = _instantiationService;\n        this._keybindingService = _keybindingService;\n        this._layoutService = _layoutService;\n        this._accessibilityService = _accessibilityService;\n        this._existingHovers = new Map();\n        contextMenuService.onDidShowContextMenu(() => this.hideHover());\n        this._contextViewHandler = this._register(new ContextViewHandler(this._layoutService));\n    }\n    showHover(options, focus, skipLastFocusedUpdate) {\n        var _a, _b, _c, _d;\n        if (getHoverOptionsIdentity(this._currentHoverOptions) === getHoverOptionsIdentity(options)) {\n            return undefined;\n        }\n        if (this._currentHover && ((_b = (_a = this._currentHoverOptions) === null || _a === void 0 ? void 0 : _a.persistence) === null || _b === void 0 ? void 0 : _b.sticky)) {\n            return undefined;\n        }\n        this._currentHoverOptions = options;\n        this._lastHoverOptions = options;\n        const trapFocus = options.trapFocus || this._accessibilityService.isScreenReaderOptimized();\n        const activeElement = getActiveElement();\n        // HACK, remove this check when #189076 is fixed\n        if (!skipLastFocusedUpdate) {\n            if (trapFocus && activeElement) {\n                if (!activeElement.classList.contains('monaco-hover')) {\n                    this._lastFocusedElementBeforeOpen = activeElement;\n                }\n            }\n            else {\n                this._lastFocusedElementBeforeOpen = undefined;\n            }\n        }\n        const hoverDisposables = new DisposableStore();\n        const hover = this._instantiationService.createInstance(HoverWidget, options);\n        if ((_c = options.persistence) === null || _c === void 0 ? void 0 : _c.sticky) {\n            hover.isLocked = true;\n        }\n        hover.onDispose(() => {\n            var _a, _b;\n            const hoverWasFocused = ((_a = this._currentHover) === null || _a === void 0 ? void 0 : _a.domNode) && isAncestorOfActiveElement(this._currentHover.domNode);\n            if (hoverWasFocused) {\n                // Required to handle cases such as closing the hover with the escape key\n                (_b = this._lastFocusedElementBeforeOpen) === null || _b === void 0 ? void 0 : _b.focus();\n            }\n            // Only clear the current options if it's the current hover, the current options help\n            // reduce flickering when the same hover is shown multiple times\n            if (this._currentHoverOptions === options) {\n                this._currentHoverOptions = undefined;\n            }\n            hoverDisposables.dispose();\n        }, undefined, hoverDisposables);\n        // Set the container explicitly to enable aux window support\n        if (!options.container) {\n            const targetElement = isHTMLElement(options.target) ? options.target : options.target.targetElements[0];\n            options.container = this._layoutService.getContainer(getWindow(targetElement));\n        }\n        this._contextViewHandler.showContextView(new HoverContextViewDelegate(hover, focus), options.container);\n        hover.onRequestLayout(() => this._contextViewHandler.layout(), undefined, hoverDisposables);\n        if ((_d = options.persistence) === null || _d === void 0 ? void 0 : _d.sticky) {\n            hoverDisposables.add(addDisposableListener(getWindow(options.container).document, EventType.MOUSE_DOWN, e => {\n                if (!isAncestor(e.target, hover.domNode)) {\n                    this.doHideHover();\n                }\n            }));\n        }\n        else {\n            if ('targetElements' in options.target) {\n                for (const element of options.target.targetElements) {\n                    hoverDisposables.add(addDisposableListener(element, EventType.CLICK, () => this.hideHover()));\n                }\n            }\n            else {\n                hoverDisposables.add(addDisposableListener(options.target, EventType.CLICK, () => this.hideHover()));\n            }\n            const focusedElement = getActiveElement();\n            if (focusedElement) {\n                const focusedElementDocument = getWindow(focusedElement).document;\n                hoverDisposables.add(addDisposableListener(focusedElement, EventType.KEY_DOWN, e => { var _a; return this._keyDown(e, hover, !!((_a = options.persistence) === null || _a === void 0 ? void 0 : _a.hideOnKeyDown)); }));\n                hoverDisposables.add(addDisposableListener(focusedElementDocument, EventType.KEY_DOWN, e => { var _a; return this._keyDown(e, hover, !!((_a = options.persistence) === null || _a === void 0 ? void 0 : _a.hideOnKeyDown)); }));\n                hoverDisposables.add(addDisposableListener(focusedElement, EventType.KEY_UP, e => this._keyUp(e, hover)));\n                hoverDisposables.add(addDisposableListener(focusedElementDocument, EventType.KEY_UP, e => this._keyUp(e, hover)));\n            }\n        }\n        if ('IntersectionObserver' in mainWindow) {\n            const observer = new IntersectionObserver(e => this._intersectionChange(e, hover), { threshold: 0 });\n            const firstTargetElement = 'targetElements' in options.target ? options.target.targetElements[0] : options.target;\n            observer.observe(firstTargetElement);\n            hoverDisposables.add(toDisposable(() => observer.disconnect()));\n        }\n        this._currentHover = hover;\n        return hover;\n    }\n    hideHover() {\n        var _a;\n        if (((_a = this._currentHover) === null || _a === void 0 ? void 0 : _a.isLocked) || !this._currentHoverOptions) {\n            return;\n        }\n        this.doHideHover();\n    }\n    doHideHover() {\n        this._currentHover = undefined;\n        this._currentHoverOptions = undefined;\n        this._contextViewHandler.hideContextView();\n    }\n    _intersectionChange(entries, hover) {\n        const entry = entries[entries.length - 1];\n        if (!entry.isIntersecting) {\n            hover.dispose();\n        }\n    }\n    showAndFocusLastHover() {\n        if (!this._lastHoverOptions) {\n            return;\n        }\n        this.showHover(this._lastHoverOptions, true, true);\n    }\n    _keyDown(e, hover, hideOnKeyDown) {\n        var _a, _b;\n        if (e.key === 'Alt') {\n            hover.isLocked = true;\n            return;\n        }\n        const event = new StandardKeyboardEvent(e);\n        const keybinding = this._keybindingService.resolveKeyboardEvent(event);\n        if (keybinding.getSingleModifierDispatchChords().some(value => !!value) || this._keybindingService.softDispatch(event, event.target).kind !== 0 /* ResultKind.NoMatchingKb */) {\n            return;\n        }\n        if (hideOnKeyDown && (!((_a = this._currentHoverOptions) === null || _a === void 0 ? void 0 : _a.trapFocus) || e.key !== 'Tab')) {\n            this.hideHover();\n            (_b = this._lastFocusedElementBeforeOpen) === null || _b === void 0 ? void 0 : _b.focus();\n        }\n    }\n    _keyUp(e, hover) {\n        var _a;\n        if (e.key === 'Alt') {\n            hover.isLocked = false;\n            // Hide if alt is released while the mouse is not over hover/target\n            if (!hover.isMouseIn) {\n                this.hideHover();\n                (_a = this._lastFocusedElementBeforeOpen) === null || _a === void 0 ? void 0 : _a.focus();\n            }\n        }\n    }\n    // TODO: Investigate performance of this function. There seems to be a lot of content created\n    //       and thrown away on start up\n    setupUpdatableHover(hoverDelegate, htmlElement, content, options) {\n        htmlElement.setAttribute('custom-hover', 'true');\n        if (htmlElement.title !== '') {\n            console.warn('HTML element already has a title attribute, which will conflict with the custom hover. Please remove the title attribute.');\n            console.trace('Stack trace:', htmlElement.title);\n            htmlElement.title = '';\n        }\n        let hoverPreparation;\n        let hoverWidget;\n        const hideHover = (disposeWidget, disposePreparation) => {\n            var _a;\n            const hadHover = hoverWidget !== undefined;\n            if (disposeWidget) {\n                hoverWidget === null || hoverWidget === void 0 ? void 0 : hoverWidget.dispose();\n                hoverWidget = undefined;\n            }\n            if (disposePreparation) {\n                hoverPreparation === null || hoverPreparation === void 0 ? void 0 : hoverPreparation.dispose();\n                hoverPreparation = undefined;\n            }\n            if (hadHover) {\n                (_a = hoverDelegate.onDidHideHover) === null || _a === void 0 ? void 0 : _a.call(hoverDelegate);\n                hoverWidget = undefined;\n            }\n        };\n        const triggerShowHover = (delay, focus, target, trapFocus) => {\n            return new TimeoutTimer(async () => {\n                if (!hoverWidget || hoverWidget.isDisposed) {\n                    hoverWidget = new UpdatableHoverWidget(hoverDelegate, target || htmlElement, delay > 0);\n                    await hoverWidget.update(typeof content === 'function' ? content() : content, focus, { ...options, trapFocus });\n                }\n            }, delay);\n        };\n        let isMouseDown = false;\n        const mouseDownEmitter = addDisposableListener(htmlElement, EventType.MOUSE_DOWN, () => {\n            isMouseDown = true;\n            hideHover(true, true);\n        }, true);\n        const mouseUpEmitter = addDisposableListener(htmlElement, EventType.MOUSE_UP, () => {\n            isMouseDown = false;\n        }, true);\n        const mouseLeaveEmitter = addDisposableListener(htmlElement, EventType.MOUSE_LEAVE, (e) => {\n            isMouseDown = false;\n            hideHover(false, e.fromElement === htmlElement);\n        }, true);\n        const onMouseOver = (e) => {\n            if (hoverPreparation) {\n                return;\n            }\n            const toDispose = new DisposableStore();\n            const target = {\n                targetElements: [htmlElement],\n                dispose: () => { }\n            };\n            if (hoverDelegate.placement === undefined || hoverDelegate.placement === 'mouse') {\n                // track the mouse position\n                const onMouseMove = (e) => {\n                    target.x = e.x + 10;\n                    if ((isHTMLElement(e.target)) && getHoverTargetElement(e.target, htmlElement) !== htmlElement) {\n                        hideHover(true, true);\n                    }\n                };\n                toDispose.add(addDisposableListener(htmlElement, EventType.MOUSE_MOVE, onMouseMove, true));\n            }\n            hoverPreparation = toDispose;\n            if ((isHTMLElement(e.target)) && getHoverTargetElement(e.target, htmlElement) !== htmlElement) {\n                return; // Do not show hover when the mouse is over another hover target\n            }\n            toDispose.add(triggerShowHover(hoverDelegate.delay, false, target));\n        };\n        const mouseOverDomEmitter = addDisposableListener(htmlElement, EventType.MOUSE_OVER, onMouseOver, true);\n        const onFocus = () => {\n            if (isMouseDown || hoverPreparation) {\n                return;\n            }\n            const target = {\n                targetElements: [htmlElement],\n                dispose: () => { }\n            };\n            const toDispose = new DisposableStore();\n            const onBlur = () => hideHover(true, true);\n            toDispose.add(addDisposableListener(htmlElement, EventType.BLUR, onBlur, true));\n            toDispose.add(triggerShowHover(hoverDelegate.delay, false, target));\n            hoverPreparation = toDispose;\n        };\n        // Do not show hover when focusing an input or textarea\n        let focusDomEmitter;\n        const tagName = htmlElement.tagName.toLowerCase();\n        if (tagName !== 'input' && tagName !== 'textarea') {\n            focusDomEmitter = addDisposableListener(htmlElement, EventType.FOCUS, onFocus, true);\n        }\n        const hover = {\n            show: focus => {\n                hideHover(false, true); // terminate a ongoing mouse over preparation\n                triggerShowHover(0, focus, undefined, focus); // show hover immediately\n            },\n            hide: () => {\n                hideHover(true, true);\n            },\n            update: async (newContent, hoverOptions) => {\n                content = newContent;\n                await (hoverWidget === null || hoverWidget === void 0 ? void 0 : hoverWidget.update(content, undefined, hoverOptions));\n            },\n            dispose: () => {\n                this._existingHovers.delete(htmlElement);\n                mouseOverDomEmitter.dispose();\n                mouseLeaveEmitter.dispose();\n                mouseDownEmitter.dispose();\n                mouseUpEmitter.dispose();\n                focusDomEmitter === null || focusDomEmitter === void 0 ? void 0 : focusDomEmitter.dispose();\n                hideHover(true, true);\n            }\n        };\n        this._existingHovers.set(htmlElement, hover);\n        return hover;\n    }\n    triggerUpdatableHover(target) {\n        const hover = this._existingHovers.get(target);\n        if (hover) {\n            hover.show(true);\n        }\n    }\n    dispose() {\n        this._existingHovers.forEach(hover => hover.dispose());\n        super.dispose();\n    }\n};\nHoverService = __decorate([\n    __param(0, IInstantiationService),\n    __param(1, IContextMenuService),\n    __param(2, IKeybindingService),\n    __param(3, ILayoutService),\n    __param(4, IAccessibilityService)\n], HoverService);\nexport { HoverService };\nfunction getHoverOptionsIdentity(options) {\n    var _a;\n    if (options === undefined) {\n        return undefined;\n    }\n    return (_a = options === null || options === void 0 ? void 0 : options.id) !== null && _a !== void 0 ? _a : options;\n}\nclass HoverContextViewDelegate {\n    get anchorPosition() {\n        return this._hover.anchor;\n    }\n    constructor(_hover, _focus = false) {\n        this._hover = _hover;\n        this._focus = _focus;\n        // Render over all other context views\n        this.layer = 1;\n    }\n    render(container) {\n        this._hover.render(container);\n        if (this._focus) {\n            this._hover.focus();\n        }\n        return this._hover;\n    }\n    getAnchor() {\n        return {\n            x: this._hover.x,\n            y: this._hover.y\n        };\n    }\n    layout() {\n        this._hover.layout();\n    }\n}\nfunction getHoverTargetElement(element, stopElement) {\n    stopElement = stopElement !== null && stopElement !== void 0 ? stopElement : getWindow(element).document.body;\n    while (!element.hasAttribute('custom-hover') && element !== stopElement) {\n        element = element.parentElement;\n    }\n    return element;\n}\nregisterSingleton(IHoverService, HoverService, 1 /* InstantiationType.Delayed */);\nregisterThemingParticipant((theme, collector) => {\n    const hoverBorder = theme.getColor(editorHoverBorder);\n    if (hoverBorder) {\n        collector.addRule(`.monaco-workbench .workbench-hover .hover-row:not(:first-child):not(:empty) { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n        collector.addRule(`.monaco-workbench .workbench-hover hr { border-top: 1px solid ${hoverBorder.transparent(0.5)}; }`);\n    }\n});\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA,IAAIA,UAAU,GAAI,IAAI,IAAI,IAAI,CAACA,UAAU,IAAK,UAAUC,UAAU,EAAEC,MAAM,EAAEC,GAAG,EAAEC,IAAI,EAAE;EACnF,IAAIC,CAAC,GAAGC,SAAS,CAACC,MAAM;IAAEC,CAAC,GAAGH,CAAC,GAAG,CAAC,GAAGH,MAAM,GAAGE,IAAI,KAAK,IAAI,GAAGA,IAAI,GAAGK,MAAM,CAACC,wBAAwB,CAACR,MAAM,EAAEC,GAAG,CAAC,GAAGC,IAAI;IAAEO,CAAC;EAC5H,IAAI,OAAOC,OAAO,KAAK,QAAQ,IAAI,OAAOA,OAAO,CAACC,QAAQ,KAAK,UAAU,EAAEL,CAAC,GAAGI,OAAO,CAACC,QAAQ,CAACZ,UAAU,EAAEC,MAAM,EAAEC,GAAG,EAAEC,IAAI,CAAC,CAAC,KAC1H,KAAK,IAAIU,CAAC,GAAGb,UAAU,CAACM,MAAM,GAAG,CAAC,EAAEO,CAAC,IAAI,CAAC,EAAEA,CAAC,EAAE,EAAE,IAAIH,CAAC,GAAGV,UAAU,CAACa,CAAC,CAAC,EAAEN,CAAC,GAAG,CAACH,CAAC,GAAG,CAAC,GAAGM,CAAC,CAACH,CAAC,CAAC,GAAGH,CAAC,GAAG,CAAC,GAAGM,CAAC,CAACT,MAAM,EAAEC,GAAG,EAAEK,CAAC,CAAC,GAAGG,CAAC,CAACT,MAAM,EAAEC,GAAG,CAAC,KAAKK,CAAC;EACjJ,OAAOH,CAAC,GAAG,CAAC,IAAIG,CAAC,IAAIC,MAAM,CAACM,cAAc,CAACb,MAAM,EAAEC,GAAG,EAAEK,CAAC,CAAC,EAAEA,CAAC;AACjE,CAAC;AACD,IAAIQ,OAAO,GAAI,IAAI,IAAI,IAAI,CAACA,OAAO,IAAK,UAAUC,UAAU,EAAEC,SAAS,EAAE;EACrE,OAAO,UAAUhB,MAAM,EAAEC,GAAG,EAAE;IAAEe,SAAS,CAAChB,MAAM,EAAEC,GAAG,EAAEc,UAAU,CAAC;EAAE,CAAC;AACzE,CAAC;AACD,SAASE,iBAAiB,QAAQ,yDAAyD;AAC3F,SAASC,0BAA0B,QAAQ,mDAAmD;AAC9F,SAASC,iBAAiB,QAAQ,oDAAoD;AACtF,SAASC,aAAa,QAAQ,6CAA6C;AAC3E,SAASC,mBAAmB,QAAQ,yDAAyD;AAC7F,SAASC,qBAAqB,QAAQ,4DAA4D;AAClG,SAASC,WAAW,QAAQ,kBAAkB;AAC9C,SAASC,UAAU,EAAEC,eAAe,EAAEC,YAAY,QAAQ,sCAAsC;AAChG,SAASC,qBAAqB,EAAEC,SAAS,EAAEC,gBAAgB,EAAEC,yBAAyB,EAAEC,UAAU,EAAEC,SAAS,EAAEC,aAAa,QAAQ,iCAAiC;AACrK,SAASC,kBAAkB,QAAQ,sDAAsD;AACzF,SAASC,qBAAqB,QAAQ,2CAA2C;AACjF,SAASC,qBAAqB,QAAQ,4DAA4D;AAClG,SAASC,cAAc,QAAQ,sDAAsD;AACrF,SAASC,UAAU,QAAQ,oCAAoC;AAC/D,SAASC,kBAAkB,QAAQ,gEAAgE;AACnG,SAASC,oBAAoB,QAAQ,2BAA2B;AAChE,SAASC,YAAY,QAAQ,kCAAkC;AAC/D,IAAIC,YAAY,GAAG,MAAMA,YAAY,SAASlB,UAAU,CAAC;EACrDmB,WAAWA,CAACC,qBAAqB,EAAEC,kBAAkB,EAAEC,kBAAkB,EAAEC,cAAc,EAAEC,qBAAqB,EAAE;IAC9G,KAAK,CAAC,CAAC;IACP,IAAI,CAACJ,qBAAqB,GAAGA,qBAAqB;IAClD,IAAI,CAACE,kBAAkB,GAAGA,kBAAkB;IAC5C,IAAI,CAACC,cAAc,GAAGA,cAAc;IACpC,IAAI,CAACC,qBAAqB,GAAGA,qBAAqB;IAClD,IAAI,CAACC,eAAe,GAAG,IAAIC,GAAG,CAAC,CAAC;IAChCL,kBAAkB,CAACM,oBAAoB,CAAC,MAAM,IAAI,CAACC,SAAS,CAAC,CAAC,CAAC;IAC/D,IAAI,CAACC,mBAAmB,GAAG,IAAI,CAACC,SAAS,CAAC,IAAIf,kBAAkB,CAAC,IAAI,CAACQ,cAAc,CAAC,CAAC;EAC1F;EACAQ,SAASA,CAACC,OAAO,EAAEC,KAAK,EAAEC,qBAAqB,EAAE;IAC7C,IAAIC,EAAE,EAAEC,EAAE,EAAEC,EAAE,EAAEC,EAAE;IAClB,IAAIC,uBAAuB,CAAC,IAAI,CAACC,oBAAoB,CAAC,KAAKD,uBAAuB,CAACP,OAAO,CAAC,EAAE;MACzF,OAAOS,SAAS;IACpB;IACA,IAAI,IAAI,CAACC,aAAa,KAAK,CAACN,EAAE,GAAG,CAACD,EAAE,GAAG,IAAI,CAACK,oBAAoB,MAAM,IAAI,IAAIL,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACQ,WAAW,MAAM,IAAI,IAAIP,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACQ,MAAM,CAAC,EAAE;MACpK,OAAOH,SAAS;IACpB;IACA,IAAI,CAACD,oBAAoB,GAAGR,OAAO;IACnC,IAAI,CAACa,iBAAiB,GAAGb,OAAO;IAChC,MAAMc,SAAS,GAAGd,OAAO,CAACc,SAAS,IAAI,IAAI,CAACtB,qBAAqB,CAACuB,uBAAuB,CAAC,CAAC;IAC3F,MAAMC,aAAa,GAAG3C,gBAAgB,CAAC,CAAC;IACxC;IACA,IAAI,CAAC6B,qBAAqB,EAAE;MACxB,IAAIY,SAAS,IAAIE,aAAa,EAAE;QAC5B,IAAI,CAACA,aAAa,CAACC,SAAS,CAACC,QAAQ,CAAC,cAAc,CAAC,EAAE;UACnD,IAAI,CAACC,6BAA6B,GAAGH,aAAa;QACtD;MACJ,CAAC,MACI;QACD,IAAI,CAACG,6BAA6B,GAAGV,SAAS;MAClD;IACJ;IACA,MAAMW,gBAAgB,GAAG,IAAInD,eAAe,CAAC,CAAC;IAC9C,MAAMoD,KAAK,GAAG,IAAI,CAACjC,qBAAqB,CAACkC,cAAc,CAACvD,WAAW,EAAEiC,OAAO,CAAC;IAC7E,IAAI,CAACK,EAAE,GAAGL,OAAO,CAACW,WAAW,MAAM,IAAI,IAAIN,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACO,MAAM,EAAE;MAC3ES,KAAK,CAACE,QAAQ,GAAG,IAAI;IACzB;IACAF,KAAK,CAACG,SAAS,CAAC,MAAM;MAClB,IAAIrB,EAAE,EAAEC,EAAE;MACV,MAAMqB,eAAe,GAAG,CAAC,CAACtB,EAAE,GAAG,IAAI,CAACO,aAAa,MAAM,IAAI,IAAIP,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACuB,OAAO,KAAKpD,yBAAyB,CAAC,IAAI,CAACoC,aAAa,CAACgB,OAAO,CAAC;MAC5J,IAAID,eAAe,EAAE;QACjB;QACA,CAACrB,EAAE,GAAG,IAAI,CAACe,6BAA6B,MAAM,IAAI,IAAIf,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACH,KAAK,CAAC,CAAC;MAC7F;MACA;MACA;MACA,IAAI,IAAI,CAACO,oBAAoB,KAAKR,OAAO,EAAE;QACvC,IAAI,CAACQ,oBAAoB,GAAGC,SAAS;MACzC;MACAW,gBAAgB,CAACO,OAAO,CAAC,CAAC;IAC9B,CAAC,EAAElB,SAAS,EAAEW,gBAAgB,CAAC;IAC/B;IACA,IAAI,CAACpB,OAAO,CAAC4B,SAAS,EAAE;MACpB,MAAMC,aAAa,GAAGpD,aAAa,CAACuB,OAAO,CAACxD,MAAM,CAAC,GAAGwD,OAAO,CAACxD,MAAM,GAAGwD,OAAO,CAACxD,MAAM,CAACsF,cAAc,CAAC,CAAC,CAAC;MACvG9B,OAAO,CAAC4B,SAAS,GAAG,IAAI,CAACrC,cAAc,CAACwC,YAAY,CAACvD,SAAS,CAACqD,aAAa,CAAC,CAAC;IAClF;IACA,IAAI,CAAChC,mBAAmB,CAACmC,eAAe,CAAC,IAAIC,wBAAwB,CAACZ,KAAK,EAAEpB,KAAK,CAAC,EAAED,OAAO,CAAC4B,SAAS,CAAC;IACvGP,KAAK,CAACa,eAAe,CAAC,MAAM,IAAI,CAACrC,mBAAmB,CAACsC,MAAM,CAAC,CAAC,EAAE1B,SAAS,EAAEW,gBAAgB,CAAC;IAC3F,IAAI,CAACd,EAAE,GAAGN,OAAO,CAACW,WAAW,MAAM,IAAI,IAAIL,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACM,MAAM,EAAE;MAC3EQ,gBAAgB,CAACgB,GAAG,CAACjE,qBAAqB,CAACK,SAAS,CAACwB,OAAO,CAAC4B,SAAS,CAAC,CAACS,QAAQ,EAAEjE,SAAS,CAACkE,UAAU,EAAEC,CAAC,IAAI;QACzG,IAAI,CAAChE,UAAU,CAACgE,CAAC,CAAC/F,MAAM,EAAE6E,KAAK,CAACK,OAAO,CAAC,EAAE;UACtC,IAAI,CAACc,WAAW,CAAC,CAAC;QACtB;MACJ,CAAC,CAAC,CAAC;IACP,CAAC,MACI;MACD,IAAI,gBAAgB,IAAIxC,OAAO,CAACxD,MAAM,EAAE;QACpC,KAAK,MAAMiG,OAAO,IAAIzC,OAAO,CAACxD,MAAM,CAACsF,cAAc,EAAE;UACjDV,gBAAgB,CAACgB,GAAG,CAACjE,qBAAqB,CAACsE,OAAO,EAAErE,SAAS,CAACsE,KAAK,EAAE,MAAM,IAAI,CAAC9C,SAAS,CAAC,CAAC,CAAC,CAAC;QACjG;MACJ,CAAC,MACI;QACDwB,gBAAgB,CAACgB,GAAG,CAACjE,qBAAqB,CAAC6B,OAAO,CAACxD,MAAM,EAAE4B,SAAS,CAACsE,KAAK,EAAE,MAAM,IAAI,CAAC9C,SAAS,CAAC,CAAC,CAAC,CAAC;MACxG;MACA,MAAM+C,cAAc,GAAGtE,gBAAgB,CAAC,CAAC;MACzC,IAAIsE,cAAc,EAAE;QAChB,MAAMC,sBAAsB,GAAGpE,SAAS,CAACmE,cAAc,CAAC,CAACN,QAAQ;QACjEjB,gBAAgB,CAACgB,GAAG,CAACjE,qBAAqB,CAACwE,cAAc,EAAEvE,SAAS,CAACyE,QAAQ,EAAEN,CAAC,IAAI;UAAE,IAAIpC,EAAE;UAAE,OAAO,IAAI,CAAC2C,QAAQ,CAACP,CAAC,EAAElB,KAAK,EAAE,CAAC,EAAE,CAAClB,EAAE,GAAGH,OAAO,CAACW,WAAW,MAAM,IAAI,IAAIR,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAAC4C,aAAa,CAAC,CAAC;QAAE,CAAC,CAAC,CAAC;QACvN3B,gBAAgB,CAACgB,GAAG,CAACjE,qBAAqB,CAACyE,sBAAsB,EAAExE,SAAS,CAACyE,QAAQ,EAAEN,CAAC,IAAI;UAAE,IAAIpC,EAAE;UAAE,OAAO,IAAI,CAAC2C,QAAQ,CAACP,CAAC,EAAElB,KAAK,EAAE,CAAC,EAAE,CAAClB,EAAE,GAAGH,OAAO,CAACW,WAAW,MAAM,IAAI,IAAIR,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAAC4C,aAAa,CAAC,CAAC;QAAE,CAAC,CAAC,CAAC;QAC/N3B,gBAAgB,CAACgB,GAAG,CAACjE,qBAAqB,CAACwE,cAAc,EAAEvE,SAAS,CAAC4E,MAAM,EAAET,CAAC,IAAI,IAAI,CAACU,MAAM,CAACV,CAAC,EAAElB,KAAK,CAAC,CAAC,CAAC;QACzGD,gBAAgB,CAACgB,GAAG,CAACjE,qBAAqB,CAACyE,sBAAsB,EAAExE,SAAS,CAAC4E,MAAM,EAAET,CAAC,IAAI,IAAI,CAACU,MAAM,CAACV,CAAC,EAAElB,KAAK,CAAC,CAAC,CAAC;MACrH;IACJ;IACA,IAAI,sBAAsB,IAAIvC,UAAU,EAAE;MACtC,MAAMoE,QAAQ,GAAG,IAAIC,oBAAoB,CAACZ,CAAC,IAAI,IAAI,CAACa,mBAAmB,CAACb,CAAC,EAAElB,KAAK,CAAC,EAAE;QAAEgC,SAAS,EAAE;MAAE,CAAC,CAAC;MACpG,MAAMC,kBAAkB,GAAG,gBAAgB,IAAItD,OAAO,CAACxD,MAAM,GAAGwD,OAAO,CAACxD,MAAM,CAACsF,cAAc,CAAC,CAAC,CAAC,GAAG9B,OAAO,CAACxD,MAAM;MACjH0G,QAAQ,CAACK,OAAO,CAACD,kBAAkB,CAAC;MACpClC,gBAAgB,CAACgB,GAAG,CAAClE,YAAY,CAAC,MAAMgF,QAAQ,CAACM,UAAU,CAAC,CAAC,CAAC,CAAC;IACnE;IACA,IAAI,CAAC9C,aAAa,GAAGW,KAAK;IAC1B,OAAOA,KAAK;EAChB;EACAzB,SAASA,CAAA,EAAG;IACR,IAAIO,EAAE;IACN,IAAI,CAAC,CAACA,EAAE,GAAG,IAAI,CAACO,aAAa,MAAM,IAAI,IAAIP,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACoB,QAAQ,KAAK,CAAC,IAAI,CAACf,oBAAoB,EAAE;MAC5G;IACJ;IACA,IAAI,CAACgC,WAAW,CAAC,CAAC;EACtB;EACAA,WAAWA,CAAA,EAAG;IACV,IAAI,CAAC9B,aAAa,GAAGD,SAAS;IAC9B,IAAI,CAACD,oBAAoB,GAAGC,SAAS;IACrC,IAAI,CAACZ,mBAAmB,CAAC4D,eAAe,CAAC,CAAC;EAC9C;EACAL,mBAAmBA,CAACM,OAAO,EAAErC,KAAK,EAAE;IAChC,MAAMsC,KAAK,GAAGD,OAAO,CAACA,OAAO,CAAC7G,MAAM,GAAG,CAAC,CAAC;IACzC,IAAI,CAAC8G,KAAK,CAACC,cAAc,EAAE;MACvBvC,KAAK,CAACM,OAAO,CAAC,CAAC;IACnB;EACJ;EACAkC,qBAAqBA,CAAA,EAAG;IACpB,IAAI,CAAC,IAAI,CAAChD,iBAAiB,EAAE;MACzB;IACJ;IACA,IAAI,CAACd,SAAS,CAAC,IAAI,CAACc,iBAAiB,EAAE,IAAI,EAAE,IAAI,CAAC;EACtD;EACAiC,QAAQA,CAACP,CAAC,EAAElB,KAAK,EAAE0B,aAAa,EAAE;IAC9B,IAAI5C,EAAE,EAAEC,EAAE;IACV,IAAImC,CAAC,CAAC9F,GAAG,KAAK,KAAK,EAAE;MACjB4E,KAAK,CAACE,QAAQ,GAAG,IAAI;MACrB;IACJ;IACA,MAAMuC,KAAK,GAAG,IAAInF,qBAAqB,CAAC4D,CAAC,CAAC;IAC1C,MAAMwB,UAAU,GAAG,IAAI,CAACzE,kBAAkB,CAAC0E,oBAAoB,CAACF,KAAK,CAAC;IACtE,IAAIC,UAAU,CAACE,+BAA+B,CAAC,CAAC,CAACC,IAAI,CAACC,KAAK,IAAI,CAAC,CAACA,KAAK,CAAC,IAAI,IAAI,CAAC7E,kBAAkB,CAAC8E,YAAY,CAACN,KAAK,EAAEA,KAAK,CAACtH,MAAM,CAAC,CAAC6H,IAAI,KAAK,CAAC,CAAC,+BAA+B;MAC3K;IACJ;IACA,IAAItB,aAAa,KAAK,EAAE,CAAC5C,EAAE,GAAG,IAAI,CAACK,oBAAoB,MAAM,IAAI,IAAIL,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACW,SAAS,CAAC,IAAIyB,CAAC,CAAC9F,GAAG,KAAK,KAAK,CAAC,EAAE;MAC7H,IAAI,CAACmD,SAAS,CAAC,CAAC;MAChB,CAACQ,EAAE,GAAG,IAAI,CAACe,6BAA6B,MAAM,IAAI,IAAIf,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACH,KAAK,CAAC,CAAC;IAC7F;EACJ;EACAgD,MAAMA,CAACV,CAAC,EAAElB,KAAK,EAAE;IACb,IAAIlB,EAAE;IACN,IAAIoC,CAAC,CAAC9F,GAAG,KAAK,KAAK,EAAE;MACjB4E,KAAK,CAACE,QAAQ,GAAG,KAAK;MACtB;MACA,IAAI,CAACF,KAAK,CAACiD,SAAS,EAAE;QAClB,IAAI,CAAC1E,SAAS,CAAC,CAAC;QAChB,CAACO,EAAE,GAAG,IAAI,CAACgB,6BAA6B,MAAM,IAAI,IAAIhB,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACF,KAAK,CAAC,CAAC;MAC7F;IACJ;EACJ;EACA;EACA;EACAsE,mBAAmBA,CAACC,aAAa,EAAEC,WAAW,EAAEC,OAAO,EAAE1E,OAAO,EAAE;IAC9DyE,WAAW,CAACE,YAAY,CAAC,cAAc,EAAE,MAAM,CAAC;IAChD,IAAIF,WAAW,CAACG,KAAK,KAAK,EAAE,EAAE;MAC1BC,OAAO,CAACC,IAAI,CAAC,2HAA2H,CAAC;MACzID,OAAO,CAACE,KAAK,CAAC,cAAc,EAAEN,WAAW,CAACG,KAAK,CAAC;MAChDH,WAAW,CAACG,KAAK,GAAG,EAAE;IAC1B;IACA,IAAII,gBAAgB;IACpB,IAAIC,WAAW;IACf,MAAMrF,SAAS,GAAGA,CAACsF,aAAa,EAAEC,kBAAkB,KAAK;MACrD,IAAIhF,EAAE;MACN,MAAMiF,QAAQ,GAAGH,WAAW,KAAKxE,SAAS;MAC1C,IAAIyE,aAAa,EAAE;QACfD,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAACtD,OAAO,CAAC,CAAC;QAC/EsD,WAAW,GAAGxE,SAAS;MAC3B;MACA,IAAI0E,kBAAkB,EAAE;QACpBH,gBAAgB,KAAK,IAAI,IAAIA,gBAAgB,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,gBAAgB,CAACrD,OAAO,CAAC,CAAC;QAC9FqD,gBAAgB,GAAGvE,SAAS;MAChC;MACA,IAAI2E,QAAQ,EAAE;QACV,CAACjF,EAAE,GAAGqE,aAAa,CAACa,cAAc,MAAM,IAAI,IAAIlF,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACmF,IAAI,CAACd,aAAa,CAAC;QAC/FS,WAAW,GAAGxE,SAAS;MAC3B;IACJ,CAAC;IACD,MAAM8E,gBAAgB,GAAGA,CAACC,KAAK,EAAEvF,KAAK,EAAEzD,MAAM,EAAEsE,SAAS,KAAK;MAC1D,OAAO,IAAI7B,YAAY,CAAC,YAAY;QAChC,IAAI,CAACgG,WAAW,IAAIA,WAAW,CAACQ,UAAU,EAAE;UACxCR,WAAW,GAAG,IAAIjG,oBAAoB,CAACwF,aAAa,EAAEhI,MAAM,IAAIiI,WAAW,EAAEe,KAAK,GAAG,CAAC,CAAC;UACvF,MAAMP,WAAW,CAACS,MAAM,CAAC,OAAOhB,OAAO,KAAK,UAAU,GAAGA,OAAO,CAAC,CAAC,GAAGA,OAAO,EAAEzE,KAAK,EAAE;YAAE,GAAGD,OAAO;YAAEc;UAAU,CAAC,CAAC;QACnH;MACJ,CAAC,EAAE0E,KAAK,CAAC;IACb,CAAC;IACD,IAAIG,WAAW,GAAG,KAAK;IACvB,MAAMC,gBAAgB,GAAGzH,qBAAqB,CAACsG,WAAW,EAAErG,SAAS,CAACkE,UAAU,EAAE,MAAM;MACpFqD,WAAW,GAAG,IAAI;MAClB/F,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC;IACzB,CAAC,EAAE,IAAI,CAAC;IACR,MAAMiG,cAAc,GAAG1H,qBAAqB,CAACsG,WAAW,EAAErG,SAAS,CAAC0H,QAAQ,EAAE,MAAM;MAChFH,WAAW,GAAG,KAAK;IACvB,CAAC,EAAE,IAAI,CAAC;IACR,MAAMI,iBAAiB,GAAG5H,qBAAqB,CAACsG,WAAW,EAAErG,SAAS,CAAC4H,WAAW,EAAGzD,CAAC,IAAK;MACvFoD,WAAW,GAAG,KAAK;MACnB/F,SAAS,CAAC,KAAK,EAAE2C,CAAC,CAAC0D,WAAW,KAAKxB,WAAW,CAAC;IACnD,CAAC,EAAE,IAAI,CAAC;IACR,MAAMyB,WAAW,GAAI3D,CAAC,IAAK;MACvB,IAAIyC,gBAAgB,EAAE;QAClB;MACJ;MACA,MAAMmB,SAAS,GAAG,IAAIlI,eAAe,CAAC,CAAC;MACvC,MAAMzB,MAAM,GAAG;QACXsF,cAAc,EAAE,CAAC2C,WAAW,CAAC;QAC7B9C,OAAO,EAAEA,CAAA,KAAM,CAAE;MACrB,CAAC;MACD,IAAI6C,aAAa,CAAC4B,SAAS,KAAK3F,SAAS,IAAI+D,aAAa,CAAC4B,SAAS,KAAK,OAAO,EAAE;QAC9E;QACA,MAAMC,WAAW,GAAI9D,CAAC,IAAK;UACvB/F,MAAM,CAAC8J,CAAC,GAAG/D,CAAC,CAAC+D,CAAC,GAAG,EAAE;UACnB,IAAK7H,aAAa,CAAC8D,CAAC,CAAC/F,MAAM,CAAC,IAAK+J,qBAAqB,CAAChE,CAAC,CAAC/F,MAAM,EAAEiI,WAAW,CAAC,KAAKA,WAAW,EAAE;YAC3F7E,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC;UACzB;QACJ,CAAC;QACDuG,SAAS,CAAC/D,GAAG,CAACjE,qBAAqB,CAACsG,WAAW,EAAErG,SAAS,CAACoI,UAAU,EAAEH,WAAW,EAAE,IAAI,CAAC,CAAC;MAC9F;MACArB,gBAAgB,GAAGmB,SAAS;MAC5B,IAAK1H,aAAa,CAAC8D,CAAC,CAAC/F,MAAM,CAAC,IAAK+J,qBAAqB,CAAChE,CAAC,CAAC/F,MAAM,EAAEiI,WAAW,CAAC,KAAKA,WAAW,EAAE;QAC3F,OAAO,CAAC;MACZ;MACA0B,SAAS,CAAC/D,GAAG,CAACmD,gBAAgB,CAACf,aAAa,CAACgB,KAAK,EAAE,KAAK,EAAEhJ,MAAM,CAAC,CAAC;IACvE,CAAC;IACD,MAAMiK,mBAAmB,GAAGtI,qBAAqB,CAACsG,WAAW,EAAErG,SAAS,CAACsI,UAAU,EAAER,WAAW,EAAE,IAAI,CAAC;IACvG,MAAMS,OAAO,GAAGA,CAAA,KAAM;MAClB,IAAIhB,WAAW,IAAIX,gBAAgB,EAAE;QACjC;MACJ;MACA,MAAMxI,MAAM,GAAG;QACXsF,cAAc,EAAE,CAAC2C,WAAW,CAAC;QAC7B9C,OAAO,EAAEA,CAAA,KAAM,CAAE;MACrB,CAAC;MACD,MAAMwE,SAAS,GAAG,IAAIlI,eAAe,CAAC,CAAC;MACvC,MAAM2I,MAAM,GAAGA,CAAA,KAAMhH,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC;MAC1CuG,SAAS,CAAC/D,GAAG,CAACjE,qBAAqB,CAACsG,WAAW,EAAErG,SAAS,CAACyI,IAAI,EAAED,MAAM,EAAE,IAAI,CAAC,CAAC;MAC/ET,SAAS,CAAC/D,GAAG,CAACmD,gBAAgB,CAACf,aAAa,CAACgB,KAAK,EAAE,KAAK,EAAEhJ,MAAM,CAAC,CAAC;MACnEwI,gBAAgB,GAAGmB,SAAS;IAChC,CAAC;IACD;IACA,IAAIW,eAAe;IACnB,MAAMC,OAAO,GAAGtC,WAAW,CAACsC,OAAO,CAACC,WAAW,CAAC,CAAC;IACjD,IAAID,OAAO,KAAK,OAAO,IAAIA,OAAO,KAAK,UAAU,EAAE;MAC/CD,eAAe,GAAG3I,qBAAqB,CAACsG,WAAW,EAAErG,SAAS,CAAC6I,KAAK,EAAEN,OAAO,EAAE,IAAI,CAAC;IACxF;IACA,MAAMtF,KAAK,GAAG;MACV6F,IAAI,EAAEjH,KAAK,IAAI;QACXL,SAAS,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC;QACxB2F,gBAAgB,CAAC,CAAC,EAAEtF,KAAK,EAAEQ,SAAS,EAAER,KAAK,CAAC,CAAC,CAAC;MAClD,CAAC;MACDkH,IAAI,EAAEA,CAAA,KAAM;QACRvH,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC;MACzB,CAAC;MACD8F,MAAM,EAAE,MAAAA,CAAO0B,UAAU,EAAEC,YAAY,KAAK;QACxC3C,OAAO,GAAG0C,UAAU;QACpB,OAAOnC,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,WAAW,CAACS,MAAM,CAAChB,OAAO,EAAEjE,SAAS,EAAE4G,YAAY,CAAC,CAAC;MAC1H,CAAC;MACD1F,OAAO,EAAEA,CAAA,KAAM;QACX,IAAI,CAAClC,eAAe,CAAC6H,MAAM,CAAC7C,WAAW,CAAC;QACxCgC,mBAAmB,CAAC9E,OAAO,CAAC,CAAC;QAC7BoE,iBAAiB,CAACpE,OAAO,CAAC,CAAC;QAC3BiE,gBAAgB,CAACjE,OAAO,CAAC,CAAC;QAC1BkE,cAAc,CAAClE,OAAO,CAAC,CAAC;QACxBmF,eAAe,KAAK,IAAI,IAAIA,eAAe,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,eAAe,CAACnF,OAAO,CAAC,CAAC;QAC3F/B,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC;MACzB;IACJ,CAAC;IACD,IAAI,CAACH,eAAe,CAAC8H,GAAG,CAAC9C,WAAW,EAAEpD,KAAK,CAAC;IAC5C,OAAOA,KAAK;EAChB;EACAmG,qBAAqBA,CAAChL,MAAM,EAAE;IAC1B,MAAM6E,KAAK,GAAG,IAAI,CAAC5B,eAAe,CAACgI,GAAG,CAACjL,MAAM,CAAC;IAC9C,IAAI6E,KAAK,EAAE;MACPA,KAAK,CAAC6F,IAAI,CAAC,IAAI,CAAC;IACpB;EACJ;EACAvF,OAAOA,CAAA,EAAG;IACN,IAAI,CAAClC,eAAe,CAACiI,OAAO,CAACrG,KAAK,IAAIA,KAAK,CAACM,OAAO,CAAC,CAAC,CAAC;IACtD,KAAK,CAACA,OAAO,CAAC,CAAC;EACnB;AACJ,CAAC;AACDzC,YAAY,GAAG5C,UAAU,CAAC,CACtBgB,OAAO,CAAC,CAAC,EAAEQ,qBAAqB,CAAC,EACjCR,OAAO,CAAC,CAAC,EAAEO,mBAAmB,CAAC,EAC/BP,OAAO,CAAC,CAAC,EAAEoB,kBAAkB,CAAC,EAC9BpB,OAAO,CAAC,CAAC,EAAEuB,cAAc,CAAC,EAC1BvB,OAAO,CAAC,CAAC,EAAEsB,qBAAqB,CAAC,CACpC,EAAEM,YAAY,CAAC;AAChB,SAASA,YAAY;AACrB,SAASqB,uBAAuBA,CAACP,OAAO,EAAE;EACtC,IAAIG,EAAE;EACN,IAAIH,OAAO,KAAKS,SAAS,EAAE;IACvB,OAAOA,SAAS;EACpB;EACA,OAAO,CAACN,EAAE,GAAGH,OAAO,KAAK,IAAI,IAAIA,OAAO,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,OAAO,CAAC2H,EAAE,MAAM,IAAI,IAAIxH,EAAE,KAAK,KAAK,CAAC,GAAGA,EAAE,GAAGH,OAAO;AACvH;AACA,MAAMiC,wBAAwB,CAAC;EAC3B,IAAI2F,cAAcA,CAAA,EAAG;IACjB,OAAO,IAAI,CAACC,MAAM,CAACC,MAAM;EAC7B;EACA3I,WAAWA,CAAC0I,MAAM,EAAkB;IAAA,IAAhBE,MAAM,GAAAnL,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAA6D,SAAA,GAAA7D,SAAA,MAAG,KAAK;IAC9B,IAAI,CAACiL,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACE,MAAM,GAAGA,MAAM;IACpB;IACA,IAAI,CAACC,KAAK,GAAG,CAAC;EAClB;EACAC,MAAMA,CAACrG,SAAS,EAAE;IACd,IAAI,CAACiG,MAAM,CAACI,MAAM,CAACrG,SAAS,CAAC;IAC7B,IAAI,IAAI,CAACmG,MAAM,EAAE;MACb,IAAI,CAACF,MAAM,CAAC5H,KAAK,CAAC,CAAC;IACvB;IACA,OAAO,IAAI,CAAC4H,MAAM;EACtB;EACAK,SAASA,CAAA,EAAG;IACR,OAAO;MACH5B,CAAC,EAAE,IAAI,CAACuB,MAAM,CAACvB,CAAC;MAChB6B,CAAC,EAAE,IAAI,CAACN,MAAM,CAACM;IACnB,CAAC;EACL;EACAhG,MAAMA,CAAA,EAAG;IACL,IAAI,CAAC0F,MAAM,CAAC1F,MAAM,CAAC,CAAC;EACxB;AACJ;AACA,SAASoE,qBAAqBA,CAAC9D,OAAO,EAAE2F,WAAW,EAAE;EACjDA,WAAW,GAAGA,WAAW,KAAK,IAAI,IAAIA,WAAW,KAAK,KAAK,CAAC,GAAGA,WAAW,GAAG5J,SAAS,CAACiE,OAAO,CAAC,CAACJ,QAAQ,CAACgG,IAAI;EAC7G,OAAO,CAAC5F,OAAO,CAAC6F,YAAY,CAAC,cAAc,CAAC,IAAI7F,OAAO,KAAK2F,WAAW,EAAE;IACrE3F,OAAO,GAAGA,OAAO,CAAC8F,aAAa;EACnC;EACA,OAAO9F,OAAO;AAClB;AACAhF,iBAAiB,CAACG,aAAa,EAAEsB,YAAY,EAAE,CAAC,CAAC,+BAA+B,CAAC;AACjFxB,0BAA0B,CAAC,CAAC8K,KAAK,EAAEC,SAAS,KAAK;EAC7C,MAAMC,WAAW,GAAGF,KAAK,CAACG,QAAQ,CAAChL,iBAAiB,CAAC;EACrD,IAAI+K,WAAW,EAAE;IACbD,SAAS,CAACG,OAAO,CAAC,uGAAuGF,WAAW,CAACG,WAAW,CAAC,GAAG,CAAC,KAAK,CAAC;IAC3JJ,SAAS,CAACG,OAAO,CAAC,iEAAiEF,WAAW,CAACG,WAAW,CAAC,GAAG,CAAC,KAAK,CAAC;EACzH;AACJ,CAAC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}