{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as DOM from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { ActionViewItem, BaseActionViewItem } from './actionViewItems.js';\nimport { createInstantHoverDelegate } from '../hover/hoverDelegateFactory.js';\nimport { ActionRunner, Separator } from '../../../common/actions.js';\nimport { Emitter } from '../../../common/event.js';\nimport { Disposable, DisposableMap, DisposableStore, dispose } from '../../../common/lifecycle.js';\nimport * as types from '../../../common/types.js';\nimport './actionbar.css';\nexport class ActionBar extends Disposable {\n  constructor(container) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var _a, _b, _c, _d, _e, _f, _g;\n    super();\n    this._actionRunnerDisposables = this._register(new DisposableStore());\n    this.viewItemDisposables = this._register(new DisposableMap());\n    // Trigger Key Tracking\n    this.triggerKeyDown = false;\n    this.focusable = true;\n    this._onDidBlur = this._register(new Emitter());\n    this.onDidBlur = this._onDidBlur.event;\n    this._onDidCancel = this._register(new Emitter({\n      onWillAddFirstListener: () => this.cancelHasListener = true\n    }));\n    this.onDidCancel = this._onDidCancel.event;\n    this.cancelHasListener = false;\n    this._onDidRun = this._register(new Emitter());\n    this.onDidRun = this._onDidRun.event;\n    this._onWillRun = this._register(new Emitter());\n    this.onWillRun = this._onWillRun.event;\n    this.options = options;\n    this._context = (_a = options.context) !== null && _a !== void 0 ? _a : null;\n    this._orientation = (_b = this.options.orientation) !== null && _b !== void 0 ? _b : 0 /* ActionsOrientation.HORIZONTAL */;\n    this._triggerKeys = {\n      keyDown: (_d = (_c = this.options.triggerKeys) === null || _c === void 0 ? void 0 : _c.keyDown) !== null && _d !== void 0 ? _d : false,\n      keys: (_f = (_e = this.options.triggerKeys) === null || _e === void 0 ? void 0 : _e.keys) !== null && _f !== void 0 ? _f : [3 /* KeyCode.Enter */, 10 /* KeyCode.Space */]\n    };\n    this._hoverDelegate = (_g = options.hoverDelegate) !== null && _g !== void 0 ? _g : this._register(createInstantHoverDelegate());\n    if (this.options.actionRunner) {\n      this._actionRunner = this.options.actionRunner;\n    } else {\n      this._actionRunner = new ActionRunner();\n      this._actionRunnerDisposables.add(this._actionRunner);\n    }\n    this._actionRunnerDisposables.add(this._actionRunner.onDidRun(e => this._onDidRun.fire(e)));\n    this._actionRunnerDisposables.add(this._actionRunner.onWillRun(e => this._onWillRun.fire(e)));\n    this.viewItems = [];\n    this.focusedItem = undefined;\n    this.domNode = document.createElement('div');\n    this.domNode.className = 'monaco-action-bar';\n    let previousKeys;\n    let nextKeys;\n    switch (this._orientation) {\n      case 0 /* ActionsOrientation.HORIZONTAL */:\n        previousKeys = [15 /* KeyCode.LeftArrow */];\n        nextKeys = [17 /* KeyCode.RightArrow */];\n        break;\n      case 1 /* ActionsOrientation.VERTICAL */:\n        previousKeys = [16 /* KeyCode.UpArrow */];\n        nextKeys = [18 /* KeyCode.DownArrow */];\n        this.domNode.className += ' vertical';\n        break;\n    }\n    this._register(DOM.addDisposableListener(this.domNode, DOM.EventType.KEY_DOWN, e => {\n      const event = new StandardKeyboardEvent(e);\n      let eventHandled = true;\n      const focusedItem = typeof this.focusedItem === 'number' ? this.viewItems[this.focusedItem] : undefined;\n      if (previousKeys && (event.equals(previousKeys[0]) || event.equals(previousKeys[1]))) {\n        eventHandled = this.focusPrevious();\n      } else if (nextKeys && (event.equals(nextKeys[0]) || event.equals(nextKeys[1]))) {\n        eventHandled = this.focusNext();\n      } else if (event.equals(9 /* KeyCode.Escape */) && this.cancelHasListener) {\n        this._onDidCancel.fire();\n      } else if (event.equals(14 /* KeyCode.Home */)) {\n        eventHandled = this.focusFirst();\n      } else if (event.equals(13 /* KeyCode.End */)) {\n        eventHandled = this.focusLast();\n      } else if (event.equals(2 /* KeyCode.Tab */) && focusedItem instanceof BaseActionViewItem && focusedItem.trapsArrowNavigation) {\n        eventHandled = this.focusNext();\n      } else if (this.isTriggerKeyEvent(event)) {\n        // Staying out of the else branch even if not triggered\n        if (this._triggerKeys.keyDown) {\n          this.doTrigger(event);\n        } else {\n          this.triggerKeyDown = true;\n        }\n      } else {\n        eventHandled = false;\n      }\n      if (eventHandled) {\n        event.preventDefault();\n        event.stopPropagation();\n      }\n    }));\n    this._register(DOM.addDisposableListener(this.domNode, DOM.EventType.KEY_UP, e => {\n      const event = new StandardKeyboardEvent(e);\n      // Run action on Enter/Space\n      if (this.isTriggerKeyEvent(event)) {\n        if (!this._triggerKeys.keyDown && this.triggerKeyDown) {\n          this.triggerKeyDown = false;\n          this.doTrigger(event);\n        }\n        event.preventDefault();\n        event.stopPropagation();\n      }\n      // Recompute focused item\n      else if (event.equals(2 /* KeyCode.Tab */) || event.equals(1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */) || event.equals(16 /* KeyCode.UpArrow */) || event.equals(18 /* KeyCode.DownArrow */) || event.equals(15 /* KeyCode.LeftArrow */) || event.equals(17 /* KeyCode.RightArrow */)) {\n        this.updateFocusedItem();\n      }\n    }));\n    this.focusTracker = this._register(DOM.trackFocus(this.domNode));\n    this._register(this.focusTracker.onDidBlur(() => {\n      if (DOM.getActiveElement() === this.domNode || !DOM.isAncestor(DOM.getActiveElement(), this.domNode)) {\n        this._onDidBlur.fire();\n        this.previouslyFocusedItem = this.focusedItem;\n        this.focusedItem = undefined;\n        this.triggerKeyDown = false;\n      }\n    }));\n    this._register(this.focusTracker.onDidFocus(() => this.updateFocusedItem()));\n    this.actionsList = document.createElement('ul');\n    this.actionsList.className = 'actions-container';\n    if (this.options.highlightToggledItems) {\n      this.actionsList.classList.add('highlight-toggled');\n    }\n    this.actionsList.setAttribute('role', this.options.ariaRole || 'toolbar');\n    if (this.options.ariaLabel) {\n      this.actionsList.setAttribute('aria-label', this.options.ariaLabel);\n    }\n    this.domNode.appendChild(this.actionsList);\n    container.appendChild(this.domNode);\n  }\n  refreshRole() {\n    if (this.length() >= 1) {\n      this.actionsList.setAttribute('role', this.options.ariaRole || 'toolbar');\n    } else {\n      this.actionsList.setAttribute('role', 'presentation');\n    }\n  }\n  // Some action bars should not be focusable at times\n  // When an action bar is not focusable make sure to make all the elements inside it not focusable\n  // When an action bar is focusable again, make sure the first item can be focused\n  setFocusable(focusable) {\n    this.focusable = focusable;\n    if (this.focusable) {\n      const firstEnabled = this.viewItems.find(vi => vi instanceof BaseActionViewItem && vi.isEnabled());\n      if (firstEnabled instanceof BaseActionViewItem) {\n        firstEnabled.setFocusable(true);\n      }\n    } else {\n      this.viewItems.forEach(vi => {\n        if (vi instanceof BaseActionViewItem) {\n          vi.setFocusable(false);\n        }\n      });\n    }\n  }\n  isTriggerKeyEvent(event) {\n    let ret = false;\n    this._triggerKeys.keys.forEach(keyCode => {\n      ret = ret || event.equals(keyCode);\n    });\n    return ret;\n  }\n  updateFocusedItem() {\n    var _a, _b;\n    for (let i = 0; i < this.actionsList.children.length; i++) {\n      const elem = this.actionsList.children[i];\n      if (DOM.isAncestor(DOM.getActiveElement(), elem)) {\n        this.focusedItem = i;\n        (_b = (_a = this.viewItems[this.focusedItem]) === null || _a === void 0 ? void 0 : _a.showHover) === null || _b === void 0 ? void 0 : _b.call(_a);\n        break;\n      }\n    }\n  }\n  get context() {\n    return this._context;\n  }\n  set context(context) {\n    this._context = context;\n    this.viewItems.forEach(i => i.setActionContext(context));\n  }\n  get actionRunner() {\n    return this._actionRunner;\n  }\n  set actionRunner(actionRunner) {\n    this._actionRunner = actionRunner;\n    // when setting a new `IActionRunner` make sure to dispose old listeners and\n    // start to forward events from the new listener\n    this._actionRunnerDisposables.clear();\n    this._actionRunnerDisposables.add(this._actionRunner.onDidRun(e => this._onDidRun.fire(e)));\n    this._actionRunnerDisposables.add(this._actionRunner.onWillRun(e => this._onWillRun.fire(e)));\n    this.viewItems.forEach(item => item.actionRunner = actionRunner);\n  }\n  getContainer() {\n    return this.domNode;\n  }\n  getAction(indexOrElement) {\n    var _a;\n    // by index\n    if (typeof indexOrElement === 'number') {\n      return (_a = this.viewItems[indexOrElement]) === null || _a === void 0 ? void 0 : _a.action;\n    }\n    // by element\n    if (DOM.isHTMLElement(indexOrElement)) {\n      while (indexOrElement.parentElement !== this.actionsList) {\n        if (!indexOrElement.parentElement) {\n          return undefined;\n        }\n        indexOrElement = indexOrElement.parentElement;\n      }\n      for (let i = 0; i < this.actionsList.childNodes.length; i++) {\n        if (this.actionsList.childNodes[i] === indexOrElement) {\n          return this.viewItems[i].action;\n        }\n      }\n    }\n    return undefined;\n  }\n  push(arg) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const actions = Array.isArray(arg) ? arg : [arg];\n    let index = types.isNumber(options.index) ? options.index : null;\n    actions.forEach(action => {\n      const actionViewItemElement = document.createElement('li');\n      actionViewItemElement.className = 'action-item';\n      actionViewItemElement.setAttribute('role', 'presentation');\n      let item;\n      const viewItemOptions = {\n        hoverDelegate: this._hoverDelegate,\n        ...options\n      };\n      if (this.options.actionViewItemProvider) {\n        item = this.options.actionViewItemProvider(action, viewItemOptions);\n      }\n      if (!item) {\n        item = new ActionViewItem(this.context, action, viewItemOptions);\n      }\n      // Prevent native context menu on actions\n      if (!this.options.allowContextMenu) {\n        this.viewItemDisposables.set(item, DOM.addDisposableListener(actionViewItemElement, DOM.EventType.CONTEXT_MENU, e => {\n          DOM.EventHelper.stop(e, true);\n        }));\n      }\n      item.actionRunner = this._actionRunner;\n      item.setActionContext(this.context);\n      item.render(actionViewItemElement);\n      if (this.focusable && item instanceof BaseActionViewItem && this.viewItems.length === 0) {\n        // We need to allow for the first enabled item to be focused on using tab navigation #106441\n        item.setFocusable(true);\n      }\n      if (index === null || index < 0 || index >= this.actionsList.children.length) {\n        this.actionsList.appendChild(actionViewItemElement);\n        this.viewItems.push(item);\n      } else {\n        this.actionsList.insertBefore(actionViewItemElement, this.actionsList.children[index]);\n        this.viewItems.splice(index, 0, item);\n        index++;\n      }\n    });\n    if (typeof this.focusedItem === 'number') {\n      // After a clear actions might be re-added to simply toggle some actions. We should preserve focus #97128\n      this.focus(this.focusedItem);\n    }\n    this.refreshRole();\n  }\n  clear() {\n    if (this.isEmpty()) {\n      return;\n    }\n    this.viewItems = dispose(this.viewItems);\n    this.viewItemDisposables.clearAndDisposeAll();\n    DOM.clearNode(this.actionsList);\n    this.refreshRole();\n  }\n  length() {\n    return this.viewItems.length;\n  }\n  isEmpty() {\n    return this.viewItems.length === 0;\n  }\n  focus(arg) {\n    let selectFirst = false;\n    let index = undefined;\n    if (arg === undefined) {\n      selectFirst = true;\n    } else if (typeof arg === 'number') {\n      index = arg;\n    } else if (typeof arg === 'boolean') {\n      selectFirst = arg;\n    }\n    if (selectFirst && typeof this.focusedItem === 'undefined') {\n      const firstEnabled = this.viewItems.findIndex(item => item.isEnabled());\n      // Focus the first enabled item\n      this.focusedItem = firstEnabled === -1 ? undefined : firstEnabled;\n      this.updateFocus(undefined, undefined, true);\n    } else {\n      if (index !== undefined) {\n        this.focusedItem = index;\n      }\n      this.updateFocus(undefined, undefined, true);\n    }\n  }\n  focusFirst() {\n    this.focusedItem = this.length() - 1;\n    return this.focusNext(true);\n  }\n  focusLast() {\n    this.focusedItem = 0;\n    return this.focusPrevious(true);\n  }\n  focusNext(forceLoop) {\n    if (typeof this.focusedItem === 'undefined') {\n      this.focusedItem = this.viewItems.length - 1;\n    } else if (this.viewItems.length <= 1) {\n      return false;\n    }\n    const startIndex = this.focusedItem;\n    let item;\n    do {\n      if (!forceLoop && this.options.preventLoopNavigation && this.focusedItem + 1 >= this.viewItems.length) {\n        this.focusedItem = startIndex;\n        return false;\n      }\n      this.focusedItem = (this.focusedItem + 1) % this.viewItems.length;\n      item = this.viewItems[this.focusedItem];\n    } while (this.focusedItem !== startIndex && (this.options.focusOnlyEnabledItems && !item.isEnabled() || item.action.id === Separator.ID));\n    this.updateFocus();\n    return true;\n  }\n  focusPrevious(forceLoop) {\n    if (typeof this.focusedItem === 'undefined') {\n      this.focusedItem = 0;\n    } else if (this.viewItems.length <= 1) {\n      return false;\n    }\n    const startIndex = this.focusedItem;\n    let item;\n    do {\n      this.focusedItem = this.focusedItem - 1;\n      if (this.focusedItem < 0) {\n        if (!forceLoop && this.options.preventLoopNavigation) {\n          this.focusedItem = startIndex;\n          return false;\n        }\n        this.focusedItem = this.viewItems.length - 1;\n      }\n      item = this.viewItems[this.focusedItem];\n    } while (this.focusedItem !== startIndex && (this.options.focusOnlyEnabledItems && !item.isEnabled() || item.action.id === Separator.ID));\n    this.updateFocus(true);\n    return true;\n  }\n  updateFocus(fromRight, preventScroll) {\n    let forceFocus = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    var _a, _b;\n    if (typeof this.focusedItem === 'undefined') {\n      this.actionsList.focus({\n        preventScroll\n      });\n    }\n    if (this.previouslyFocusedItem !== undefined && this.previouslyFocusedItem !== this.focusedItem) {\n      (_a = this.viewItems[this.previouslyFocusedItem]) === null || _a === void 0 ? void 0 : _a.blur();\n    }\n    const actionViewItem = this.focusedItem !== undefined ? this.viewItems[this.focusedItem] : undefined;\n    if (actionViewItem) {\n      let focusItem = true;\n      if (!types.isFunction(actionViewItem.focus)) {\n        focusItem = false;\n      }\n      if (this.options.focusOnlyEnabledItems && types.isFunction(actionViewItem.isEnabled) && !actionViewItem.isEnabled()) {\n        focusItem = false;\n      }\n      if (actionViewItem.action.id === Separator.ID) {\n        focusItem = false;\n      }\n      if (!focusItem) {\n        this.actionsList.focus({\n          preventScroll\n        });\n        this.previouslyFocusedItem = undefined;\n      } else if (forceFocus || this.previouslyFocusedItem !== this.focusedItem) {\n        actionViewItem.focus(fromRight);\n        this.previouslyFocusedItem = this.focusedItem;\n      }\n      if (focusItem) {\n        (_b = actionViewItem.showHover) === null || _b === void 0 ? void 0 : _b.call(actionViewItem);\n      }\n    }\n  }\n  doTrigger(event) {\n    if (typeof this.focusedItem === 'undefined') {\n      return; //nothing to focus\n    }\n    // trigger action\n    const actionViewItem = this.viewItems[this.focusedItem];\n    if (actionViewItem instanceof BaseActionViewItem) {\n      const context = actionViewItem._context === null || actionViewItem._context === undefined ? event : actionViewItem._context;\n      this.run(actionViewItem._action, context);\n    }\n  }\n  async run(action, context) {\n    await this._actionRunner.run(action, context);\n  }\n  dispose() {\n    this._context = undefined;\n    this.viewItems = dispose(this.viewItems);\n    this.getContainer().remove();\n    super.dispose();\n  }\n}","map":{"version":3,"names":["DOM","StandardKeyboardEvent","ActionViewItem","BaseActionViewItem","createInstantHoverDelegate","ActionRunner","Separator","Emitter","Disposable","DisposableMap","DisposableStore","dispose","types","ActionBar","constructor","container","options","arguments","length","undefined","_a","_b","_c","_d","_e","_f","_g","_actionRunnerDisposables","_register","viewItemDisposables","triggerKeyDown","focusable","_onDidBlur","onDidBlur","event","_onDidCancel","onWillAddFirstListener","cancelHasListener","onDidCancel","_onDidRun","onDidRun","_onWillRun","onWillRun","_context","context","_orientation","orientation","_triggerKeys","keyDown","triggerKeys","keys","_hoverDelegate","hoverDelegate","actionRunner","_actionRunner","add","e","fire","viewItems","focusedItem","domNode","document","createElement","className","previousKeys","nextKeys","addDisposableListener","EventType","KEY_DOWN","eventHandled","equals","focusPrevious","focusNext","focusFirst","focusLast","trapsArrowNavigation","isTriggerKeyEvent","doTrigger","preventDefault","stopPropagation","KEY_UP","updateFocusedItem","focusTracker","trackFocus","getActiveElement","isAncestor","previouslyFocusedItem","onDidFocus","actionsList","highlightToggledItems","classList","setAttribute","ariaRole","ariaLabel","appendChild","refreshRole","setFocusable","firstEnabled","find","vi","isEnabled","forEach","ret","keyCode","i","children","elem","showHover","call","setActionContext","clear","item","getContainer","getAction","indexOrElement","action","isHTMLElement","parentElement","childNodes","push","arg","actions","Array","isArray","index","isNumber","actionViewItemElement","viewItemOptions","actionViewItemProvider","allowContextMenu","set","CONTEXT_MENU","EventHelper","stop","render","insertBefore","splice","focus","isEmpty","clearAndDisposeAll","clearNode","selectFirst","findIndex","updateFocus","forceLoop","startIndex","preventLoopNavigation","focusOnlyEnabledItems","id","ID","fromRight","preventScroll","forceFocus","blur","actionViewItem","focusItem","isFunction","run","_action","remove"],"sources":["/home/arslan/modojo/node_modules/monaco-editor/esm/vs/base/browser/ui/actionbar/actionbar.js"],"sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as DOM from '../../dom.js';\nimport { StandardKeyboardEvent } from '../../keyboardEvent.js';\nimport { ActionViewItem, BaseActionViewItem } from './actionViewItems.js';\nimport { createInstantHoverDelegate } from '../hover/hoverDelegateFactory.js';\nimport { ActionRunner, Separator } from '../../../common/actions.js';\nimport { Emitter } from '../../../common/event.js';\nimport { Disposable, DisposableMap, DisposableStore, dispose } from '../../../common/lifecycle.js';\nimport * as types from '../../../common/types.js';\nimport './actionbar.css';\nexport class ActionBar extends Disposable {\n    constructor(container, options = {}) {\n        var _a, _b, _c, _d, _e, _f, _g;\n        super();\n        this._actionRunnerDisposables = this._register(new DisposableStore());\n        this.viewItemDisposables = this._register(new DisposableMap());\n        // Trigger Key Tracking\n        this.triggerKeyDown = false;\n        this.focusable = true;\n        this._onDidBlur = this._register(new Emitter());\n        this.onDidBlur = this._onDidBlur.event;\n        this._onDidCancel = this._register(new Emitter({ onWillAddFirstListener: () => this.cancelHasListener = true }));\n        this.onDidCancel = this._onDidCancel.event;\n        this.cancelHasListener = false;\n        this._onDidRun = this._register(new Emitter());\n        this.onDidRun = this._onDidRun.event;\n        this._onWillRun = this._register(new Emitter());\n        this.onWillRun = this._onWillRun.event;\n        this.options = options;\n        this._context = (_a = options.context) !== null && _a !== void 0 ? _a : null;\n        this._orientation = (_b = this.options.orientation) !== null && _b !== void 0 ? _b : 0 /* ActionsOrientation.HORIZONTAL */;\n        this._triggerKeys = {\n            keyDown: (_d = (_c = this.options.triggerKeys) === null || _c === void 0 ? void 0 : _c.keyDown) !== null && _d !== void 0 ? _d : false,\n            keys: (_f = (_e = this.options.triggerKeys) === null || _e === void 0 ? void 0 : _e.keys) !== null && _f !== void 0 ? _f : [3 /* KeyCode.Enter */, 10 /* KeyCode.Space */]\n        };\n        this._hoverDelegate = (_g = options.hoverDelegate) !== null && _g !== void 0 ? _g : this._register(createInstantHoverDelegate());\n        if (this.options.actionRunner) {\n            this._actionRunner = this.options.actionRunner;\n        }\n        else {\n            this._actionRunner = new ActionRunner();\n            this._actionRunnerDisposables.add(this._actionRunner);\n        }\n        this._actionRunnerDisposables.add(this._actionRunner.onDidRun(e => this._onDidRun.fire(e)));\n        this._actionRunnerDisposables.add(this._actionRunner.onWillRun(e => this._onWillRun.fire(e)));\n        this.viewItems = [];\n        this.focusedItem = undefined;\n        this.domNode = document.createElement('div');\n        this.domNode.className = 'monaco-action-bar';\n        let previousKeys;\n        let nextKeys;\n        switch (this._orientation) {\n            case 0 /* ActionsOrientation.HORIZONTAL */:\n                previousKeys = [15 /* KeyCode.LeftArrow */];\n                nextKeys = [17 /* KeyCode.RightArrow */];\n                break;\n            case 1 /* ActionsOrientation.VERTICAL */:\n                previousKeys = [16 /* KeyCode.UpArrow */];\n                nextKeys = [18 /* KeyCode.DownArrow */];\n                this.domNode.className += ' vertical';\n                break;\n        }\n        this._register(DOM.addDisposableListener(this.domNode, DOM.EventType.KEY_DOWN, e => {\n            const event = new StandardKeyboardEvent(e);\n            let eventHandled = true;\n            const focusedItem = typeof this.focusedItem === 'number' ? this.viewItems[this.focusedItem] : undefined;\n            if (previousKeys && (event.equals(previousKeys[0]) || event.equals(previousKeys[1]))) {\n                eventHandled = this.focusPrevious();\n            }\n            else if (nextKeys && (event.equals(nextKeys[0]) || event.equals(nextKeys[1]))) {\n                eventHandled = this.focusNext();\n            }\n            else if (event.equals(9 /* KeyCode.Escape */) && this.cancelHasListener) {\n                this._onDidCancel.fire();\n            }\n            else if (event.equals(14 /* KeyCode.Home */)) {\n                eventHandled = this.focusFirst();\n            }\n            else if (event.equals(13 /* KeyCode.End */)) {\n                eventHandled = this.focusLast();\n            }\n            else if (event.equals(2 /* KeyCode.Tab */) && focusedItem instanceof BaseActionViewItem && focusedItem.trapsArrowNavigation) {\n                eventHandled = this.focusNext();\n            }\n            else if (this.isTriggerKeyEvent(event)) {\n                // Staying out of the else branch even if not triggered\n                if (this._triggerKeys.keyDown) {\n                    this.doTrigger(event);\n                }\n                else {\n                    this.triggerKeyDown = true;\n                }\n            }\n            else {\n                eventHandled = false;\n            }\n            if (eventHandled) {\n                event.preventDefault();\n                event.stopPropagation();\n            }\n        }));\n        this._register(DOM.addDisposableListener(this.domNode, DOM.EventType.KEY_UP, e => {\n            const event = new StandardKeyboardEvent(e);\n            // Run action on Enter/Space\n            if (this.isTriggerKeyEvent(event)) {\n                if (!this._triggerKeys.keyDown && this.triggerKeyDown) {\n                    this.triggerKeyDown = false;\n                    this.doTrigger(event);\n                }\n                event.preventDefault();\n                event.stopPropagation();\n            }\n            // Recompute focused item\n            else if (event.equals(2 /* KeyCode.Tab */) || event.equals(1024 /* KeyMod.Shift */ | 2 /* KeyCode.Tab */) || event.equals(16 /* KeyCode.UpArrow */) || event.equals(18 /* KeyCode.DownArrow */) || event.equals(15 /* KeyCode.LeftArrow */) || event.equals(17 /* KeyCode.RightArrow */)) {\n                this.updateFocusedItem();\n            }\n        }));\n        this.focusTracker = this._register(DOM.trackFocus(this.domNode));\n        this._register(this.focusTracker.onDidBlur(() => {\n            if (DOM.getActiveElement() === this.domNode || !DOM.isAncestor(DOM.getActiveElement(), this.domNode)) {\n                this._onDidBlur.fire();\n                this.previouslyFocusedItem = this.focusedItem;\n                this.focusedItem = undefined;\n                this.triggerKeyDown = false;\n            }\n        }));\n        this._register(this.focusTracker.onDidFocus(() => this.updateFocusedItem()));\n        this.actionsList = document.createElement('ul');\n        this.actionsList.className = 'actions-container';\n        if (this.options.highlightToggledItems) {\n            this.actionsList.classList.add('highlight-toggled');\n        }\n        this.actionsList.setAttribute('role', this.options.ariaRole || 'toolbar');\n        if (this.options.ariaLabel) {\n            this.actionsList.setAttribute('aria-label', this.options.ariaLabel);\n        }\n        this.domNode.appendChild(this.actionsList);\n        container.appendChild(this.domNode);\n    }\n    refreshRole() {\n        if (this.length() >= 1) {\n            this.actionsList.setAttribute('role', this.options.ariaRole || 'toolbar');\n        }\n        else {\n            this.actionsList.setAttribute('role', 'presentation');\n        }\n    }\n    // Some action bars should not be focusable at times\n    // When an action bar is not focusable make sure to make all the elements inside it not focusable\n    // When an action bar is focusable again, make sure the first item can be focused\n    setFocusable(focusable) {\n        this.focusable = focusable;\n        if (this.focusable) {\n            const firstEnabled = this.viewItems.find(vi => vi instanceof BaseActionViewItem && vi.isEnabled());\n            if (firstEnabled instanceof BaseActionViewItem) {\n                firstEnabled.setFocusable(true);\n            }\n        }\n        else {\n            this.viewItems.forEach(vi => {\n                if (vi instanceof BaseActionViewItem) {\n                    vi.setFocusable(false);\n                }\n            });\n        }\n    }\n    isTriggerKeyEvent(event) {\n        let ret = false;\n        this._triggerKeys.keys.forEach(keyCode => {\n            ret = ret || event.equals(keyCode);\n        });\n        return ret;\n    }\n    updateFocusedItem() {\n        var _a, _b;\n        for (let i = 0; i < this.actionsList.children.length; i++) {\n            const elem = this.actionsList.children[i];\n            if (DOM.isAncestor(DOM.getActiveElement(), elem)) {\n                this.focusedItem = i;\n                (_b = (_a = this.viewItems[this.focusedItem]) === null || _a === void 0 ? void 0 : _a.showHover) === null || _b === void 0 ? void 0 : _b.call(_a);\n                break;\n            }\n        }\n    }\n    get context() {\n        return this._context;\n    }\n    set context(context) {\n        this._context = context;\n        this.viewItems.forEach(i => i.setActionContext(context));\n    }\n    get actionRunner() {\n        return this._actionRunner;\n    }\n    set actionRunner(actionRunner) {\n        this._actionRunner = actionRunner;\n        // when setting a new `IActionRunner` make sure to dispose old listeners and\n        // start to forward events from the new listener\n        this._actionRunnerDisposables.clear();\n        this._actionRunnerDisposables.add(this._actionRunner.onDidRun(e => this._onDidRun.fire(e)));\n        this._actionRunnerDisposables.add(this._actionRunner.onWillRun(e => this._onWillRun.fire(e)));\n        this.viewItems.forEach(item => item.actionRunner = actionRunner);\n    }\n    getContainer() {\n        return this.domNode;\n    }\n    getAction(indexOrElement) {\n        var _a;\n        // by index\n        if (typeof indexOrElement === 'number') {\n            return (_a = this.viewItems[indexOrElement]) === null || _a === void 0 ? void 0 : _a.action;\n        }\n        // by element\n        if (DOM.isHTMLElement(indexOrElement)) {\n            while (indexOrElement.parentElement !== this.actionsList) {\n                if (!indexOrElement.parentElement) {\n                    return undefined;\n                }\n                indexOrElement = indexOrElement.parentElement;\n            }\n            for (let i = 0; i < this.actionsList.childNodes.length; i++) {\n                if (this.actionsList.childNodes[i] === indexOrElement) {\n                    return this.viewItems[i].action;\n                }\n            }\n        }\n        return undefined;\n    }\n    push(arg, options = {}) {\n        const actions = Array.isArray(arg) ? arg : [arg];\n        let index = types.isNumber(options.index) ? options.index : null;\n        actions.forEach((action) => {\n            const actionViewItemElement = document.createElement('li');\n            actionViewItemElement.className = 'action-item';\n            actionViewItemElement.setAttribute('role', 'presentation');\n            let item;\n            const viewItemOptions = { hoverDelegate: this._hoverDelegate, ...options };\n            if (this.options.actionViewItemProvider) {\n                item = this.options.actionViewItemProvider(action, viewItemOptions);\n            }\n            if (!item) {\n                item = new ActionViewItem(this.context, action, viewItemOptions);\n            }\n            // Prevent native context menu on actions\n            if (!this.options.allowContextMenu) {\n                this.viewItemDisposables.set(item, DOM.addDisposableListener(actionViewItemElement, DOM.EventType.CONTEXT_MENU, (e) => {\n                    DOM.EventHelper.stop(e, true);\n                }));\n            }\n            item.actionRunner = this._actionRunner;\n            item.setActionContext(this.context);\n            item.render(actionViewItemElement);\n            if (this.focusable && item instanceof BaseActionViewItem && this.viewItems.length === 0) {\n                // We need to allow for the first enabled item to be focused on using tab navigation #106441\n                item.setFocusable(true);\n            }\n            if (index === null || index < 0 || index >= this.actionsList.children.length) {\n                this.actionsList.appendChild(actionViewItemElement);\n                this.viewItems.push(item);\n            }\n            else {\n                this.actionsList.insertBefore(actionViewItemElement, this.actionsList.children[index]);\n                this.viewItems.splice(index, 0, item);\n                index++;\n            }\n        });\n        if (typeof this.focusedItem === 'number') {\n            // After a clear actions might be re-added to simply toggle some actions. We should preserve focus #97128\n            this.focus(this.focusedItem);\n        }\n        this.refreshRole();\n    }\n    clear() {\n        if (this.isEmpty()) {\n            return;\n        }\n        this.viewItems = dispose(this.viewItems);\n        this.viewItemDisposables.clearAndDisposeAll();\n        DOM.clearNode(this.actionsList);\n        this.refreshRole();\n    }\n    length() {\n        return this.viewItems.length;\n    }\n    isEmpty() {\n        return this.viewItems.length === 0;\n    }\n    focus(arg) {\n        let selectFirst = false;\n        let index = undefined;\n        if (arg === undefined) {\n            selectFirst = true;\n        }\n        else if (typeof arg === 'number') {\n            index = arg;\n        }\n        else if (typeof arg === 'boolean') {\n            selectFirst = arg;\n        }\n        if (selectFirst && typeof this.focusedItem === 'undefined') {\n            const firstEnabled = this.viewItems.findIndex(item => item.isEnabled());\n            // Focus the first enabled item\n            this.focusedItem = firstEnabled === -1 ? undefined : firstEnabled;\n            this.updateFocus(undefined, undefined, true);\n        }\n        else {\n            if (index !== undefined) {\n                this.focusedItem = index;\n            }\n            this.updateFocus(undefined, undefined, true);\n        }\n    }\n    focusFirst() {\n        this.focusedItem = this.length() - 1;\n        return this.focusNext(true);\n    }\n    focusLast() {\n        this.focusedItem = 0;\n        return this.focusPrevious(true);\n    }\n    focusNext(forceLoop) {\n        if (typeof this.focusedItem === 'undefined') {\n            this.focusedItem = this.viewItems.length - 1;\n        }\n        else if (this.viewItems.length <= 1) {\n            return false;\n        }\n        const startIndex = this.focusedItem;\n        let item;\n        do {\n            if (!forceLoop && this.options.preventLoopNavigation && this.focusedItem + 1 >= this.viewItems.length) {\n                this.focusedItem = startIndex;\n                return false;\n            }\n            this.focusedItem = (this.focusedItem + 1) % this.viewItems.length;\n            item = this.viewItems[this.focusedItem];\n        } while (this.focusedItem !== startIndex && ((this.options.focusOnlyEnabledItems && !item.isEnabled()) || item.action.id === Separator.ID));\n        this.updateFocus();\n        return true;\n    }\n    focusPrevious(forceLoop) {\n        if (typeof this.focusedItem === 'undefined') {\n            this.focusedItem = 0;\n        }\n        else if (this.viewItems.length <= 1) {\n            return false;\n        }\n        const startIndex = this.focusedItem;\n        let item;\n        do {\n            this.focusedItem = this.focusedItem - 1;\n            if (this.focusedItem < 0) {\n                if (!forceLoop && this.options.preventLoopNavigation) {\n                    this.focusedItem = startIndex;\n                    return false;\n                }\n                this.focusedItem = this.viewItems.length - 1;\n            }\n            item = this.viewItems[this.focusedItem];\n        } while (this.focusedItem !== startIndex && ((this.options.focusOnlyEnabledItems && !item.isEnabled()) || item.action.id === Separator.ID));\n        this.updateFocus(true);\n        return true;\n    }\n    updateFocus(fromRight, preventScroll, forceFocus = false) {\n        var _a, _b;\n        if (typeof this.focusedItem === 'undefined') {\n            this.actionsList.focus({ preventScroll });\n        }\n        if (this.previouslyFocusedItem !== undefined && this.previouslyFocusedItem !== this.focusedItem) {\n            (_a = this.viewItems[this.previouslyFocusedItem]) === null || _a === void 0 ? void 0 : _a.blur();\n        }\n        const actionViewItem = this.focusedItem !== undefined ? this.viewItems[this.focusedItem] : undefined;\n        if (actionViewItem) {\n            let focusItem = true;\n            if (!types.isFunction(actionViewItem.focus)) {\n                focusItem = false;\n            }\n            if (this.options.focusOnlyEnabledItems && types.isFunction(actionViewItem.isEnabled) && !actionViewItem.isEnabled()) {\n                focusItem = false;\n            }\n            if (actionViewItem.action.id === Separator.ID) {\n                focusItem = false;\n            }\n            if (!focusItem) {\n                this.actionsList.focus({ preventScroll });\n                this.previouslyFocusedItem = undefined;\n            }\n            else if (forceFocus || this.previouslyFocusedItem !== this.focusedItem) {\n                actionViewItem.focus(fromRight);\n                this.previouslyFocusedItem = this.focusedItem;\n            }\n            if (focusItem) {\n                (_b = actionViewItem.showHover) === null || _b === void 0 ? void 0 : _b.call(actionViewItem);\n            }\n        }\n    }\n    doTrigger(event) {\n        if (typeof this.focusedItem === 'undefined') {\n            return; //nothing to focus\n        }\n        // trigger action\n        const actionViewItem = this.viewItems[this.focusedItem];\n        if (actionViewItem instanceof BaseActionViewItem) {\n            const context = (actionViewItem._context === null || actionViewItem._context === undefined) ? event : actionViewItem._context;\n            this.run(actionViewItem._action, context);\n        }\n    }\n    async run(action, context) {\n        await this._actionRunner.run(action, context);\n    }\n    dispose() {\n        this._context = undefined;\n        this.viewItems = dispose(this.viewItems);\n        this.getContainer().remove();\n        super.dispose();\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}